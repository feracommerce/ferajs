!function(e,t){function i(e,t){var i=arguments.length>2?arguments[2]:[];if(!1===n(e))throw new TypeError(Object.prototype.toString.call(e)+"is not a function.");return e.apply(t,i)}function r(e,t){return e[t]}function n(e){return"function"==typeof e}function a(e,t){return e===t}function o(e){if(null===e||e===t)throw TypeError();return Object(e)}function s(e,t){return o(e)[t]}function c(e,i){var r=s(e,i);if(null===r||r===t)return t;if(!1===n(r))throw new TypeError("Method not callable: "+i);return r}function u(t){switch(typeof t){case"undefined":return"undefined";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";default:return null===t?"null":"Symbol"in e&&(t instanceof e.Symbol||t.constructor===e.Symbol)?"symbol":"object"}}function l(e,t){if("string"===t)var a=["toString","valueOf"];else a=["valueOf","toString"];for(var o=0;o<a.length;++o){var s=r(e,a[o]);if(n(s)){var c=i(s,e);if("object"!==u(c))return c}}throw new TypeError("Cannot convert to primitive.")}function d(e,t){return u(e)===u(t)&&("number"===u(e)?!(!isNaN(e)||!isNaN(t))||(1/e==1/0&&1/t==-1/0||(1/e==-1/0&&1/t==1/0||e===t)):a(e,t))}function p(e){if("symbol"===u(e))throw new TypeError("Cannot convert a Symbol value to a number");var t=Number(e);return isNaN(t)?0:1/t==1/0||1/t==-1/0||t===1/0||t===-1/0?t:(t<0?-1:1)*Math.floor(Math.abs(t))}function h(e){var t=p(e);return t<=0?0:Math.min(t,Math.pow(2,53)-1)}function f(r){var n=arguments.length>1?arguments[1]:t;if("object"===u(r)){if(arguments.length<2)var a="default";else n===String?a="string":n===Number&&(a="number");var o="function"==typeof e.Symbol&&"symbol"==typeof e.Symbol.toPrimitive?c(r,e.Symbol.toPrimitive):t;if(o!==t){var s=i(o,r,[a]);if("object"!==u(s))return s;throw new TypeError("Cannot convert exotic object to primitive.")}return"default"===a&&(a="number"),l(r,a)}return r}function m(e){switch(u(e)){case"symbol":throw new TypeError("Cannot convert a Symbol value to a string");case"object":return m(f(e,String));default:return String(e)}}function g(e,t,i){var r={value:i,writable:!0,enumerable:!1,configurable:!0};Object.defineProperty(e,t,r)}var v,_,w,y;v=Object.defineProperty,_=Object.prototype.hasOwnProperty.call(Object.prototype,"__defineGetter__"),w="Getters & setters cannot be defined on this javascript engine",y="A property cannot both have accessors and be writable or have a value",Object.defineProperty=function(e,i,r){if(v&&(e===window||e===document||e===Element.prototype||e instanceof Element))return v(e,i,r);if(null===e||!(e instanceof Object||"object"==typeof e))throw new TypeError("Object.defineProperty called on non-object");if(!(r instanceof Object))throw new TypeError("Property description must be an object");var n=String(i),a="value"in r||"writable"in r,o="get"in r&&typeof r.get,s="set"in r&&typeof r.set;if(o){if(o===t)return e;if("function"!==o)throw new TypeError("Getter must be a function");if(!_)throw new TypeError(w);if(a)throw new TypeError(y);Object.__defineGetter__.call(e,n,r.get)}else e[n]=r.value;if(s){if(s===t)return e;if("function"!==s)throw new TypeError("Setter must be a function");if(!_)throw new TypeError(w);if(a)throw new TypeError(y);Object.__defineSetter__.call(e,n,r.set)}return"value"in r&&(e[n]=r.value),e},g(Array.prototype,"includes",(function(e){"use strict";var t=o(this),i=h(r(t,"length"));if(0===i)return!1;var n=p(arguments[1]);if(n>=0)var a=n;else(a=i+n)<0&&(a=0);for(;a<i;){if(d(e,r(t,m(a))))return!0;a+=1}return!1}))}("object"==typeof window&&window||"object"==typeof self&&self||"object"==typeof global&&global||{}),window.F$=window.F$||function(){function e(e){return null==e?String(e):J[G.call(e)]||"object"}function t(t){return"function"==e(t)}function i(e){return null!=e&&e==e.window}function r(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function n(t){return"object"==e(t)}function a(e){return n(e)&&!i(e)&&Object.getPrototypeOf(e)==Object.prototype}function o(e){var t=!!e&&"length"in e&&e.length,r=x.type(e);return"function"!=r&&!i(e)&&("array"==r||0===t||"number"==typeof t&&t>0&&t-1 in e)}function s(e){return R.call(e,(function(e){return null!=e}))}function c(e){return e.length>0?x.fn.concat.apply([],e):e}function u(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function l(e){return e in M?M[e]:M[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function d(e,t){return"number"!=typeof t||L[u(e)]?t:t+"px"}function p(e){var t,i;return E[e]||(t=A.createElement(e),A.body.appendChild(t),i=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==i&&(i="block"),E[e]=i),E[e]}function h(e){return"children"in e?I.call(e.children):x.map(e.childNodes,(function(e){if(1==e.nodeType)return e}))}function f(e,t){var i,r=e?e.length:0;for(i=0;i<r;i++)this[i]=e[i];this.length=r,this.selector=t||""}function m(e,t,i){for(S in t)i&&(a(t[S])||X(t[S]))?(a(t[S])&&!a(e[S])&&(e[S]={}),X(t[S])&&!X(e[S])&&(e[S]=[]),m(e[S],t[S],i)):t[S]!==C&&(e[S]=t[S])}function g(e,t){return null==t?x(e):x(e).filter(t)}function v(e,i,r,n){return t(i)?i.call(e,r,n):i}function _(e,t,i){null==i?e.removeAttribute(t):e.setAttribute(t,i)}function w(e,t){var i=e.className||"",r=i&&i.baseVal!==C;if(t===C)return r?i.baseVal:i;r?i.baseVal=t:e.className=t}function y(e){try{return e?"true"==e||"false"!=e&&("null"==e?null:+e+""==e?+e:/^[\[\{]/.test(e)?x.parseJSON(e):e):e}catch(t){return e}}function b(e,t){t(e);for(var i=0,r=e.childNodes.length;i<r;i++)b(e.childNodes[i],t)}var C,S,x,F,k,T,$=[],P=$.concat,R=$.filter,I=$.slice,A=window.document,E={},M={},L={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},O=/^\s*<(\w+|!)[^>]*>/,D=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,q=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,j=/^(?:body|html)$/i,B=/([A-Z])/g,U=["val","css","html","text","data","width","height","offset"],N=["after","prepend","before","append"],V=A.createElement("table"),z=A.createElement("tr"),W={tr:A.createElement("tbody"),tbody:V,thead:V,tfoot:V,td:z,th:z,"*":A.createElement("div")},H=/^[\w-]*$/,J={},G=J.toString,Z={},Y=A.createElement("div"),K={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},X=Array.isArray||function(e){return e instanceof Array};return Z.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var i=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(i)return i.call(e,t);var r,n=e.parentNode,a=!n;return a&&(n=Y).appendChild(e),r=~Z.qsa(n,t).indexOf(e),a&&Y.removeChild(e),r},k=function(e){return e.replace(/-+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))},T=function(e){return R.call(e,(function(t,i){return e.indexOf(t)==i}))},Z.fragment=function(e,t,i){var r,n,o;return D.test(e)&&(r=x(A.createElement(RegExp.$1))),r||(e.replace&&(e=e.replace(q,"<$1></$2>")),t===C&&(t=O.test(e)&&RegExp.$1),t in W||(t="*"),(o=W[t]).innerHTML=""+e,r=x.each(I.call(o.childNodes),(function(){o.removeChild(this)}))),a(i)&&(n=x(r),x.each(i,(function(e,t){U.indexOf(e)>-1?n[e](t):n.attr(e,t)}))),r},Z.Z=function(e,t){return new f(e,t)},Z.isZ=function(e){return e instanceof Z.Z||e.__proto__&&e.__proto__.zepto},Z.init=function(e,i){var r;if(!e)return Z.Z();if("string"==typeof e)if("<"==(e=e.trim())[0]&&O.test(e))r=Z.fragment(e,RegExp.$1,i),e=null;else{if(i!==C)return x(i).find(e);r=Z.qsa(A,e)}else{if(t(e))return x(A).ready(e);if(Z.isZ(e))return e;if(X(e))r=s(e);else if(n(e))r=[e],e=null;else if(O.test(e))r=Z.fragment(e.trim(),RegExp.$1,i),e=null;else{if(i!==C)return x(i).find(e);r=Z.qsa(A,e)}}return Z.Z(r,e)},(x=function(e,t){return Z.init(e,t)}).extend=function(e){var t,i=I.call(arguments,1);return"boolean"==typeof e&&(t=e,e=i.shift()),i.forEach((function(i){m(e,i,t)})),e},Z.qsa=function(e,t){var i,r="#"==t[0],n=!r&&"."==t[0],a=r||n?t.slice(1):t,o=H.test(a);return e.getElementById&&o&&r?(i=e.getElementById(a))?[i]:[]:1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType?[]:I.call(o&&!r&&e.getElementsByClassName?n?e.getElementsByClassName(a):e.getElementsByTagName(t):e.querySelectorAll(t))},x.contains=A.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t&&(t=t.parentNode);)if(t===e)return!0;return!1},x.type=e,x.isFunction=t,x.isWindow=i,x.isArray=X,x.isPlainObject=a,x.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},x.isNumeric=function(e){var t=Number(e),i=typeof e;return null!=e&&"boolean"!=i&&("string"!=i||e.length)&&!isNaN(t)&&isFinite(t)||!1},x.inArray=function(e,t,i){return $.indexOf.call(t,e,i)},x.camelCase=k,x.trim=function(e){return null==e?"":String.prototype.trim.call(e)},x.uuid=0,x.support={},x.expr={},x.noop=function(){},x.map=function(e,t){var i,r,n,a=[];if(o(e))for(r=0;r<e.length;r++)null!=(i=t(e[r],r))&&a.push(i);else for(n in e)null!=(i=t(e[n],n))&&a.push(i);return c(a)},x.each=function(e,t){var i,r;if(o(e)){for(i=0;i<e.length;i++)if(!1===t.call(e[i],i,e[i]))return e}else for(r in e)if(!1===t.call(e[r],r,e[r]))return e;return e},x.grep=function(e,t){return R.call(e,t)},window.JSON&&(x.parseJSON=JSON.parse),x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),(function(e,t){J["[object "+t+"]"]=t.toLowerCase()})),x.fn={constructor:Z.Z,length:0,forEach:$.forEach,reduce:$.reduce,push:$.push,sort:$.sort,splice:$.splice,indexOf:$.indexOf,concat:function(){var e,t,i=[];for(e=0;e<arguments.length;e++)t=arguments[e],i[e]=Z.isZ(t)?t.toArray():t;return P.apply(Z.isZ(this)?this.toArray():this,i)},map:function(e){return x(x.map(this,(function(t,i){return e.call(t,i,t)})))},slice:function(){return x(I.apply(this,arguments))},zepto:function(){return x},ready:function(e){if("complete"===A.readyState||"loading"!==A.readyState&&!A.documentElement.doScroll)setTimeout((function(){e(x)}),0);else{var t=function(){A.removeEventListener("DOMContentLoaded",t,!1),window.removeEventListener("load",t,!1),e(x)};A.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)}return this},get:function(e){return e===C?I.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each((function(){null!=this.parentNode&&this.parentNode.removeChild(this)}))},each:function(e){return $.every.call(this,(function(t,i){return!1!==e.call(t,i,t)})),this},filter:function(e){return t(e)?this.not(this.not(e)):x(R.call(this,(function(t){return Z.matches(t,e)})))},add:function(e,t){return x(T(this.concat(x(e,t))))},is:function(e){return"string"==typeof e?this.length>0&&Z.matches(this[0],e):e&&this.selector==e.selector},not:function(e){var i=[];if(t(e)&&e.call!==C)this.each((function(t){e.call(this,t)||i.push(this)}));else{var r="string"==typeof e?this.filter(e):o(e)&&t(e.item)?I.call(e):x(e);this.forEach((function(e){r.indexOf(e)<0&&i.push(e)}))}return x(i)},has:function(e){return this.filter((function(){return n(e)?x.contains(this,e):x(this).find(e).size()}))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!n(e)?e:x(e)},last:function(){var e=this[this.length-1];return e&&!n(e)?e:x(e)},find:function(e){var t=this;return e?"object"==typeof e?x(e).filter((function(){var e=this;return $.some.call(t,(function(t){return x.contains(t,e)}))})):1==this.length?x(Z.qsa(this[0],e)):this.map((function(){return Z.qsa(this,e)})):x()},closest:function(e,t){var i=[],n="object"==typeof e&&x(e);return this.each((function(a,o){for(;o&&!(n?n.indexOf(o)>=0:Z.matches(o,e));)o=o!==t&&!r(o)&&o.parentNode;o&&i.indexOf(o)<0&&i.push(o)})),x(i)},parents:function(e){for(var t=[],i=this;i.length>0;)i=x.map(i,(function(e){if((e=e.parentNode)&&!r(e)&&t.indexOf(e)<0)return t.push(e),e}));return g(t,e)},parent:function(e){return g(T(this.pluck("parentNode")),e)},children:function(e){return g(this.map((function(){return h(this)})),e)},contents:function(){return this.map((function(){return this.contentDocument||I.call(this.childNodes)}))},siblings:function(e){return g(this.map((function(e,t){return R.call(h(t.parentNode),(function(e){return e!==t}))})),e)},empty:function(){return this.each((function(){this.innerHTML=""}))},pluck:function(e){return x.map(this,(function(t){return t[e]}))},show:function(){return this.each((function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=p(this.nodeName))}))},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var i=t(e);if(this[0]&&!i)var r=x(e).get(0),n=r.parentNode||this.length>1;return this.each((function(t){x(this).wrapAll(i?e.call(this,t):n?r.cloneNode(!0):r)}))},wrapAll:function(e){if(this[0]){var t;for(x(this[0]).before(e=x(e));(t=e.children()).length;)e=t.first();x(e).append(this)}return this},wrapInner:function(e){var i=t(e);return this.each((function(t){var r=x(this),n=r.contents(),a=i?e.call(this,t):e;n.length?n.wrapAll(a):r.append(a)}))},unwrap:function(){return this.parent().each((function(){x(this).replaceWith(x(this).children())})),this},clone:function(){return this.map((function(){return this.cloneNode(!0)}))},hide:function(){return this.css("display","none")},toggle:function(e){return this.each((function(){var t=x(this);(e===C?"none"==t.css("display"):e)?t.show():t.hide()}))},prev:function(e){return x(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return x(this.pluck("nextElementSibling")).filter(e||"*")},html:function(e){return 0 in arguments?this.each((function(t){var i=this.innerHTML;x(this).empty().append(v(this,e,t,i))})):0 in this?this[0].innerHTML:null},text:function(e){return 0 in arguments?this.each((function(t){var i=v(this,e,t,this.textContent);this.textContent=null==i?"":""+i})):0 in this?this.pluck("textContent").join(""):null},attr:function(e,t){var i;return"string"!=typeof e||1 in arguments?this.each((function(i){if(1===this.nodeType)if(n(e))for(S in e)_(this,S,e[S]);else _(this,e,v(this,t,i,this.getAttribute(e)))})):0 in this&&1==this[0].nodeType&&null!=(i=this[0].getAttribute(e))?i:C},removeAttr:function(e){return this.each((function(){1===this.nodeType&&e.split(" ").forEach((function(e){_(this,e)}),this)}))},prop:function(e,t){return"string"!=typeof(e=K[e]||e)||1 in arguments?this.each((function(i){if(n(e))for(S in e)this[K[S]||S]=e[S];else this[e]=v(this,t,i,this[e])})):this[0]&&this[0][e]},removeProp:function(e){return e=K[e]||e,this.each((function(){delete this[e]}))},data:function(e,t){var i="data-"+e.replace(B,"-$1").toLowerCase(),r=1 in arguments?this.attr(i,t):this.attr(i);return null!==r?y(r):C},val:function(e){return 0 in arguments?(null==e&&(e=""),this.each((function(t){this.value=v(this,e,t,this.value)}))):this[0]&&(this[0].multiple?x(this[0]).find("option").filter((function(){return this.selected})).pluck("value"):this[0].value)},offset:function(e){if(e)return this.each((function(t){var i=x(this),r=v(this,e,t,i.offset()),n=i.offsetParent().offset(),a={top:r.top-n.top,left:r.left-n.left};"static"==i.css("position")&&(a.position="relative"),i.css(a)}));if(!this.length)return null;if(A.documentElement!==this[0]&&!x.contains(A.documentElement,this[0]))return{top:0,left:0};var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(t,i){if(arguments.length<2){var r=this[0];if("string"==typeof t){if(!r)return;return r.style[k(t)]||getComputedStyle(r,"").getPropertyValue(t)}if(X(t)){if(!r)return;var n={},a=getComputedStyle(r,"");return x.each(t,(function(e,t){n[t]=r.style[k(t)]||a.getPropertyValue(t)})),n}}var o="";if("string"==e(t))i||0===i?o=u(t)+":"+d(t,i):this.each((function(){this.style.removeProperty(u(t))}));else for(S in t)t[S]||0===t[S]?o+=u(S)+":"+d(S,t[S])+";":this.each((function(){this.style.removeProperty(u(S))}));return this.each((function(){this.style.cssText+=";"+o}))},index:function(e){return e?this.indexOf(x(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return!!e&&$.some.call(this,(function(e){return this.test(w(e))}),l(e))},addClass:function(e){return e?this.each((function(t){if("className"in this){F=[];var i=w(this);v(this,e,t,i).split(/\s+/g).forEach((function(e){x(this).hasClass(e)||F.push(e)}),this),F.length&&w(this,i+(i?" ":"")+F.join(" "))}})):this},removeClass:function(e){return this.each((function(t){if("className"in this){if(e===C)return w(this,"");F=w(this),v(this,e,t,F).split(/\s+/g).forEach((function(e){F=F.replace(l(e)," ")})),w(this,F.trim())}}))},toggleClass:function(e,t){return e?this.each((function(i){var r=x(this);v(this,e,i,w(this)).split(/\s+/g).forEach((function(e){(t===C?!r.hasClass(e):t)?r.addClass(e):r.removeClass(e)}))})):this},scrollTop:function(e){if(this.length){var t="scrollTop"in this[0];return e===C?t?this[0].scrollTop:this[0].pageYOffset:this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var t="scrollLeft"in this[0];return e===C?t?this[0].scrollLeft:this[0].pageXOffset:this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),i=this.offset(),r=j.test(t[0].nodeName)?{top:0,left:0}:t.offset();return i.top-=parseFloat(x(e).css("margin-top"))||0,i.left-=parseFloat(x(e).css("margin-left"))||0,r.top+=parseFloat(x(t[0]).css("border-top-width"))||0,r.left+=parseFloat(x(t[0]).css("border-left-width"))||0,{top:i.top-r.top,left:i.left-r.left}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent||A.body;e&&!j.test(e.nodeName)&&"static"==x(e).css("position");)e=e.offsetParent;return e}))}},x.fn.detach=x.fn.remove,["width","height"].forEach((function(e){var t=e.replace(/./,(function(e){return e[0].toUpperCase()}));x.fn[e]=function(n){var a,o=this[0];return n===C?i(o)?o["inner"+t]:r(o)?o.documentElement["scroll"+t]:(a=this.offset())&&a[e]:this.each((function(t){(o=x(this)).css(e,v(this,n,t,o[e]()))}))}})),N.forEach((function(t,i){var r=i%2;x.fn[t]=function(){var t,n,a=x.map(arguments,(function(i){var r=[];return"array"==(t=e(i))?(i.forEach((function(e){return e.nodeType!==C?r.push(e):x.zepto.isZ(e)?r=r.concat(e.get()):void(r=r.concat(Z.fragment(e)))})),r):"object"==t||null==i?i:Z.fragment(i)})),o=this.length>1;return a.length<1?this:this.each((function(e,t){n=r?t:t.parentNode,t=0==i?t.nextSibling:1==i?t.firstChild:2==i?t:null;var s=x.contains(A.documentElement,n);a.forEach((function(e){if(e=x.zepto.isZ(e)?e.get(0):e,o)e=e.cloneNode(!0);else if(!n)return x(e).remove();n.insertBefore(e,t),s&&b(e,(function(e){if(!(null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src)){var t=e.ownerDocument?e.ownerDocument.defaultView:window;t.eval.call(t,e.innerHTML)}}))}))}))},x.fn[r?t+"To":"insert"+(i?"Before":"After")]=function(e){return x(e)[t](this),this}})),Z.Z.prototype=f.prototype=x.fn,Z.uniq=T,Z.deserializeValue=y,x.zepto=Z,x}(),function(e){function t(e){return e._zid||(e._zid=p++)}function i(e,i,a,o){if((i=r(i)).ns)var s=n(i.ns);return(g[t(e)]||[]).filter((function(e){return e&&(!i.e||e.e==i.e)&&(!i.ns||s.test(e.ns))&&(!a||t(e.fn)===t(a))&&(!o||e.sel==o)}))}function r(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function n(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function a(e,t){return e.del&&!_&&e.e in w||!!t}function o(e){return y[e]||_&&w[e]||e}function s(i,n,s,c,l,p,h){var f=t(i),m=g[f]||(g[f]=[]);n.split(/\s/).forEach((function(t){if("ready"==t)return e(document).ready(s);var n=r(t);n.fn=s,n.sel=l,n.e in y&&(s=function(t){var i=t.relatedTarget;if(!i||i!==this&&!e.contains(this,i))return n.fn.apply(this,arguments)}),n.del=p;var f=p||s;n.proxy=function(e){if(!(e=u(e)).isImmediatePropagationStopped()){e.data=c;var t=f.apply(i,e._args==d?[e]:[e].concat(e._args));return!1===t&&(e.preventDefault(),e.stopPropagation()),t}},n.i=m.length,m.push(n),"addEventListener"in i&&i.addEventListener(o(n.e),n.proxy,a(n,h))}))}function c(e,r,n,s,c){var u=t(e);(r||"").split(/\s/).forEach((function(t){i(e,t,n,s).forEach((function(t){delete g[u][t.i],"removeEventListener"in e&&e.removeEventListener(o(t.e),t.proxy,a(t,c))}))}))}function u(t,i){if(i||!t.isDefaultPrevented){i||(i=t),e.each(x,(function(e,r){var n=i[e];t[e]=function(){return this[r]=b,n&&n.apply(i,arguments)},t[r]=C}));try{t.timeStamp||(t.timeStamp=Date.now())}catch(e){}(i.defaultPrevented!==d?i.defaultPrevented:"returnValue"in i?!1===i.returnValue:i.getPreventDefault&&i.getPreventDefault())&&(t.isDefaultPrevented=b)}return t}function l(e){var t,i={originalEvent:e};for(t in e)S.test(t)||e[t]===d||(i[t]=e[t]);return u(i,e)}var d,p=1,h=Array.prototype.slice,f=e.isFunction,m=function(e){return"string"==typeof e},g={},v={},_="onfocusin"in window,w={focus:"focusin",blur:"focusout"},y={mouseenter:"mouseover",mouseleave:"mouseout"};v.click=v.mousedown=v.mouseup=v.mousemove="MouseEvents",e.event={add:s,remove:c},e.proxy=function(i,r){var n=2 in arguments&&h.call(arguments,2);if(f(i)){var a=function(){return i.apply(r,n?n.concat(h.call(arguments)):arguments)};return a._zid=t(i),a}if(m(r))return n?(n.unshift(i[r],i),e.proxy.apply(null,n)):e.proxy(i[r],i);throw new TypeError("expected function")},e.fn.bind=function(e,t,i){return this.on(e,t,i)},e.fn.unbind=function(e,t){return this.off(e,t)},e.fn.one=function(e,t,i,r){return this.on(e,t,i,r,1)};var b=function(){return!0},C=function(){return!1},S=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,x={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(e,t,i){return this.on(t,e,i)},e.fn.undelegate=function(e,t,i){return this.off(t,e,i)},e.fn.live=function(t,i){return e(document.body).delegate(this.selector,t,i),this},e.fn.die=function(t,i){return e(document.body).undelegate(this.selector,t,i),this},e.fn.on=function(t,i,r,n,a){var o,u,p=this;return t&&!m(t)?(e.each(t,(function(e,t){p.on(e,i,r,t,a)})),p):(m(i)||f(n)||!1===n||(n=r,r=i,i=d),n!==d&&!1!==r||(n=r,r=d),!1===n&&(n=C),p.each((function(d,p){a&&(o=function(e){return c(p,e.type,n),n.apply(this,arguments)}),i&&(u=function(t){var r,a=e(t.target).closest(i,p).get(0);if(a&&a!==p)return r=e.extend(l(t),{currentTarget:a,liveFired:p}),(o||n).apply(a,[r].concat(h.call(arguments,1)))}),s(p,t,n,r,i,u||o)})))},e.fn.off=function(t,i,r){var n=this;return t&&!m(t)?(e.each(t,(function(e,t){n.off(e,i,t)})),n):(m(i)||f(r)||!1===r||(r=i,i=d),!1===r&&(r=C),n.each((function(){c(this,t,r,i)})))},e.fn.trigger=function(t,i){return(t=m(t)||e.isPlainObject(t)?e.Event(t):u(t))._args=i,this.each((function(){t.type in w&&"function"==typeof this[t.type]?this[t.type]():"dispatchEvent"in this?this.dispatchEvent(t):e(this).triggerHandler(t,i)}))},e.fn.triggerHandler=function(t,r){var n,a;return this.each((function(o,s){(n=l(m(t)?e.Event(t):t))._args=r,n.target=s,e.each(i(s,t.type||t),(function(e,t){if(a=t.proxy(n),n.isImmediatePropagationStopped())return!1}))})),a},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach((function(t){e.fn[t]=function(e){return 0 in arguments?this.bind(t,e):this.trigger(t)}})),e.Event=function(e,t){m(e)||(e=(t=e).type);var i=document.createEvent(v[e]||"Events"),r=!0;if(t)for(var n in t)"bubbles"==n?r=!!t[n]:i[n]=t[n];return i.initEvent(e,r,!0),u(i)}}(F$),function(e){function t(t,i,r){var n=e.Event(i);return e(t).trigger(n,r),!n.isDefaultPrevented()}function i(e,i,r,n){if(e.global)return t(i||w,r,n)}function r(t){t.global&&0==e.active++&&i(t,null,"ajaxStart")}function n(t){t.global&&!--e.active&&i(t,null,"ajaxStop")}function a(e,t){var r=t.context;if(!1===t.beforeSend.call(r,e,t)||!1===i(t,r,"ajaxBeforeSend",[e,t]))return!1;i(t,r,"ajaxSend",[e,t])}function o(e,t,r,n){var a=r.context,o="success";r.success.call(a,e,o,t),n&&n.resolveWith(a,[e,o,t]),i(r,a,"ajaxSuccess",[t,r,e]),c(o,t,r)}function s(e,t,r,n,a){var o=n.context;n.error.call(o,r,t,e),a&&a.rejectWith(o,[r,t,e]),i(n,o,"ajaxError",[r,n,e||t]),c(t,r,n)}function c(e,t,r){var a=r.context;r.complete.call(a,t,e),i(r,a,"ajaxComplete",[t,r]),n(r)}function u(e,t,i){if(i.dataFilter==l)return e;var r=i.context;return i.dataFilter.call(r,e,t)}function l(){}function d(e){return e&&(e=e.split(";",2)[0]),e&&(e==x?"html":e==S?"json":b.test(e)?"script":C.test(e)&&"xml")||"text"}function p(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function h(t){t.processData&&t.data&&"string"!=e.type(t.data)&&(t.data=e.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()&&"jsonp"!=t.dataType||(t.url=p(t.url,t.data),t.data=void 0)}function f(t,i,r,n){return e.isFunction(i)&&(n=r,r=i,i=void 0),e.isFunction(r)||(n=r,r=void 0),{url:t,data:i,success:r,dataType:n}}function m(t,i,r,n){var a,o=e.isArray(i),s=e.isPlainObject(i);e.each(i,(function(i,c){a=e.type(c),n&&(i=r?n:n+"["+(s||"object"==a||"array"==a?i:"")+"]"),!n&&o?t.add(c.name,c.value):"array"==a||!r&&"object"==a?m(t,c,r,i):t.add(i,c)}))}var g,v,_=+new Date,w=window.document,y=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,b=/^(?:text|application)\/javascript/i,C=/^(?:text|application)\/xml/i,S="application/json",x="text/html",F=/^\s*$/,k=w.createElement("a");k.href=window.location.href,e.active=0,e.ajaxJSONP=function(t,i){if(!("type"in t))return e.ajax(t);var r,n,c=t.jsonpCallback,u=(e.isFunction(c)?c():c)||"Zepto"+_++,l=w.createElement("script"),d=window[u],p=function(t){e(l).triggerHandler("error",t||"abort")},h={abort:p};return i&&i.promise(h),e(l).on("load error",(function(a,c){clearTimeout(n),e(l).off().remove(),"error"!=a.type&&r?o(r[0],h,t,i):s(null,c||"error",h,t,i),window[u]=d,r&&e.isFunction(d)&&d(r[0]),d=r=void 0})),!1===a(h,t)?(p("abort"),h):(window[u]=function(){r=arguments},l.src=t.url.replace(/\?(.+)=\?/,"?$1="+u),w.head.appendChild(l),t.timeout>0&&(n=setTimeout((function(){p("timeout")}),t.timeout)),h)},e.ajaxSettings={type:"GET",beforeSend:l,success:l,error:l,complete:l,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:S,xml:"application/xml, text/xml",html:x,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,dataFilter:l},e.ajax=function(t){var i,n,c=e.extend({},t||{}),f=e.Deferred&&e.Deferred();for(g in e.ajaxSettings)void 0===c[g]&&(c[g]=e.ajaxSettings[g]);r(c),c.crossDomain||((i=w.createElement("a")).href=c.url,i.href=i.href,c.crossDomain=k.protocol+"//"+k.host!=i.protocol+"//"+i.host),c.url||(c.url=window.location.toString()),(n=c.url.indexOf("#"))>-1&&(c.url=c.url.slice(0,n)),h(c);var m=c.dataType,_=/\?.+=\?/.test(c.url);if(_&&(m="jsonp"),!1!==c.cache&&(t&&!0===t.cache||"script"!=m&&"jsonp"!=m)||(c.url=p(c.url,"_="+Date.now())),"jsonp"==m)return _||(c.url=p(c.url,c.jsonp?c.jsonp+"=?":!1===c.jsonp?"":"callback=?")),e.ajaxJSONP(c,f);var y,b=c.accepts[m],C={},S=function(e,t){C[e.toLowerCase()]=[e,t]},x=/^([\w-]+:)\/\//.test(c.url)?RegExp.$1:window.location.protocol,T=c.xhr(),$=T.setRequestHeader;if(f&&f.promise(T),c.crossDomain||S("X-Requested-With","XMLHttpRequest"),S("Accept",b||"*/*"),(b=c.mimeType||b)&&(b.indexOf(",")>-1&&(b=b.split(",",2)[0]),T.overrideMimeType&&T.overrideMimeType(b)),(c.contentType||!1!==c.contentType&&c.data&&"GET"!=c.type.toUpperCase())&&S("Content-Type",c.contentType||"application/x-www-form-urlencoded"),c.headers)for(v in c.headers)S(v,c.headers[v]);if(T.setRequestHeader=S,T.onreadystatechange=function(){if(4==T.readyState){T.onreadystatechange=l,clearTimeout(y);var t,i=!1;if(T.status>=200&&T.status<300||304==T.status||0==T.status&&"file:"==x){if(m=m||d(c.mimeType||T.getResponseHeader("content-type")),"arraybuffer"==T.responseType||"blob"==T.responseType)t=T.response;else{t=T.responseText;try{t=u(t,m,c),"script"==m?(0,eval)(t):"xml"==m?t=T.responseXML:"json"==m&&(t=F.test(t)?null:e.parseJSON(t))}catch(e){i=e}if(i)return s(i,"parsererror",T,c,f)}o(t,T,c,f)}else s(T.statusText||null,T.status?"error":"abort",T,c,f)}},!1===a(T,c))return T.abort(),s(null,"abort",T,c,f),T;var P=!("async"in c)||c.async;if(T.open(c.type,c.url,P,c.username,c.password),c.xhrFields)for(v in c.xhrFields)T[v]=c.xhrFields[v];for(v in C)$.apply(T,C[v]);return c.timeout>0&&(y=setTimeout((function(){T.onreadystatechange=l,T.abort(),s(null,"timeout",T,c,f)}),c.timeout)),T.send(c.data?c.data:null),T},e.get=function(){return e.ajax(f.apply(null,arguments))},e.post=function(){var t=f.apply(null,arguments);return t.type="POST",e.ajax(t)},e.getJSON=function(){var t=f.apply(null,arguments);return t.dataType="json",e.ajax(t)},e.fn.load=function(t,i,r){if(!this.length)return this;var n,a=this,o=t.split(/\s/),s=f(t,i,r),c=s.success;return o.length>1&&(s.url=o[0],n=o[1]),s.success=function(t){a.html(n?e("<div>").html(t.replace(y,"")).find(n):t),c&&c.apply(a,arguments)},e.ajax(s),this};var T=encodeURIComponent;e.param=function(t,i){var r=[];return r.add=function(t,i){e.isFunction(i)&&(i=i()),null==i&&(i=""),this.push(T(t)+"="+T(i))},m(r,t,i),r.join("&").replace(/%20/g,"+")}}(F$),function(e){e.fn.serializeArray=function(){var t,i,r=[],n=function(e){if(e.forEach)return e.forEach(n);r.push({name:t,value:e})};return this[0]&&e.each(this[0].elements,(function(r,a){i=a.type,(t=a.name)&&"fieldset"!=a.nodeName.toLowerCase()&&!a.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&"file"!=i&&("radio"!=i&&"checkbox"!=i||a.checked)&&n(e(a).val())})),r},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach((function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))})),e.join("&")},e.fn.submit=function(t){if(0 in arguments)this.bind("submit",t);else if(this.length){var i=e.Event("submit");this.eq(0).trigger(i),i.isDefaultPrevented()||this.get(0).submit()}return this}}(F$),function(e){function t(e,t){var i=this.os={},r=this.browser={},n=e.match(/Web[kK]it[\/]{0,1}([\d.]+)/),a=e.match(/(Android);?[\s\/]+([\d.]+)?/),o=!!e.match(/\(Macintosh\; Intel /),s=e.match(/(iPad).*OS\s([\d_]+)/),c=e.match(/(iPod)(.*OS\s([\d_]+))?/),u=!s&&e.match(/(iPhone\sOS)\s([\d_]+)/),l=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),d=/Win\d{2}|Windows/.test(t),p=e.match(/Windows Phone ([\d.]+)/),h=l&&e.match(/TouchPad/),f=e.match(/Kindle\/([\d.]+)/),m=e.match(/Silk\/([\d._]+)/),g=e.match(/(BlackBerry).*Version\/([\d.]+)/),v=e.match(/(BB10).*Version\/([\d.]+)/),_=e.match(/(RIM\sTablet\sOS)\s([\d.]+)/),w=e.match(/PlayBook/),y=e.match(/Chrome\/([\d.]+)/)||e.match(/CriOS\/([\d.]+)/),b=e.match(/Firefox\/([\d.]+)/),C=e.match(/\((?:Mobile|Tablet); rv:([\d.]+)\).*Firefox\/[\d.]+/),S=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/[\d](?=[^\?]+).*rv:([0-9.].)/),x=!y&&e.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/),F=x||e.match(/Version\/([\d.]+)([^S](Safari)|[^M]*(Mobile)[^S]*(Safari))/);(r.webkit=!!n)&&(r.version=n[1]),a&&(i.android=!0,i.version=a[2]),u&&!c&&(i.ios=i.iphone=!0,i.version=u[2].replace(/_/g,".")),s&&(i.ios=i.ipad=!0,i.version=s[2].replace(/_/g,".")),c&&(i.ios=i.ipod=!0,i.version=c[3]?c[3].replace(/_/g,"."):null),p&&(i.wp=!0,i.version=p[1]),l&&(i.webos=!0,i.version=l[2]),h&&(i.touchpad=!0),g&&(i.blackberry=!0,i.version=g[2]),v&&(i.bb10=!0,i.version=v[2]),_&&(i.rimtabletos=!0,i.version=_[2]),w&&(r.playbook=!0),f&&(i.kindle=!0,i.version=f[1]),m&&(r.silk=!0,r.version=m[1]),!m&&i.android&&e.match(/Kindle Fire/)&&(r.silk=!0),y&&(r.chrome=!0,r.version=y[1]),b&&(r.firefox=!0,r.version=b[1]),C&&(i.firefoxos=!0,i.version=C[1]),S&&(r.ie=!0,r.version=S[1]),F&&(o||i.ios||d)&&(r.safari=!0,i.ios||(r.version=F[1])),x&&(r.webview=!0),i.tablet=!!(s||w||a&&!e.match(/Mobile/)||b&&e.match(/Tablet/)||S&&!e.match(/Phone/)&&e.match(/Touch/)),i.phone=!(i.tablet||i.ipod||!(a||u||l||g||v||y&&e.match(/Android/)||y&&e.match(/CriOS\/([\d.]+)/)||b&&e.match(/Mobile/)||S&&e.match(/Touch/)))}t.call(e,navigator.userAgent,navigator.platform),e.__detect=t}(F$),function(e,t){function i(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function r(e){return n?n+e:e.toLowerCase()}var n,a,o,s,c,u,l,d,p,h,f="",m={Webkit:"webkit",Moz:"",O:"o"},g=document.createElement("div"),v=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,_={};g.style.transform===t&&e.each(m,(function(e,i){if(g.style[e+"TransitionProperty"]!==t)return f="-"+e.toLowerCase()+"-",n=i,!1})),a=f+"transform",
_[o=f+"transition-property"]=_[s=f+"transition-duration"]=_[u=f+"transition-delay"]=_[c=f+"transition-timing-function"]=_[l=f+"animation-name"]=_[d=f+"animation-duration"]=_[h=f+"animation-delay"]=_[p=f+"animation-timing-function"]="",e.fx={off:n===t&&g.style.transitionProperty===t,speeds:{_default:400,fast:200,slow:600},cssPrefix:f,transitionEnd:r("TransitionEnd"),animationEnd:r("AnimationEnd")},e.fn.animate=function(i,r,n,a,o){return e.isFunction(r)&&(a=r,n=t,r=t),e.isFunction(n)&&(a=n,n=t),e.isPlainObject(r)&&(n=r.easing,a=r.complete,o=r.delay,r=r.duration),r&&(r=("number"==typeof r?r:e.fx.speeds[r]||e.fx.speeds._default)/1e3),o&&(o=parseFloat(o)/1e3),this.anim(i,r,n,a,o)},e.fn.anim=function(r,n,f,m,g){var w,y,b,C={},S="",x=this,F=e.fx.transitionEnd,k=!1;if(n===t&&(n=e.fx.speeds._default/1e3),g===t&&(g=0),e.fx.off&&(n=0),"string"==typeof r)C[l]=r,C[d]=n+"s",C[h]=g+"s",C[p]=f||"linear",F=e.fx.animationEnd;else{for(w in y=[],r)v.test(w)?S+=w+"("+r[w]+") ":(C[w]=r[w],y.push(i(w)));S&&(C[a]=S,y.push(a)),n>0&&"object"==typeof r&&(C[o]=y.join(", "),C[s]=n+"s",C[u]=g+"s",C[c]=f||"linear")}return b=function(t){if(void 0!==t){if(t.target!==t.currentTarget)return;e(t.target).unbind(F,b)}else e(this).unbind(F,b);k=!0,e(this).css(_),m&&m.call(this)},n>0&&(this.bind(F,b),setTimeout((function(){k||b.call(x)}),1e3*(n+g)+25)),this.size()&&this.get(0).clientLeft,this.css(C),n<=0&&setTimeout((function(){x.each((function(){b.call(this)}))}),0),this},g=null}(F$),function(e,t){function i(i,r,n,a,o){"function"!=typeof r||o||(o=r,r=t);var s={opacity:n};return a&&(s.scale=a,i.css(e.fx.cssPrefix+"transform-origin","0 0")),i.animate(s,r,null,o)}function r(t,r,n,o){return i(t,r,0,n,(function(){a.call(e(this)),o&&o.call(this)}))}window.document;var n=e.fn.show,a=e.fn.hide,o=e.fn.toggle;e.fn.show=function(e,r){return n.call(this),e===t?e=0:this.css("opacity",0),i(this,e,1,"1,1",r)},e.fn.hide=function(e,i){return e===t?a.call(this):r(this,e,"0,0",i)},e.fn.toggle=function(i,r){return i===t||"boolean"==typeof i?o.call(this,i):this.each((function(){var t=e(this);t["none"==t.css("display")?"show":"hide"](i,r)}))},e.fn.fadeTo=function(e,t,r){return i(this,e,t,null,r)},e.fn.fadeIn=function(e,t){var i=this.css("opacity");return i>0?this.css("opacity",0):i=1,n.call(this).fadeTo(e,i,t)},e.fn.fadeOut=function(e,t){return r(this,e,null,t)},e.fn.fadeToggle=function(t,i){return this.each((function(){var r=e(this);r[0==r.css("opacity")||"none"==r.css("display")?"fadeIn":"fadeOut"](t,i)}))}}(F$),function(e){function t(t,r){var c=t[s],u=c&&n[c];if(void 0===r)return u||i(t);if(u){if(r in u)return u[r];var l=o(r);if(l in u)return u[l]}return a.call(e(t),r)}function i(t,i,a){var c=t[s]||(t[s]=++e.uuid),u=n[c]||(n[c]=r(t));return void 0!==i&&(u[o(i)]=a),u}function r(t){var i={};return e.each(t.attributes||c,(function(t,r){0==r.name.indexOf("data-")&&(i[o(r.name.replace("data-",""))]=e.zepto.deserializeValue(r.value))})),i}var n={},a=e.fn.data,o=e.camelCase,s=e.expando="Zepto"+ +new Date,c=[];e.fn.data=function(r,n){return void 0===n?e.isPlainObject(r)?this.each((function(t,n){e.each(r,(function(e,t){i(n,e,t)}))})):0 in this?t(this[0],r):void 0:this.each((function(){i(this,r,n)}))},e.data=function(t,i,r){return e(t).data(i,r)},e.hasData=function(t){var i=t[s],r=i&&n[i];return!!r&&!e.isEmptyObject(r)},e.fn.removeData=function(t){return"string"==typeof t&&(t=t.split(/\s+/)),this.each((function(){var i=this[s],r=i&&n[i];r&&e.each(t||r,(function(e){delete r[t?o(this):e]}))}))},["remove","empty"].forEach((function(t){var i=e.fn[t];e.fn[t]=function(){var e=this.find("*");return"remove"===t&&(e=e.add(this)),e.removeData(),i.call(this)}}))}(F$),function(e){function t(t){return!(!(t=e(t)).width()&&!t.height())&&"none"!==t.css("display")}function i(e,t){e=e.replace(/=#\]/g,'="#"]');var i,r,n=s.exec(e);if(n&&n[2]in o&&(i=o[n[2]],r=n[3],e=n[1],r)){var a=Number(r);r=isNaN(a)?r.replace(/^["']|["']$/g,""):a}return t(e,i,r)}var r=e.zepto,n=r.qsa,a=r.matches,o=e.expr[":"]={visible:function(){if(t(this))return this},hidden:function(){if(!t(this))return this},selected:function(){if(this.selected)return this},checked:function(){if(this.checked)return this},parent:function(){return this.parentNode},first:function(e){if(0===e)return this},last:function(e,t){if(e===t.length-1)return this},eq:function(e,t,i){if(e===i)return this},contains:function(t,i,r){if(e(this).text().indexOf(r)>-1)return this},has:function(e,t,i){if(r.qsa(this,i).length)return this},input(){if(-1!==["input","textarea","select"].indexOf(this.tagName.toLowerCase()))return this}},s=new RegExp("(.*):(\\w+)(?:\\(([^)]+)\\))?$\\s*"),c=/^\s*>/,u="Zepto"+ +new Date;r.qsa=function(t,a){return i(a,(function(i,o,s){try{var l;!i&&o?i="*":c.test(i)&&(l=e(t).addClass(u),i="."+u+" "+i);var d=n(t,i)}catch(e){throw console.error("error performing selector: %o",a),e}finally{l&&l.removeClass(u)}return o?r.uniq(e.map(d,(function(e,t){return o.call(e,t,d,s)}))):d}))},r.matches=function(e,t){return i(t,(function(t,i,r){return(!t||a(e,t))&&(!i||i.call(e,null,r)===e)}))}}(F$),function(e){function t(e,t,i,r){return Math.abs(e-t)>=Math.abs(i-r)?e-t>0?"Left":"Right":i-r>0?"Up":"Down"}function i(){p=null,_.last&&(_.el.trigger("longTap"),_={})}function r(){p&&clearTimeout(p),p=null}function n(){u&&clearTimeout(u),l&&clearTimeout(l),d&&clearTimeout(d),p&&clearTimeout(p),u=l=d=p=null,_={}}function a(e){return("touch"==e.pointerType||e.pointerType==e.MSPOINTER_TYPE_TOUCH)&&e.isPrimary}function o(e,t){return e.type=="pointer"+t||e.type.toLowerCase()=="mspointer"+t}function s(){y&&(e(document).off(v.down,f).off(v.up,m).off(v.move,g).off(v.cancel,n),e(window).off("scroll",n),n(),y=!1)}function c(c){var b,C,S,x,F=0,k=0;s(),(v=c&&"down"in c?c:"ontouchstart"in document?{down:"touchstart",up:"touchend",move:"touchmove",cancel:"touchcancel"}:"onpointerdown"in document?{down:"pointerdown",up:"pointerup",move:"pointermove",cancel:"pointercancel"}:"onmspointerdown"in document&&{down:"MSPointerDown",up:"MSPointerUp",move:"MSPointerMove",cancel:"MSPointerCancel"})&&("MSGesture"in window&&((h=new MSGesture).target=document.body,e(document).bind("MSGestureEnd",(function(e){var t=e.velocityX>1?"Right":e.velocityX<-1?"Left":e.velocityY>1?"Down":e.velocityY<-1?"Up":null;t&&(_.el.trigger("swipe"),_.el.trigger("swipe"+t))}))),f=function(t){(x=o(t,"down"))&&!a(t)||(S=x?t:t.touches[0],t.touches&&1===t.touches.length&&_.x2&&(_.x2=void 0,_.y2=void 0),b=Date.now(),C=b-(_.last||b),_.el=e("tagName"in S.target?S.target:S.target.parentNode),u&&clearTimeout(u),_.x1=S.pageX,_.y1=S.pageY,C>0&&C<=250&&(_.isDoubleTap=!0),_.last=b,p=setTimeout(i,w),h&&x&&h.addPointer(t.pointerId))},g=function(e){(x=o(e,"move"))&&!a(e)||(S=x?e:e.touches[0],r(),_.x2=S.pageX,_.y2=S.pageY,F+=Math.abs(_.x1-_.x2),k+=Math.abs(_.y1-_.y2))},m=function(i){(x=o(i,"up"))&&!a(i)||(r(),_.x2&&Math.abs(_.x1-_.x2)>30||_.y2&&Math.abs(_.y1-_.y2)>30?d=setTimeout((function(){_.el&&(_.el.trigger("swipe"),_.el.trigger("swipe"+t(_.x1,_.x2,_.y1,_.y2))),_={}}),0):"last"in _&&(F<30&&k<30?l=setTimeout((function(){var t=e.Event("tap");t.cancelTouch=n,_.el&&_.el.trigger(t),_.isDoubleTap?(_.el&&_.el.trigger("doubleTap"),_={}):u=setTimeout((function(){u=null,_.el&&_.el.trigger("singleTap"),_={}}),250)}),0):_={}),F=k=0)},e(document).on(v.up,m).on(v.down,f).on(v.move,g),e(document).on(v.cancel,n),e(window).on("scroll",n),y=!0)}var u,l,d,p,h,f,m,g,v,_={},w=750,y=!1;["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach((function(t){e.fn[t]=function(e){return this.on(t,e)}})),e.touch={setup:c},e(document).ready(c)}(F$);var Fera=Fera||{},BananaStand=BananaStand||Fera;Fera.App=function(opts){this.version="2.7.6.1";var self=this,containers,config,api,currProductId,customerId,visitorId,platformAdapter,section,containerAutoUpdateTimer,contentUpdatesStarted=!1,isViewingProductPage=!1,pushedViewEvent=!1,showedDevGreeting=!1,pushMethodReady=!1,currProduct,compiledCss="",variantId;opts=opts||{};var updateRequestInProgress=!1,eventListeners={"timers.reset":[],"feeds.reset":[],"cart.emptied":[],"cart.changed":[],"cart.add":[],"cart.ready":[],"variant.change":[],"product.change":[],"product.set":[],"widgets.show":[],"widget.create":[],"widget.create:before":[],"widget.create:after":[],"widget.update":[],"notification.show":[],init:[],ready:[],load:[],"skill.create":[],"skill.create:before":[],"skill.create:after":[],"skill.update":[],"submitter:show":[],"submitter:hide":[],"submitter:submit":[],"submitter:complete":[]},init=function(){opts.app=self,self.parentWindow=opts.parentWindow,Fera.Util.checkLocalStorageEnabled()?messageStatusToParent("fera_starting"):messageStatusToParent("storage_unsupported"),self.cookieJar=opts.cookieJar=new Fera.CookieJar,self.localStorage=opts.localStorage=new Fera.LocalStorageJar(opts),self.opts=opts.optionsParser=new Fera.OptionsParser(opts),parseModes(),self.logger=Fera.logger=opts.logger=new Fera.Logger(opts),self.timeTracker=opts.timeTracker=new Fera.TimeTracker(opts),self.engagementTracker=opts.engagementTracker=new Fera.EngagementRegistry(opts),self.abTests=new Fera.AbTests.Manager(opts),opts.optionsParser.hasUrlFlag("clear_cache")&&self.clearCache(),Fera.Util.ie()&&opts.logger.warn("Fera.ai is not optimized for Microsoft Internet Explorer. You should really update to a more modern browser!"),opts.logger.log("~~ Loaded app.js version "+self.version+" ~~"),self.geo=opts.geo=new Fera.Geo(opts),self.inactivityDetector=opts.inactivityDetector=new Fera.InactivityDetector({logger:opts.logger}),self.deepLinker=new Fera.DeepLinker(opts),self.deepLinker.attachAndWatch(),self.geo.getLocationInfo((function(e){opts.shopperLocation=e,delete opts.shopperLocation.ip,loadSupportModules();var t=opts.sandboxMode?Fera.Preview_Api:Fera.Api;api=new t(opts),self.api=opts.api=api,loadPushBuffer({only:"configure"}),ensureVisitorId(),opts.visitorId=visitorId,ensureBodyContainersPresent(),loadPushBuffer({only:"loadPlatformAdapter"}),abortLoading()?loadAdmin(!1):(self.i18n=Fera.i18n=new Fera.I18n(opts),self.t=e=>self.i18n.t(e),Fera.t=function(e){return Fera.i18n.t(e)},Fera.isSupportedLanguage=function(e){return Fera.i18n.isSupportedLanguage(e)},Fera.Liquid.Template.registerFilter({t:e=>self.t(e)}),loadPushBuffer({only:"setLocale"}),loadPushBuffer({only:"setDefaultLocale"}),self.cart=new Fera.Cart(opts),platformAdapter&&platformAdapter.cartAdapter&&(self.cart.setAdapter(platformAdapter.cartAdapter),self.trigger("cart.ready")),self.api.checkConfig()?(self.verifier=new Fera.Verifier(opts),loadContainers(),loadPushBuffer({except:["loadPlatformAdapter","configure","setLocale","setDefaultLocale"]}),api.waitForApiConfig((function(){api.checkConfig()?(self.clickTracker=opts.clickTracker=new Fera.ClickRegistry(opts),contentUpdatesStarted||waitForSupportModules((function(){setTimeout(startServerUpdating,1)})),self.isReady=!0,self.trigger("init ready"),loadAdmin(!0)):loadAdmin(!1)}))):loadAdmin(!1))}),!0)},abortLoading=function(){if(window.location.pathname&&(0===window.location.pathname.indexOf("/password")||!self.api.validConfig()&&"undefined"!=typeof Shopify&&Shopify.Checkout&&Shopify.Checkout.isOrderStatusPage))return Fera.logger.log("Intentionally aborted loading, likely due to a missing API key on the page."),self.aborted=!0,!0;return self.opts.sandboxMode&&self.opts.sandboxError},loadAdmin=function(e){if(opts.adminMode){if((e=void 0===e||e)||opts.api.configure({api_url:decodeURIComponent(opts.cookieJar.getCookie("Fera.Admin.BaseApiUrl")),store_pk:opts.cookieJar.getCookie("Fera.Admin.Store.PublicKey")}),void 0!==Fera.AdminPanel)return setupAdmin(e);var t="";-1!==opts.api.baseAppPath.indexOf("app.")?t+=opts.api.baseAppPath.replace("app.","cdn.")+"/js/fera.admin.js?v="+self.version:t=-1!==opts.api.baseAppPath.indexOf("ngrok.")||-1!==opts.api.baseAppPath.indexOf("localhost")||-1!==opts.api.baseAppPath.indexOf("test-")||-1!==opts.api.baseAppPath.indexOf("127.0.0.1")?opts.api.baseAppPath+"/assets/public/fera.admin.js?v="+self.version:"https://cdn.fera.ai/js/fera.admin.js?v="+self.version;var i=opts.debugMode?1:900;new FeraCachedAsset({name:"Fera.Admin.Js",url:t,expiresIn:i}).load((function(){setupAdmin(e)}))}},setupAdmin=function(e){try{opts.sandboxMode&&(messageStatusToParent("fera_admin_starting"),opts.app.previewer=opts.previewer=new Fera.AdminPreviewer(opts,e),self.parentWindow!==window.opener&&null!=self.parentWindow||(opts.adminPanel=new Fera.AdminPanel(opts),opts.adminPanel.managePreviewMode()));var t=opts.optionsParser.parseCheckIntegration();t&&new Fera.AdminIntegrationChecker(opts).check(t)}catch(e){if(opts.debugMode)throw e}},messageStatusToParent=function(e){try{var t=opts.api&&opts.api.baseAppPath?opts.api.baseAppPath:"*";opts.parentWindow&&opts.parentWindow.postMessage(JSON.stringify({methodName:"sandbox_previewer.status.update",params:{status:e}}),t)}catch(e){}};self.push=function(e,t){if(pushMethodReady){if(opts.debugMode)return _push(e,t);try{return _push(e,t)}catch(e){window.console&&!Fera.Util.ie()&&window.console.error(e)}}else opts.pushBuffer=opts.pushBuffer||[],opts.pushBuffer.push(e),void 0!==t&&opts.pushBuffer.push(t)},self.setSection=function(e){return section=e,self},self.getSection=function(){return section},self.dispatchEvent=function(e,t,i){i=i||function(){},containers.dispatchEvent(e,t,i)},self.loadPlatformAdapter=function(code,params){if(platformAdapter)return platformAdapter;var _opts=opts||{};if(_opts.params=params,_opts.addToCartCallback=self.pushAddToCartEvent,-1!==opts.supportedPlatforms.indexOf(code)){var adapterKlass=eval("Fera."+Fera.Util.capitalizeFirstLetter(code)+"Adapter");platformAdapter=new adapterKlass(_opts)}else{if("function"!=typeof code)return opts.logger.logWarning("Unknown platform code supplied: '"+code+"'. Valid codes are: "+opts.supportedPlatforms.join(",")),self.loadPlatformAdapter("custom",params);platformAdapter=code(_opts)}},self.setProduct=function(e){var t=currProduct;return void 0!==(currProduct=e).id&&self.setProductId(currProduct.id),isViewingProductPage=!0,t&&t!=currProduct&&(self.trigger("product.change",{old:t,new:currProduct}),self.refreshContent()),!t&&currProduct&&self.trigger("product.set"),self},self.setProductId=function(e){e&&e.trim&&(e=e.trim());var t=currProductId;return isViewingProductPage=!0,t!=(currProductId=e)&&(contentUpdatesStarted&&self.trigger("product.change",{old:{id:t},new:{id:currProductId}}),self.getVariantId()&&t&&self.setVariantId(null,!1)),!t&&currProductId&&self.trigger("product.set"),self},self.getProductId=function(){if(currProductId)return currProductId;if(currProduct){if(currProduct.id)return currProduct.id;if("function"==typeof currProduct.getId)return currProduct.getId()}return currProductId},self.getProduct=function(){return currProduct},self.setVariantId=function(e){var t=variantId;return variantId=e,t&&t!==variantId&&self.trigger("variant.change",{old:{id:t},new:{id:variantId}}),self},self.setDesignMode=function(e){return self.opts.designMode=!!e,e&&Fera.logger.log("Design mode activated."),this},self.setAdminMode=function(e){return self.opts.adminMode=!!e,e&&Fera.logger.log("Admin mode activated."),this},self.isDesignMode=function(){return!!self.opts.designMode},self.showContentSubmission=function(e){return getContentSubmitter().show(e)},self.showContentSubmitter=self.showContentSubmission,self.showContentSubmit=self.showContentSubmission,self.showSubmissionModal=self.showContentSubmission,self.writeReview=self.showContentSubmission,self.editReview=function(e){return e.edit=!0,getContentSubmitter().show(e)},self.getVariantId=function(){return variantId},self.setCart=function(e){return self.cart.loadCartData(e),self},self.setShopper=function(e){if(Fera.Util.sizeOfParams(e)>1024)opts.logger.error("Error: parameter size is larger than 1024 bytes");else{var t=getShopperAttributes();opts.cookieJar.setCookieObject(shopperAttributesKey(),F$.extend(t,e),1)}};var getShopperAttributes=function(){return opts.cookieJar.getCookieObject(shopperAttributesKey())},shopperAttributesKey=function(){return"Fera.App.currentShopper"};self.getVisitorId=function(){return visitorId},self.getShopperId=self.getVisitorId,self.pushOrder=function(e,t){var i;void 0!==e.data?i=e:(i={type:"order_create"},void 0!==e.order?i.data=e:i.data={order:e}),i.data.ab_tests=self.ab_tests,api.pushEvent(i,t)},self.pushConversion=self.pushOrderEvent=self.pushConversionEvent=self.pushOrder,self.setCustomerId=function(e){return customerId=e,self},self.getCustomerId=function(){return customerId},self.configure=function(e){config=e,api.configure(config)},self.pushAddToCartEvent=function(e){var t={type:"product_add_to_cart"};e&&(e.data?t.data=e.data:t.data=e),self.trigger("cart.add",e),self.pushEvent(t)},self.addProductToCart=function(e,t){platformAdapter&&"function"==typeof platformAdapter.addProductToCart&&platformAdapter.addProductToCart(e,t)},self.triggerWidget=function(e,t){containers.triggerSkill(e,t)},self.triggerSkill=self.triggerWidget,self.trigger=function(e,t){e=e.split(" ");for(var i=0;i<e.length;i++){var r=e[i],n=eventListeners[r]||[];/skill.\d+.(create|update)/.test(r)&&n.concat(eventListeners[r.replace(/skill.\d+./,"skill.")||[]]);for(var a=0;a<n.length;a++)n[a](t)}},self.on=function(e,t){e=e.split(" ");for(var i=0;i<e.length;i++){var r=e[i].trim();if(eventListeners[r])eventListeners[r].push(t);else if(/skill.\d+.(create|update)/.test(r))eventListeners[r]=[t];else{var n=Object.keys(eventListeners).join(", ");self.logger.warn("Invalid event code requested: '"+r+"'. Valid event codes are: "+n)}"ready"===r&&self.isReady&&self.trigger("ready")}},self.formatCurrency=function(e){if(!e)return"";if(e=parseFloat(e),platformAdapter&&platformAdapter.formatCurrency){var t=platformAdapter.formatCurrency(e);if(!1!==t&&null!=t)return t}var i=self.storeSettings.currency_template.replace(/{{[ ]?amount[ ]?}}/,e.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","));return i=(i=i.replace(/{{[ ]?amount_no_decimals[ ]?}}/,Math.round(e).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",").replace(/^(.+)\.00$/,"$1"))).replace(/{{[ ]?amount_with_comma_separator[ ]?}}/,e.toFixed(2).toString().replace(".",","))},self.getState=function(e){if(!self.state){var t=opts.sandboxMode?Fera.Preview_State:Fera.State;self.state=new t(opts)}return self.state.getData(e)},self.updateContainers=function(e,t,i){var r={};t=t||function(){},void 0===e&&(e=!1);var n=$(".fera-view-container[data-product_id],.banana-view-container[data-product_id]");1===n.length&&n.data("product_id")&&(self.getProductId()||self.setProductId(n.data("product_id")));var a=loadContentRequestContexts();Object.keys(a).length>0&&(r.contexts=JSON.stringify(a));var o={};Object.keys(a).forEach((e=>{const t=$(`[data-fera-context="${e}"]`);if(!(t.length<1)){var i=t.data("settings");i&&(o[e]={settings:i})}})),Object.keys(o).length>0&&(r.transient_settings=JSON.stringify(o)),self.getState((function(n){if(r.state=n,r.content_requests=void 0===i?containers.getContentRequest({defaultProductId:currProductId}):i,r.content_requests.length<1&&!e)return t();if(r.content_requests_json=JSON.stringify(r.content_requests),delete r.content_requests,updateRequestInProgress=!0,!opts.sandboxMode){var a=getShopperAttributes();a&&(r.shopper_attributes=a),loadCompiledCssFromCache(),!self.storeSettings&&self.localStorage.getObject("storeSettings")&&(self.storeSettings=self.localStorage.getObject("storeSettings",{}),setTranslationSettings(),containers.updateContentFromCache())}api.getContent(r,(function(e){e&&(updateRequestInProgress=!1,Fera.Util.isSpeedMode()?opts.inactivityDetector.afterFirstInteraction((function(){callBackFromGetContent(e,t)}),2e4):callBackFromGetContent(e,t))}),(function(){updateRequestInProgress=!1}))}))};var pushLegacyViewEvent=function(){if(opts.sandboxMode)return!1;if(pushedViewEvent)return!1;pushedViewEvent=!0;var e=()=>{const e={type:"page_view"};isViewingProductPage&&(e.associated_to="product"),self.pushEvent(e)};if(self.storeSettings&&self.storeSettings.when_to_send_events){var t=self.storeSettings.when_to_send_events.page_view;self.getProductId()&&(t=self.storeSettings.when_to_send_events.product_view),null==t&&(t=0),opts.inactivityDetector.afterFirstInteraction((function(){setTimeout(e,1e3*t+1)}),1e3*t+1)}else e();return!0},callBackFromGetContent=function(e,t){self.displayDevGreeting(),updateCompiledCssFromServer(e),e.store&&(self.storeSettings=e.store,setTranslationSettings(),opts.sandboxMode||self.localStorage.setObject("storeSettings",self.storeSettings)),!e.section||self.getSection()&&"other"!==self.getSection()||self.setSection(e.section),self.abTests.updateBuckets(e.ab_tests),containers.updateContent(e,currProductId,t),pushLegacyViewEvent(),self.clickTracker.register(),setTimeout((function(){self.trigger("load widgets.show"),self.loaded=!0}),1)};self.clearCache=function(){new Fera.LocalStorageJar({namespace:"Fera.AssetCache"}).clear(),new Fera.LocalStorageJar({namespace:"BananaStand.AssetCache"}).clear(),new Fera.LocalStorageJar({namespace:"Fera.Cache"}).clear(),Fera.Util.$()('script[src*="fera.js"],script[src*="fera.placeholder.js"],script[src*="bananastand.js"],script[src*="fera.standalone.js"]').each((function(){var e=this.src.replace("https://cdn.jsdelivr.net/gh/feracommerce/ferajs@latest/dist/","https://cdn.fera.ai/js/");e+=-1===e.indexOf("?")?"?":"&",e=(e+="v="+self.version+"p").replace(".placeholder.","."),Fera.Util.$().ajax({method:"GET",type:"GET",url:e})})),Fera.logger.log("CLEARED Fera cache.")};var loadContentRequestContexts=function(){var e={},t=[];$("[data-fera-container]").each((function(){var i,r=$(this),n=r.data("fera-container"),a=r.data("product-id")||r.data("productId")||r.data("product_id");if(a||"string"!=typeof r.data("product")||r.data("product").match(/^{/)||(a=r.data("product")),a&&a.toString&&a.toString().match(/{{\s*product\.id\s*}}/)){if(Fera.logger.warn("TAG NOT SETUP PROPERLY (product ID not rendered). Please contact our support team for help.",r),!self.getProductId())return;a=self.getProductId(),r.data("product-id",a)}if(a&&a.trim&&(a=a.trim()),"string"==typeof n&&n.match(/^[a-z_]+$/i)){var o=r.data("block-id")||r.data("block_id")||r.data("block"),s=r.data("editor-id")||r.data("editor_id")||r.data("editor");o||(o=Fera.Util.generateUUID()),s&&-1===o.indexOf("#")&&(o=`${s}#${o}`),r.attr("data-block-id")||r.attr("data-block-id",o),r.attr("data-block")&&r.prop("data-block",!1),r.attr("data-block_id")&&r.prop("data-block_id",!1),r.attr("data-editor-id")||r.attr("data-editor-id",s),r.attr("data-editor")&&r.prop("data-editor",!1),r.attr("data-editor_id")&&r.prop("data-editor_id",!1),i=o?`${n}.${o}`:n,r.attr("data-fera-context",i)}else{if(!a)return;i=n}e[i]=e[i]||[],a&&e[i].push(a),-1===t.indexOf(i)&&t.push(i)})),$(".banana-list-container").each((function(){var t=$(this),i=t.data("product-id")||t.data("productId")||t.data("product_id");i&&(e.list=e.list||[],e.list.push(i))})),$("[data-fera-context]").each((function(){e.list=e.list||[];var t=$(this).data("product-id");t&&e.list.push(t)}));for(var i=0;i<t.length;i++)e[t[i]]=e[t[i]].sort();return e};self.markAllContainersAsDirty=function(){containers&&containers.markAllContainersAsDirty()};var refreshContentNow=function(e){if(containers)return containers.markAllContainersAsDirty(),self.updateContainers(!1,e),self.refreshContentCount++,self},refreshContent=function(e){return self.opts.testMode||self.opts.adminMode||self.opts.previewMode||self.opts.sandboxMode?refreshContentNow(e):(self.refreshContentCount=self.refreshContentCount||0,self.refreshContentCount<3?refreshContentNow(e):self.refreshContentCount<10?(Fera.logger.log("Content refresh was throttled due to frequency (1s)"),refreshContentThrottle1(e)):self.refreshContentCount<50?(Fera.logger.log("Content refresh was throttled due to frequency (15s)"),refreshContentThrottle2(e)):self.refreshContentCount<100?(Fera.logger.log("Content refresh was throttled due to frequency (1min)"),refreshContentThrottle3(e)):self.refreshContentCount<250?(Fera.logger.log("Content refresh was throttled due to frequency (15min)"),refreshContentThrottle4(e)):(Fera.logger.log("Content refresh was throttled due to frequency (1hr)"),refreshContentThrottle5(e)))},refreshContentThrottle1=Fera.Util.throttle(refreshContentNow,1e3),refreshContentThrottle2=Fera.Util.throttle(refreshContentNow,15e3),refreshContentThrottle3=Fera.Util.throttle(refreshContentNow,6e4),refreshContentThrottle4=Fera.Util.throttle(refreshContentNow,9e5),refreshContentThrottle5=Fera.Util.throttle(refreshContentNow,36e5);self.refreshContent=Fera.Util.debounce(refreshContent,1),self.updateAllContainers=self.refreshContent,self.forceRefreshContent=function(e){containers.each((function(e){e.removingAllBlocks=!0,"function"==typeof e.removeAllBlocks&&e.removeAllBlocks()})),$("[data-fera-widget]").remove(),setTimeout((function(){containers.each((function(e){e.removingAllBlocks=!1}))}),1),refreshContentNow(e)},self.clearSeenHistory=function(){containers.each((function(e){e.clearSeenHistory&&e.clearSeenHistory()}))},self.getContainers=function(){return containers},self.getContainerById=function(e){return containers.getContainerById(e)},self.pushEvent=function(e,t){return self.getState((function(i){e.state=i,e.visitor_id=visitorId,"add_to_cart"===e.type&&(e.type="product_add_to_cart"),e.shopper_attributes=getShopperAttributes();var r=opts.optionsParser.detectCustomerName();r&&(e.shopper_attributes||(e.shopper_attributes={}),e.shopper_attributes.name||(e.shopper_attributes.name=r)),"function"==typeof e.callback&&t&&"function"!=typeof t.callback&&(t.callback=e.callback,delete e.callback),"object"==typeof e.data&&"function"==typeof e.data.callback&&t&&"function"!=typeof t.callback&&(t.callback=e.data.callback,delete e.data.callback),api.pushEvent(e,t)})),self},self.checkIn=function(e,t){e=e||{};var i={callback:t||e.callback};api.checkIn(e,i)},self.getCurrentShopperId=function(e){return e&&"function"==typeof e.callback?e.callback(visitorId):visitorId},self.displayDevGreeting=function(){return!showedDevGreeting&&(!(!window.console||Fera.Util.ie())&&((!self.opts.feraParams||!self.opts.feraParams.quiet)&&(!self.localStorage.getItem("DevGreeting.shown",!1)&&((opts.debugMode?opts.logger.log:window.console.log)("\ud83d\udc4b Hello developer! We've optimized performance and encapsulated functionality to ensure our system never breaks anything. Shoot a message to dev"+String.fromCharCode(64)+"fera.ai if you've got any questions.\nLearn more about Fera @ https://fera.ai?dev=1\nHappy coding!\ud83d\udc4b"),self.localStorage&&self.localStorage.setItem("DevGreeting.shown",!0,9e5),showedDevGreeting=!0))))},self.getShopper=function(e){api.getShopper(visitorId,e)},self.deleteShopper=function(e){api.deleteShopper(visitorId,e)};var getContentSubmitter=function(){return self.contentSubmitter||(self.contentSubmitter=new Fera.ContentSubmission.Submitter(opts)),self.contentSubmitter},convertOptsToV3ApiListParams=function(e,t){return"function"==typeof e?[{},e]:"string"==typeof e||"number"==typeof e?[{product_ids:[e]},t]:Array.isArray(e)?[{product_ids:e},t]:[e,t]};self.getRating=function(e,t){api.getRating(e,t)},self.getRatings=function(e,t){const[i,r]=convertOptsToV3ApiListParams(e,t);return api.getRatings(i,r)},self.getReviews=function(e,t){const[i,r]=convertOptsToV3ApiListParams(e,t);return api.getReviewsV3(i,r)},self.getMedia=function(e,t){const[i,r]=convertOptsToV3ApiListParams(e,t);return api.getMediaV3(i,r)};var _push=function(e,t){var i,r="function"==typeof(i="object"==typeof e?e:{action:e,data:t,callback:"object"==typeof t?t.callback:void 0}).callback?i.callback:function(){};if("configure"==i.action)self.configure(i.data);else if("setCustomerId"==i.action)"string"==typeof i.customer_id||"number"==typeof i.customer_id?self.setCustomerId(i.customer_id):"string"==typeof i.id||"number"==typeof i.id?self.setCustomerId(i.id):void 0!==t?self.setCustomerId(t.id||t):opts.logger.error("Invalid syntax for method call setCustomerId: ",i);else if("setProduct"==e||"setCurrentProduct"==e)self.setProduct(t);else if("showContentSubmission"==e||"showContentSubmit"==e||"review"==e||"r"==e)self.showContentSubmission(t);else if("setProductId"===i.action)"string"==typeof t||"number"==typeof t?self.setProductId(t):i?void 0!==i.product_id?self.setProductId(i.product_id):void 0!==i.id?self.setProductId(i.id):void 0!==i.data?void 0!==i.data.product_id?self.setProductId(i.data.product_id):void 0!==i.data.id?self.setProductId(i.data.id):self.setProductId(i.data):self.setProductId(null):opts.logger.error("Invalid syntax for method call setProductId: ",i);else if("setVariantId"===i.action)"string"==typeof t||"number"==typeof t?self.setVariantId(t):i?void 0!==i.variant_id?self.setVariantId(i.variant_id):void 0!==i.id?self.setVariantId(i.id):void 0!==i.data?void 0!==i.data.variant_id?self.setVariantId(i.data.variant_id):void 0!==i.data.id?self.setVariantId(i.data.id):self.setVariantId(i.data):self.setVariantId(null):opts.logger.error("Invalid syntax for method call setVariantId: ",i);else if("getCurrentShopperId"==i.action||"getShopperId"==i.action)self.getCurrentShopperId(i.data);else if("triggerSkill"==i.action)self.triggerSkill(t.id||t.skill_id||t.widget_id||t.widgetId||t.skillId,t.data||t.optionalData||t.optional_data);else if("setCart"==i.action)self.setCart(i.cart||i.data||t||("object"==typeof t?t.cart:null));else if(-1!==["pushOrder","pushOrderEvent","order","orderEvent","conversion","conversionEvent","pushConversion","pushConversionEvent"].indexOf(e))self.pushOrder(t);else if(-1!==["pushAddToCart","pushAddToCartEvent","addToCart","add_to_cart","product_add_to_cart"].indexOf(e))self.pushAddToCartEvent(t);else if("pushEvent"==i.action||"event"==i.action)self.pushEvent(t);else if("loadPlatformAdapter"==i.action)"string"==typeof e&&"string"==typeof t?self.loadPlatformAdapter(t,{}):self.loadPlatformAdapter(i.code||i.adapter,i);else if("updateContainers"==i.action)self.updateContainers(!1,r);else if("startProductPageViewing"==i.action)self.startProductPageViewing(r);else if("dispatchEvent"==i.action)self.dispatchEvent(i.code,i.data,r);else if("getShopper"==i.action)self.getShopper(r);else if("deleteShopper"==i.action)self.deleteShopper(r);else if("on"===i.action)self.on(i.data.event,i.data.callback);else if("setShopper"==i.action){i.data||i.shopper;self.setShopper(i.data||i.shopper)}else"function"==typeof self[i.action]?self[i.action](i.data):opts.logger.error("Unknown action: ",i.action)},$=function(e){return Fera.Util.$()(e)},addBodyContainers=function(){document.getElementsByClassName("banana-globalBottom-container").length>0||$("body").append('<div class="banana-container banana-globalBottom-container" data-container_type="global_bottom" style="display: none;"></div>')},ensureBodyContainersPresent=function(){setInterval(addBodyContainers,10),addBodyContainers()},updateCompiledCssFromServer=function(e){if(e&&e.content_responses){var t=e.compiled_css;t&&(compiledCss.replace(/\s/gi,"").indexOf(t.replace(/\s/gi,""))&&(compiledCss=self.opts.testMode||self.opts.previewMode?t:(compiledCss+" "+t).trim(),updateCompiledCss(compiledCss)),saveCompiledCssToCache(compiledCss))}},saveCompiledCssToCache=function(e){self.localStorage.setItem("Cache.CompiledCss",e,36e5)},loadCompiledCssFromCache=function(){if(self._madeFirstRequest)return!1;if(self.opts.testMode||self.opts.adminMode||self.opts.previewMode)return!1;var e=self.localStorage.getItem("Cache.CompiledCss","");return!!e&&(updateCompiledCss(e),!0)},updateCompiledCss=function(e){var t=$("#feraCompiledCss");t.length<1&&(t=$('<span style="display: none" id="feraCompiledCss"></span>'),$("body").append(t)),t.html("<style>"+e+"</style>")},startServerUpdating=function(e){opts.logger.log("Starting server update timer..."),e=e||function(){},contentUpdatesStarted?opts.logger.log("startServerUpdating was already called, so returning..."):(startCheckIns(),containers.startWatchingForChanges(),contentUpdatesStarted=!0,self.updateContainers(!pushedViewEvent,e),self._madeFirstRequest=!0,self.on("cart.changed",(function(){self.markAllContainersAsDirty()})))},startCheckIns=function(){var e=config.page_view_check_interval||3e5,t=e;if(Fera.Util.isSpeedMode())return!1;setInterval((function(){(t-=1e3)<=0&&opts.inactivityDetector.isActive()&&(isViewingProductPage&&currProductId&&self.checkIn(),t=e)}),1e3)},parseModes=function(){self.opts.debugMode=opts.debugMode=opts.optionsParser.parseDebugMode(),self.opts.testMode=opts.testMode=opts.optionsParser.parseTestMode(),self.opts.adminMode=opts.adminMode=opts.optionsParser.parseAdminMode(),self.opts.sandboxMode=opts.sandboxMode=opts.optionsParser.parseSandboxMode(),self.opts.showErrors=opts.showErrors=self.opts.debugMode||opts.optionsParser.parseShowErrors(),
$('[data-fera-container][data-design-mode="true"]').length>0&&(self.opts.designMode=!0),(self.opts.adminMode||self.opts.testMode||self.opts.debugMode||self.opts.sandboxMode||self.opts.feraParams&&self.opts.feraParams.quiet)&&(Fera.Util.setIsBot(!1),Fera.Util.setIsSpeedMode(!1))},loadContainers=function(){(containers=new Fera.ContainerCollection(opts)).updateContainers=self.updateContainers,containers.getContext=loadContentRequestContexts,opts.contentUpdater=containers,opts.containers=containers},loadPushBuffer=function(e){var t=void 0!==(e=e||{}).except&&e.except,i=void 0!==e.only&&e.only;if(opts.pushBuffer=opts.pushBuffer||[],pushMethodReady=!0,"object"==typeof opts.pushBuffer&&opts.pushBuffer.length&&opts.pushBuffer.length>0)for(var r=!1,n=0;n<opts.pushBuffer.length;n++)if(r)r=!1;else{var a=opts.pushBuffer[n];if(t){for(var o=!1,s=0;s<e.except.length;s++)if("string"==typeof a){if(a===e.except[s]){o=!0,r=!0;break}}else if(a.action===e.except[s]){o=!0;break}if(o)continue}if("string"==typeof a){if(i&&a!==e.only)continue;self.push(a,opts.pushBuffer[n+1]),r=!0}else{if(i&&a.action!==e.only)continue;self.push(a)}}},ensureVisitorId=function(){self.visitorManager=new Fera.VisitorManager(opts),visitorId=self.visitorManager.ensureVisitorId()},loadSupportModules=function(){self.supportModules={instant_click:new Fera.InstantClickSupport(opts),shogun:new Fera.ShogunSupport(opts),weglot:new Fera.WeglotSupport(opts),anti_spy:new Fera.AntiSpySupport(opts)}},allSupportModulesReady=function(){for(var e=Object.keys(self.supportModules),t=0;t<e.length;t++)if(!1===self.supportModules[e[t]].isReady)return!1;return!platformAdapter||!1!==platformAdapter.isReady},waitForSupportModules=function(e){if(allSupportModulesReady())return e();var t=0,i=setInterval((function(){if(allSupportModulesReady())return clearInterval(i),e();1e3===(t+=10)&&Fera.logger.warn("Support modules too longer than 1s to load and are blocking Fera from loading.")}),10)};self.startProductPageViewing=function(){};var setTranslationSettings=function(){self.storeSettings.language&&(self.locale||self.setLocale(self.storeSettings.language),self.locale!==self.storeSettings.language&&self.setDefaultLocale(self.storeSettings.language)),self.storeSettings.translated_strings&&self.i18n&&self.i18n.setTranslatedStrings(self.storeSettings.translated_strings)};self.setLocale=function(e){if(!e)return this;var t=e.split("-");t.length>1&&(e="zh"==t[0]?"zh-TW":t[0]),self.locale=e,self.i18n&&(self.i18n.locale=e)},self.setDefaultLocale=function(e){self.locale!==e&&self.i18n&&self.i18n.setDefaultLocale(e)},self.getLocaleWithFallback=function(){return self.i18n?self.i18n.localeWithFallback:self.locale},self.isUsingDefaultLocale=function(){return!self.i18n||self.i18n.usingDefaultLocale},init()},Fera.Api=class{constructor(e){this._opts=e||{},this._$=Fera.Util.$(),this._config={},this._app=this._opts.app,this.requestFailCount=0,this._pageLoaded=!1,this._apiClientDescriptor="fera.js-"+this._opts.app.version,this._DEFAULT_BASE_URL="https://app.fera.ai",this._$(document).ready((()=>this._pageLoaded=!0)),this._requestCache={}}configure(e){this._config=e;var t=this._opts.cookieJar.getCookie("Fera.Api.ServerNum",Math.random()<.5?1:2);this._opts.cookieJar.setCookie("Fera.Api.ServerNum",t,30);var i=`api${t&&t>1?t:""}.`;(!this._config.api_url||this._config.api_url.length<=0)&&(this._config.api_url=this._DEFAULT_BASE_URL.replace("//app.","//"+i)),this._config.api_url=this._config.api_url.replace("/api/v1/","/api/"),"/"!==this._config.api_url[this._config.api_url.length-1]&&(this._config.api_url=this._config.api_url+"/"),this.baseApiUrl=this._config.api_url,this.baseApiUrl=Fera.Util.htmlDecode(this.baseApiUrl),this.baseLegacyApiUrl=this.baseApiUrl.replace(/\/\/api[1-9]?\./,"//api0."),this.baseAppPath=this.baseApiUrl.replace(/^(https?:\/\/.*)\/api(\/v[0-9])?/i,"$1").replace(/(https?:\/\/)api[0-9]?\./i,"$1app.").replace(/\/$/,""),this.baseAppPath.match(/https?:\/\/app\./)?(this.baseCdnPath=this.baseAppPath.replace("app.","cdn."),this.baseFrontendPath=this.baseAppPath.replace("app.","www.")):(this._opts.debugMode?this.baseCdnPath=this.baseAppPath+"/cdn":this.baseCdnPath="https://cdn.fera.ai",this.baseFrontendPath="https://www.fera.ai"),this._isBot=Fera.Util.isBot()&&this.baseApiUrl.match(/\.fera\.ai/i)&&!this.baseApiUrl.match(/staging|test/i)}get _shopperDisabled(){return this._isBot||Fera.Util.isSpeedMode()||this._app.isDesignMode()}checkConfig(){return!!this.validConfig()||(this._opts.logger.error("Missing Fera API key. This usually means the footer script is missing (usually because your store theme was changed by someone or something).\nTry navigating to "+this._DEFAULT_BASE_URL+"/installation?reinstall=1 to fix this or contact our support team for help."),!1)}waitForApiConfig(e){var t,i=1e4,r=0,n=1,a=()=>this.validConfig()?(t&&clearInterval(t),e(),!0):((r+=n)===i&&this._opts.logger.warn("Waited more than "+i/1e3+" seconds for Fera api credentials and still don't have them. Please contact our support team for help if this is unexpected."),!1);a()||(t=setInterval(a,n))}validConfig(){return!(!this._config||!this._config.store_pk)}checkIn(e,t={}){var i=void 0===t.callback?()=>{}:t.callback;if(this._shopperDisabled)return i&&i();var r=JSON.parse(JSON.stringify(e));r.id=this._opts.visitorId,e.productId&&(r.product_id=e.productId,delete r.productId),e.customerId&&(r.customer_id=e.customerId,delete r.customerId),this._opts.testMode?this._opts.logger.warn("[TEST MODE] Not checking in because test mode is enabled, but the rest of the JS will think we did..",r):this._performImageRequest("v2/public/check.gif",r,i,this.baseLegacyApiUrl)}mergeShoppers(e,t){return!this._shopperDisabled&&this._$.ajax({method:"POST",type:"POST",data:{},headers:{"API-CLIENT":this._apiClientDescriptor},dataType:"html",url:this._url("v2/public/shoppers/"+e+"/merge",{other_id:t},this.baseLegacyApiUrl)})}pushEvent(e,t={}){var i=t.callback||t.then||(()=>{});if(this._shopperDisabled)return i&&i();"view"===e.type&&(void 0!==e.state.product_id&&(e.associated_to="product"),e.state=e.state||{},e.state.event_history=this._trackAndReturnHistory(e)),this._opts.testMode?this._opts.logger.warn("[TEST MODE] Not pushing event to the api because test mode is enabled, but the rest of the JS will think we did.",e):("object"==typeof e.state&&(e.state_json=JSON.stringify(e.state),delete e.state),"object"==typeof e.data&&(e.data_json=JSON.stringify(e.data),delete e.data),this._pageLoaded?this._sendEventData(e,i):this._$(document).ready((()=>this._sendEventData(e,i))))}getFeeds(e,t,i){this._opts.testMode?(e.test_mode=this._opts.testMode,this._cachedTestFeedResponse?t(this._cachedTestFeed(e.types)):this._request("GET",this._url("v2/public/feeds.json",e,this.baseLegacyApiUrl),(i=>{this._cachedTestFeedResponse=i,t(this._cachedTestFeed(e.types))}),i)):this._request("GET",this._url("v2/public/feeds.json",e,this.baseLegacyApiUrl),t,i)}_cachedTestFeed(e){for(var t=[],i=0;i<this._cachedTestFeedResponse.length;i++)e&&!e.includes(this._cachedTestFeedResponse[i].type)||t.push(this._$.extend(!0,{},this._cachedTestFeedResponse[i]));return t}get _useSampleData(){return(this._opts.testMode||this._opts.app.isDesignMode())&&!this._opts.app.opts.hasUrlFlagOff("fera_use_samples")}getRatings(e,t){this._request("GET",this._v3_url("ratings.json",e),(e=>{let i;return e.meta&&(i=e.meta.total_count),i=i||0,t&&t(e.data,i)}))}getProductRating(e,t){if(!e)return t&&t([],0);this._request("GET",this._v3_url("products/"+e+"/rating.json"),(e=>t&&t(e)))}getStoreRating(e){this._request("GET",this._v3_url("store_rating.json"),(t=>e&&e(t)),e)}getRating(e,t){if("function"==typeof e)return this.getStoreRating(e);if("string"!=typeof e&&"number"!=typeof e||"function"!=typeof t)throw new TypeError("getRating requires either a product ID and callback, or just a callback");return this.getProductRating(e,t)}getReviewsV3(e,t){this._request("GET",this._v3_url("reviews.json",e),(e=>{let i;return e.meta&&(i=e.meta.total_count),i=i||0,t&&t(e.data,i)}))}getMediaV3(e,t){this._request("GET",this._v3_url("media.json",e),(e=>{let i;return e.meta&&(i=e.meta.total_count),i=i||0,t&&t(e.data,i)}))}getReviews(e,t,i){if(this._useSampleData){e.test_mode=this._useSampleData,e.page=e.page||1,e.limit=e.limit||5,e.samples=this._useSampleData;var r=JSON.stringify(e);const n=this._app.storeSettings.cache_data.last_updated.customer_review||"0";if(this._requestCache.customer_reviews=this._requestCache.customer_reviews||{},this._requestCache.customer_reviews[n]=this._requestCache.customer_reviews[n]||{},this._requestCache.customer_reviews[n]&&this._requestCache.customer_reviews[n][r]){if(void 0===this._requestCache.customer_reviews[n][r].result)return this._requestCache.customer_reviews[n][r].onSuccess.push((e=>t(e.result,e.count)));{const e=this._requestCache.customer_reviews[n][r];return t(e.result,e.count)}}this._requestCache.customer_reviews[n][r]={result:void 0,onSuccess:[e=>t(e.result,e.count)],onError:[e=>i(e.result,e.count)],count:null},this._request("GET",this._url("v2/public/reviews.json",e),((e,t,i)=>{this._requestCache.customer_reviews[n][r].result=e,this._requestCache.customer_reviews[n][r].count=this.cachedTestReviewTotalCount=parseInt(i.getResponseHeader("Total-Count"))||0,this._requestCache.customer_reviews[n][r].onSuccess.forEach((e=>e(this._requestCache.customer_reviews[n][r]))),this._requestCache.customer_reviews[n][r].onSuccess=[]}),(e=>{this._requestCache.customer_reviews[n][r].onError.forEach((t=>t(e))),delete this._requestCache.customer_reviews[n][r]}))}else this._request("GET",this._url("v2/public/reviews.json",e),((e,i,r)=>{var n=parseInt(r.getResponseHeader("Total-Count"))||0;return t&&t(e,n)}),i)}getPhotos(e,t,i){const r=this._app.storeSettings.cache_data.last_updated.customer_photo||"0";if(this._requestCache.customer_photos=this._requestCache.customer_photos||{},this._requestCache.customer_photos[r]=this._requestCache.customer_photos[r]||{},this._requestCache.customer_photos[r][e]){const i=this._requestCache.customer_photos[r][e];return t(i.result,i.totalCount)}this._request("GET",this._url("v2/public/photos.json",e),((i,n,a)=>{var o=parseInt(a.getResponseHeader("Total-Count"))||0;return this._requestCache.customer_photos[r][e]={totalCount:o,result:i},t&&t(i,o)}),i)}getTestimonials(e,t,i){return e.type="store",this.getReviews(e,t,i)}getCustomerMedia(e,t,i){var r=t=>e.only_photos?t.filter((function(e){return"photo"===e.type})):e.only_videos?t.filter((function(e){return"video"===e.type})):t;if(e.media_ids&&e.media_ids.length>0&&(e.media_ids=e.media_ids.filter((e=>!!e))),this._useSampleData){e.test_mode=this._useSampleData,e.page=e.page||1,e.limit=e.limit||0,e.samples=this._useSampleData;var n=(e.page||e.offset)+"x"+e.limit;if(this._cachedTestCustomerMediaResponse&&this._cachedTestCustomerMediaResponse[n]&&!e.media_ids)return t(r(this._cachedTestCustomerMediaResponse[n]),this._cachedTestCustomerMediaTotalCount[n]);this._request("GET",this._url("v2/public/customer_media.json",e),((i,a,o)=>{var s=parseInt(o.getResponseHeader("Total-Count"))||0;if(e.media_ids)return t(i,s);this._cachedTestCustomerMediaResponse=this._cachedTestCustomerMediaResponse||{},this._cachedTestCustomerMediaTotalCount=this._cachedTestCustomerMediaTotalCount||{},this._cachedTestCustomerMediaResponse[n]=i,this._cachedTestCustomerMediaTotalCount[n]=s,t(r(this._cachedTestCustomerMediaResponse[n]),this._cachedTestCustomerMediaTotalCount[n])}),i)}else{let r=this._app.storeSettings.cache_data.last_updated.customer_photo||"0";r+=this._app.storeSettings.cache_data.last_updated.customer_video||"0",this._requestCache.customer_media=this._requestCache.customer_media||{},this._requestCache.customer_media[r]=this._requestCache.customer_media[r]||{};const n=e.cache_key+(e.page||e.offset)+"x"+e.limit;if(delete e.cache_key,this._requestCache.customer_media[r][n]){const e=this._requestCache.customer_media[r][n];return t(e.result,e.totalCount)}this._request("GET",this._url("v2/public/customer_media.json",e),((e,i,a)=>{var o=parseInt(a.getResponseHeader("Total-Count"))||0;return this._requestCache.customer_media[r][n]={totalCount:o,result:e},t&&t(e,o)}),i)}}getContent(e,t,i){if(t=t||(()=>{}),e.visitor_id=this._opts.visitorId,e.api_client=encodeURIComponent(this._apiClientDescriptor),e.state=e.state||{},e.push_view_event){var r=this._$.extend(e,{type:"view"});e.state.event_history=this._trackAndReturnHistory(r)}e.test_mode=this._opts.testMode||this._useSampleData,e.testMode||delete e.testMode,this._opts.optionsParser.hasPreviewFilterById()&&(e.fera_preview=this._opts.optionsParser.getPreviewId());var n=this._url("v2/public/content.json");e.state_json=JSON.stringify(e.state),delete e.state;var a=Fera.Util.sizeOfParams(e)>Fera.Util.maxGetRequestChars()?"POST":"GET";return this._$.ajax({method:a,type:a,data:e,url:n,success:(e,i,r)=>{r.getResponseHeader("api-client-outdated")&&this._opts.app.clearCache(),this.requestFailCount=0,t(e,i,r)},error:e=>{this.requestFailCount+=1,i&&i(e)}})}getSection(e,t){const i={visitor_id:this._opts.visitorId,api_client:encodeURIComponent(this._apiClientDescriptor),test_mode:this._opts.testMode};return this._$.ajax({method:"GET",type:"GET",data:i,url:this._url("v2/public/section.json"),success:(t,i,r)=>{r.getResponseHeader("api-client-outdated")&&this._opts.app.clearCache(),e(t.section,i,r)},error:e=>{t&&t(e)}})}getProducts(e,t,i){this._requestCache.getProducts=this._requestCache.getProducts||{};const r=JSON.stringify(e);this._requestCache.getProducts[r]=this._requestCache.getProducts[r]||{successCallbacks:[],errorCallbacks:[]};const n=this._requestCache.getProducts[r];if(n.response){if(!0===n.response.success)return t(n.response.data);if(!1===n.response.success)return i(n.response.data)}this._requestCache.getProducts[r].successCallbacks.push(t),this._requestCache.getProducts[r].errorCallbacks.push(i),this._requestCache.getProducts[r].called||(this._requestCache.getProducts[r].called=!0,this._request("GET",this._url("v2/public/products.json",e),(e=>{this._requestCache.getProducts[r].response={data:e,success:!0},this._requestCache.getProducts[r].successCallbacks.forEach((t=>t(e)))}),(e=>{this._requestCache.getProducts[r].response={data:e,success:!1},this._requestCache.getProducts[r].errorCallbacks.forEach((t=>t(e)))})))}contentSubmission(e,t=""){this._$.ajax({url:this._url("v2/public/content_submissions"+t,e.params),method:"POST",type:"POST",data:e.data,contentType:!1,processData:!1,success:e.success,error:e.error})}requestContentSubmissionTemplate(e){const t=this._$.extend({visitor_id:this._opts.app.getVisitorId(),language:this._opts.app.locale},e.params);var i=this._url("v2/public/content_submissions/template",t);this._request("GET",i,e.success,e.error)}triggerActions(e={},t={}){this._opts.app.getState((i=>((e=this._$.extend({},i,e)).visitor_id=this._opts.visitorId,this._opts.testMode&&(e.test_mode=this._opts.testMode),this._opts.optionsParser.hasPreviewFilterById()&&(e.fera_preview=this._opts.optionsParser.getPreviewId()),this._$.ajax({method:"POST",type:"POST",data:e,url:this._url("v2/public/shoppers/"+this._opts.visitorId+"/trigger_skill_actions",{},this.baseLegacyApiUrl),success:(e,i,r)=>{this.requestFailCount=0,t.success&&t.success&&t.success(e,i,r)},error:e=>{this.requestFailCount+=1,t.error&&t.error&&t.error(e)}}))))}getShopper(e,t){return this._request("GET",this._url("v2/public/shoppers/"+e,{},this.baseLegacyApiUrl),t,t)}deleteShopper(e,t){return this._request("DELETE",this._url("v2/public/shoppers/"+e,{},this.baseLegacyApiUrl),t,t)}_v3_url(e,t={},i=this.baseApiUrl){return i+="v3/public/",this._url(e,t,i)}_url(e,t={},i=this.baseApiUrl){return t.public_key=this._config.store_pk,this._opts.adminMode&&(t.adminSessionToken&&(t.admin_session_token=this._opts.adminSessionToken),t.admin=this._opts.adminMode),this._opts.debugMode&&(t.debug_mode=!0),this._opts.app.visitorManager.isNew&&(t.first=!0),(this._opts.app.opts.hasUrlFlag("cache")||this._opts.app.opts.hasUrlFlagOff("cache"))&&(t.cache=this._opts.app.opts.hasUrlFlag("cache")),e=e||"",-1===i.indexOf("public/")&&-1===e.indexOf("public/")&&(i+="public/"),i+e+"?"+this._$.param(t)}_trackAndReturnHistory(e){var t=this._opts.localStorage.getObject("EventHistory",{}),i=(new Date).getTime(),r=e.associated_to||(void 0!==e.state.product_id?"product":"any"),n="any"===r?"any":r+"-"+e.state.product_id;return t[e.type]=t[e.type]||{},t[e.type][n]=t[e.type][n]||[],t[e.type][n].push(i/1e3),t[e.type][n].length>2&&t[e.type][n].splice(1,1),this._opts.localStorage.setObject("EventHistory",t),t[e.type][n]}_performImageRequest(e,t,i,r=this.baseApiUrl){const n=document.createElement("img");t.api_client=this._apiClientDescriptor,n.src=this._url(e,t,r),this._$(n).on("load error",(()=>i(this._$(n))))}_sendEventData(e,t){t=t||(()=>{});const i=Fera.Util.httpMethodToUse(e),r=["campaign_engagement","element_click","page_view","product_add_to_cart","product_view"].includes(e.type)?this.baseLegacyApiUrl:this.baseApiUrl;if("GET"!==i){const n={method:i,data:JSON.stringify(e),url:this._url("v2/public/events.json",{},r),dataType:"html",success:t=>{this._opts.logger.log("Successfully sent event",e,t)},error:i=>{if(i.status<300)return t&&t(i);var r="unknown error";try{r=JSON.parse(i.responseText).error_message}catch(e){}this._opts.logger.warn("Event failed to send: "+r,e,i)},complete:t};return this._ajax(n)}this._performImageRequest("v2/public/e.gif",e,t,r)}_ajax(e){return e.type=e.method,"GET"==e.method.toUpperCase()?-1===e.url.indexOf("api_client")&&(e.url+=(-1===e.url.indexOf("?")?"?":"&")+"api_client="+this._apiClientDescriptor):e.headers={"API-CLIENT":this._apiClientDescriptor},this._$.ajax(e)}_request(e,t,i,r){return this._ajax({method:e,url:t,success:i,error:r})}},Fera.State=class{constructor(e){this._opts=e,this._app=e.app}getData(e){var t={current_page:{url:window.location.toString(),referrer:document.referrer,title:document.title},location:this._opts.shopperLocation||{}};return(this._app.opts.debugMode||this._app.opts.adminMode)&&(t.device={width:window.screen&&window.screen.width,height:window.screen&&window.screen.height,agent:navigator&&navigator.userAgent,language:navigator&&navigator.language,is_bot:Fera.Util.isBot(),is_speed_mode:Fera.Util.isSpeedMode()}),this._app.opts.adminMode&&(t.is_admin=!0),Fera.Util.isBot()||(t.customer_id=this._app.getCustomerId()||"",t.interaction_time=this._opts.timeTracker.getTotalInteractionTime(),t.time_since_first_seen=this._opts.timeTracker.getTimeSinceFirstSeen(),t.session_time=this._opts.timeTracker.getSessionTime(),t.time_on_current_page=this._opts.timeTracker.getTimeOnCurrentPage(),t.inactive_time_on_current_page=this._opts.timeTracker.getInactiveTimeOnPage()),this._app.getSection()&&(t.section=this._app.getSection()),this._app.getProductId()&&(t.product_id=this._app.getProductId()),this._app.getProduct()&&(t.product=this._app.getProduct()),this._app.getVariantId()&&(t.variant_id=this._app.getVariantId()),Fera.Util.isBot()||(this._app.cart&&this._app.cart.hasData()&&(this._app.cart.validateData()?t.cart=this._app.cart.getData():Fera.logger.warn("Invalid cart data",this._app.cart)),this._app.abTests.present()&&(t.test_buckets=this._app.abTests.getBuckets())),e(t),t}},Fera.VisitorManager=function(e){var t,i=this,r=(e=e||{}).cookieJar,n=1825,a=function(){};i.ensureVisitorId=function(){return t=i.getId(),o(),t?(i.isNew=!1,s()):(i.isNew=!0,c()),t},i.setId=function(e){-1!==(t=e).indexOf(" path=/")&&(t=t.replace(" path=/","")),r.setCookie("banana_stand_visitor_id",t,n)},i.getId=function(){return r.getCookie("banana_stand_visitor_id")};var o=function(){var i=e.optionsParser.feraParams.shopper;i&&(i=i.toLowerCase(),t?t!==i&&(Fera.logger.log("Shopper (visitor) ID was changed from URL. Merge operation impending.",t,i),e.api.mergeShoppers(t,i)):Fera.logger.log("Shopper (visitor) ID was set from URL.",t),t=i)},s=function(){i.setId(t)},c=function(){var e=Fera.Util.generateUUID();i.setId(e)};a()},Fera.Base=class{constructor(){this.$=Fera.Util.$()}_log(){return Fera.logger.log.apply(this,arguments)}_warn(){return Fera.logger.warn.apply(this,arguments)}_error(){return Fera.logger.error.apply(this,arguments)}_logWarning(){return Fera.logger.logWarning.apply(this,arguments)}};var FeraCachedAsset=function(e){var t=this;this.version="0.2.6";var i=e.name||e.url.split("?")[0].split("#")[0],r="Fera.AssetCache."+i,n=(new Date).getTime()/1e3,a=e.type||(-1!==e.url.indexOf(".html")?"text/template":-1!==e.url.indexOf(".css")?"text/css":"text/javascript");t.load=function(i){return i=i||function(){},t.content?i(t.content):(o((function(){t.content?i(t.content):u(e.url,(function(e){t.content=e,s((function(){c(t.content),t.save(t.content),i(t.content)}))}))})),!0)},t.save=function(t){var a=n+(e.expiresIn||900);if(!l()||!t)return!1;var o={name:i,url:e.url,expires:a,content:t};return window.localStorage.setItem(r,JSON.stringify(o)),!0},t.clear=function(){return window.localStorage.removeItem(r),!1};var o=function(i){if(!l())return i(!1);var a=window.localStorage.getItem(r);if(!a||"string"!=typeof a)return i(!1);var o=JSON.parse(a);if(o.expires<n||o.url!==e.url)return t.clear(),i(!1);t.content=o.content,s((function(){c(t.content),i(!0)}))},s=function(e){"loading"==document.readyState?document.addEventListener("DOMContentLoaded",e):e()},c=function(e){if(!document.getElementById(r)){var t=document.createElement("text/css"===a?"style":"script");t.type=a,t.id=r,t.async=!0,t.innerHTML=e,document.body.appendChild(t)}},u=function(e,t){var i=new XMLHttpRequest;i.async=!0,i.onreadystatechange=function(){4==i.readyState&&i.status<300&&t(i.responseText)},i.open("GET",e,!0),i.send()},l=function(){var e="test";try{return window.localStorage.setItem(e,"t"),window.localStorage.removeItem(e),1}catch(e){return 0}}},BananaStandCachedAsset=FeraCachedAsset;Fera.Cart=function(e){var t,i,r=this,n=!1,a=!1,o=e.app.localStorage,s=[],c="Cart",u=6048e4,l=function(){h(),setTimeout((function(){a||r.update(!0)}),5e3)};r.setAdapter=function(e){i=e},r.addProductIfEmpty=function(e,t,i){r.ifEmpty((function(){"function"==typeof i.beforeAdd&&i.beforeAdd(),r.addProduct(e,t,i)}),i.afterAdd)},r.removeProduct=function(e,t,n){return t=t||{},n=n||{},!!r.containsProduct(e,t)&&i.removeProduct(e,t,n)},r.ifEmpty=function(e,i){r.update((function(){t&&0!==t.item_count?i&&i():e&&e()}),!0)},r.containsProducts=function(e){for(var t=0;t<e.length;t++)if(r.containsProduct(e[t]))return!0;return!1},r.containsProduct=function(e){if(!t||!t.items||t.items.length<1)return!1;for(var i=0;i<t.items.length;i++)if(t.items[i].product_id+""==e+"")return!0;return!1},r.getProductQuantity=function(e){if(!t||!t.items||t.items.length<1)return 0;for(var i=0,r=0;r<t.items.length;r++)t.items[r].product_id+""==e+""&&(i+=t.items[r].quantity||0);return i},r.update=function(e,t){if("boolean"==typeof e&&void 0===t&&(t=e,e=null),e=e||function(){},void 0===t&&(t=!1),t&&n||!i)return e();i.downloadData((function(t){r.loadData(t),n=!0,setTimeout((function(){n=!1}),5e3),e()}))},r.startCheckout=function(){if(!i)throw"No cart adapter specified so checkout cannot be triggered.";return i.startCheckout()},r.hasData=function(){return t},r.getData=function(){return t},r.loadItemData=function(e){var t=i?i.parseItemData(e):e;return r.addItem(t),r},r.loadData=function(n){return t=i?i.parseCartData(n):n,a=!0,d(t)&&(s.push({event:"change",at:(new Date).getTime()}),e.app.trigger("cart.changed")),p(),r},r.loadCartData=r.loadData,r.addProduct=function(e,t,r){if(!i)throw"No cart adapter specified so can't add product to the cart.";if(t=t||{},"function"==typeof(r=r||{})){var n=r;(r={}).afterAdd=n}return i.addProduct(e,t,r)},r.validateData=function(){if(!t)return e.logger.error("Cart data is empty."),!1;t.items||(e.logger.log("cart.items should be an array of items."),t.items=[]),t.total_weight||(t.total_weight=0),t.total_discount||(t.total_discount=0),t.currency||(e.logger.log("Missing cart.currency, assumed USD"),t.currency="USD");for(var i=0,r=0,n=0;n<t.items.length;n++){var a=t.items[n];if((!a.quantity||parseInt(a.quantity)<=0)&&(t.items[n].quantity=1),a.total||(a.price?t.items[n].total=t.items[n].quantity*a.price:t.items[n].total=0),!a.product_id){if(!a.id){e.logger.warn("Missing product_id, cannot track entry in cart",a),t.items.splice(n,1),n--;continue}a.product_id=a.id}a.variant_id||(t.items[n].variant_id=null),i+=t.items[n].quantity,r+=t.items[n].total}return t.item_count||(t.item_count=i),t.total||(t.total=r),t.grand_total||(t.grand_total=t.total),!0},r.addItem=function(e){t.item_count=t.item_count+e.quantity,t.total=t.total+e.total,t.total_weight=t.total_weight+e.weight,t.total_discount=t.total_discount+e.total_discount,delete e.weight,delete e.total_discount,t.items.push(e),s.push({event:"add",at:(new Date).getTime()}),p()},r.isEmpty=function(){return!t||0===Object.keys(t).length&&t.constructor===Object||0===t.item_count},r.getItemsString=function(){for(var e=[],i=0;i<t.items.length;i++)e.push(t.items[i].product_id+"x"+t.items[i].quantity);return e.join(",")},r.getHistory=function(){return s||[]},r.reset=function(){t=null,o&&o.removeItem(c),a=!0,s.push({event:"empty",at:(new Date).getTime()}),p(),e.app.trigger("cart.emptied")},r.clear=function(){i.clear((function(){r.reset()}))};var d=function(e){var t=f();if(!t)return!1;if(!e&&t)return!0;if(void 0!==e.item_count&&e.item_count!=t.item_count)return!0;if(void 0!==e.total&&e.total!=t.total)return!0;for(var i=0;i<t.items.length;i++)if(void 0===e.items[i]){if(void 0!==e.items[i].total&&e.items[i].total!=t.items[i].total)return!0;if(void 0!==e.items[i].product_id&&e.items[i].product_id!=t.items[i].product_id)return!0;if(void 0!==e.items[i].variant_id&&e.items[i].variant_id!=t.items[i].variant_id)return!0}return!1},p=function(){o&&o.setObject(c,{data:t,history:s},u)},h=function(){if(o){var e=o.getObject(c,{});t=e.data||e,s=e.history||[]}},f=function(){if(o)return o.getObject(c,{}).data};l()},Fera.CookieJar=function(e){var t=this;e="string"==typeof e?{namespace:e}:e||{};var i=function(){t.namespace=e.prefix||e.namespace||""};t.setCookie=function(e,i,r){var n="";if(r){var a=new Date;a.setTime(a.getTime()+24*r*60*60*1e3),n="; expires="+a.toUTCString()}var o=t.namespace+e+"="+i+n+"; path=/; SameSite=None";0===window.location.toString().indexOf("https")&&(o+="; Secure"),document.cookie=o},t.getCookie=function(e,i){i=i||null;for(var r=e+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){for(var o=n[a];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(r))return o.substring(r.length,o.length)}return 0===e.indexOf("Fera.")?t.getCookie(e.replace("Fera.","BananaStand."),i):0===e.indexOf("fera_")?t.getCookie(e.replace("fera_","bs_"),i):0===e.indexOf("fera-")?t.getCookie(e.replace("fera-","banana_stand-"),i):i},t.getCookieObject=function(e,i){var r=t.getCookie(e,i);return"string"==typeof r&&(r=JSON.parse(decodeURIComponent(atob(r)))),r},t.setCookieObject=function(e,i,r){return i=btoa(encodeURIComponent(JSON.stringify(i))),t.setCookie(e,i,r)},i()},Fera.DeepLinker=class{constructor(e){this._opts=e,this.$=Fera.Util.$(),this.app=this._opts.app}attachAndWatch(){setInterval((()=>this.locateAndAttachLinks()),1e3),Fera.Util.isSpeedMode()||this.locateAndAttachLinks()}locateAndAttachLinks(){this.$("[data-fera-action]").each(((e,t)=>this._attachDeepLink(this.$(t))))}_attachDeepLink(e){if(!e.data("fera-deep-link-attached")){var t=e.data("fera-action");if(-1!==["writeReview","submitPhotos","submitVideos","submitContent","submitMedia","showContentSubmission"].indexOf(t)&&(t="showContentSubmitter"),!t)throw"No action specified for fera deep link. Please refer to developers.fera.ai for help.";if(!this.app[t])throw"Invalid action specified. Please refer to developers.fera.ai for help.";this._attachClickListener(e,t)}}_attachClickListener(e,t){e.on("click",(i=>{i.preventDefault(),i.stopPropagation();var r=e.data()||{};this.app[t](r)})),e.data("fera-deep-link-attached",!0)}},Fera.EngagementRegistry=function(e){e=e||{};var t,i=this,r=[],n=[],a=[],o=function(){u()};i.isEnabled=function(){return e.app.storeSettings&&e.app.storeSettings.when_to_send_events&&e.app.storeSettings.when_to_send_events.campaign_engagement>=0};var s=function(){return!e.sandboxMode&&(!e.designMode&&(!!i.isEnabled()&&(!Fera.Util.isBot()&&!Fera.Util.isSpeedMode())))};i.register=function(t){if(!t)throw"Campaign ID can't be blank";s()&&(c(t)?-1===r.indexOf(t)&&-1===n.indexOf(t)&&n.push(t):r.push(t),a.push(t),e.inactivityDetector.afterFirstInteraction(d,1e3*e.app.storeSettings.when_to_send_events.campaign_engagement+1500))},i.pushEvent=function(){if(!(r.length<1&&n.length<1)){var t={type:"campaign_engagement",data:{engagements:{first_time:r,recurring:n}}};e.app.pushEvent(t),i.flush()}},i.state=function(){return{firstTime:r,recurring:n,historicalEngagements:a}},i.reset=function(){r=[],n=[],a=[],l()},i.flush=function(){r=[],n=[],l()};var c=function(e){return-1!==a.indexOf(e)},u=function(){a=e.localStorage.getObject("Fera.EngagementRegistry.historicalEngagements")||[]},l=function(){e.localStorage.setObject("Fera.EngagementRegistry.historicalEngagements",a)},d=Fera.Util.debounce((function(){try{i.pushEvent()}catch(i){throw t&&clearTimeout(t),e.logger.warn("Aborted watching for engagements since we got an error: ",i.message),i}}),3e3);o()},Fera.ExitIntentDetector=function(e){e=e||{};var t,i=Fera.Util.$(),r=e.sensitivity||300,n=function(){i(window).on("mouseleave",a),i(window).on("mouseenter",o)},a=function(i){i.clientY>0||(t&&clearTimeout(t),r<=0?e.onExitIntent&&(Fera.logger.log("Exit intent detected."),e.onExitIntent()):t=setTimeout((function(){t=null,e.onExitIntent&&(Fera.logger.log("Exit intent detected."),e.onExitIntent())}),r))},o=function(){t&&(clearTimeout(t),t=null)};n()},Fera.Geo=function(e){var t=this,i="https://geo.bananastand.io/json/",r=Fera.Util.$(),n=e.localStorage||new Fera.LocalStorageJar(e),a=function(){t.ipResult=null,o()||s()},o=function(){return!(!Fera.Util.isSpeedMode()&&!Fera.Util.isBot())&&(t.ipResult={ip:"99.250.99.99",continent:"NA",country_code:"CA",country_name:"Canada",region_code:"ON",region_name:"Ontario",city:"Waterloo",zip_code:"N2A",time_zone:"America/Toronto",latitude:43.4551002,longitude:-80.5413999},!0)};this.hasStoredInfo=function(){return null!==t.ipResult},this.getLocationInfo=function(e){t.ipResult?e(t.ipResult):t.geolocateIp(e)},this.geolocateIp=function(e,n){e=e||function(){},r.ajax({method:"GET",type:"GET",url:i,success:function(i){c(i),e(t.ipResult)},dataType:-1!==window.location.toString().match("/checkouts|/cart")?"json":"jsonp",error:function(){n&&e({})}})};var s=function(){if(void 0!==n)try{t.ipResult=n.getObject(u())}catch(e){}},c=function(e){t.ipResult=e,void 0!==n&&n.setObject&&n.setObject(u(),t.ipResult,72e5)},u=function(){return"Geo.geolocateIp.result"};a()},Fera.I18n=class{constructor(e){this.locale=e.app.locale||document.documentElement.lang||"en"}get translations(){const e=this.localeWithFallback.split("-")[0];return this.constructor.TRANSLATIONS[e]}get localeWithFallback(){return this.isSupportedLanguage(this.locale)?this.locale:this.defaultLocale&&this.isSupportedLanguage(this.defaultLocale)?this.defaultLocale:"en"}get usingDefaultLocale(){return this.defaultLocale?this.localeWithFallback===this.defaultLocale:this.isSupportedLanguage(this.locale)}setTranslatedStrings(e){Object.keys(e).forEach((t=>{const i=t.split("-")[0];e[i]||(e[i]=e[t])})),this.translatedStrings=e}setDefaultLocale(e){this.locale!==e&&(this.defaultLocale=e)}isSupportedLanguage(e){const t=e.split("-")[0];return this.supportedLanguages().includes(t)}supportedLanguages(){return["en",...Object.keys(this.constructor.TRANSLATIONS)]}t(e){if("object"==typeof e)return this.translateElementText(e);let t=e;if(this.translations&&(t=this.translations[e]||e),this.translatedStrings){const e=this.translatedStrings[this.localeWithFallback];if(e&&e[t])return e[t]}return t}translateElementText(e){e.zepto||(e=F$(e)),e.each(((e,t)=>{const i=F$(t);if(i.data("fera-translated"))return!0;const r=i.html().trim(),n=this.t(r).trim();r!==n&&i.html(n),i.data("fera-translated",!0)}))}customTranslate(e,t){const i=this.t(e),r=t[this.localeWithFallback];return r&&r[i]?r[i]:i}static _getShopifyLocale(){let e=document.getElementById("shopify-features");if(e)return e=JSON.parse(e.innerHTML),e.locale}static get TRANSLATIONS(){return{fr:{"Real shoppers":"De vrais acheteurs",Anonymous:"Anonyme","verified by Fera.ai":"v\xe9rifi\xe9 par Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} critique{% if review_count != 1 %}s{% endif %}","Product Reviews":"Avis sur les produits","Customer Reviews":"Avis des clients",Reviews:"Commentaires","Product:":"Produit:","Write a review":"\xc9crire une critique","How was your experience?":"Comment \xe9tait ton exp\xe9rience?",
"Reviews From Similar Products":"Commentaires de produits similaires","Review The Store":"Donnez votre avis sur le magasin","Show More":"Montre Plus","No reviews for this product yet.":"Il n'y a pas encore de commentaire pour ce produit.","{{ store_name }} replied:":"{{ store_name }} a r\xe9pondu:","We're adding a 2nd item to your cart now!":"Nous ajoutons un deuxi\xe8me article \xe0 votre panier maintenant!","{{ user.name }} from {{ store.name }}":"{{ user.name }} de {{ store.name }}","{{ num }} second ago":"Il y a {{ num }} seconde","{{ num }} minute ago":"il y a {{ num }} minute","{{ num }} hour ago":"Il ya {{ num }} heure","{{ num }} day ago":"il y a {{ num }} jour","{{ num }} week ago":"Il ya {{ num }} semaine","{{ num }} month ago":"Il ya {{ num }} mois","{{ num }} year ago":"il y a {{ num }} an","{{ num }} seconds ago":"Il y a {{ num }} secondes","{{ num }} minutes ago":"Il y a {{ num }} minutes","{{ num }} hours ago":"il y a {{ num }} heures","{{ num }} days ago":"il y a {{ num }} jours","{{ num }} weeks ago":"Il y a {{ num }} semaines","{{ num }} months ago":"il y a {{ num }} mois","{{ num }} years ago":"il y a {{ num }} ans","Loading...":"chargement en cours...",Submit:"Soumettre",Skip:"Ignorer",Testimonials:"T\xe9moignages"},pt:{"Real shoppers":"Compradores reais",Anonymous:"An\xf4nimo","verified by Fera.ai":"verificado por Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} an\xe1lise{% if review_count != 1 %}s{% endif %}","Product Reviews":"Revis\xe3o de Produtos","Customer Reviews":"Opini\xe3o dos consumidores",Reviews:"Avalia\xe7\xf5es","Product:":"Produtos:","Write a review":"Escreva uma cr\xedtica","How was your experience?":"Como foi sua experiencia","Reviews From Similar Products":"Avalia\xe7\xf5es de produtos semelhantes","Review The Store":"Avalie a loja","Show More":"Mostre Mais","No reviews for this product yet.":"Ainda n\xe3o h\xe1 coment\xe1rios para este produto.","{{ store_name }} replied:":"{{ store_name }} respondeu","We're adding a 2nd item to your cart now!":"Estamos adicionando um segundo item ao seu carrinho agora!","{{ user.name }} from {{ store.name }}":"{{ user.name }} de {{ store.name }}","{{ num }} second ago":"{{ num }} segundo atr\xe1s","{{ num }} minute ago":"{{ num }} minuto atr\xe1s","{{ num }} hour ago":"{{ num }} hora atr\xe1s","{{ num }} day ago":"{{ num }} dia atr\xe1s","{{ num }} week ago":"{{ num }} semana atr\xe1s","{{ num }} month ago":"{{ num }} m\xeas atr\xe1s","{{ num }} year ago":"{{ num }} ano atr\xe1s","{{ num }} seconds ago":"{{ num }} segundos atr\xe1s","{{ num }} minutes ago":"{{ num }} minutos atr\xe1s","{{ num }} hours ago":"{{ num }} horas atr\xe1s","{{ num }} days ago":"{{ num }} dias atr\xe1s","{{ num }} weeks ago":"{{ num }} semanas atr\xe1s","{{ num }} months ago":"{{ num }} meses atr\xe1s","{{ num }} years ago":"{{ num }} anos atr\xe1s","Loading...":"carregando...",Submit:"Enviar",Skip:"Ignorar",Testimonials:"Testemunhos"},nl:{"Real shoppers":"Echte kopers",Anonymous:"Anoniem","verified by Fera.ai":"geverifieerd door Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} productbeoordeling{% if review_count != 1 %}en{% endif %}","Product Reviews":"Productrecensies","Customer Reviews":"Klantrecensies",Reviews:"Beoordelingen","Product:":"Product:","Write a review":"Schrijf een recensie","How was your experience?":"Hoe was je ervaring?","Reviews From Similar Products":"Recensies van vergelijkbare producten","Review The Store":"Beoordeel De winkel","Show More":"Laat Meer Zien","No reviews for this product yet.":"Er zijn nog geen beoordelingen voor dit product.","{{ store_name }} replied:":"{{ store_name }} respondeu:","We're adding a 2nd item to your cart now!":"We voegen nu een tweede artikel toe aan uw winkelwagen!","{{ user.name }} from {{ store.name }}":"{{ user.name }} van {{ store.name }}","{{ num }} second ago":"{{ num }} seconde geleden","{{ num }} minute ago":"{{ num }} minuut geleden","{{ num }} hour ago":"{{ num }} uur geleden","{{ num }} day ago":"{{ num }} dag geleden","{{ num }} week ago":"{{ num }} week geleden","{{ num }} month ago":"{{ num }} maand geleden","{{ num }} year ago":"{{ num }} jaar geleden","{{ num }} seconds ago":"{{ num }} seconden geleden","{{ num }} minutes ago":"{{ num }} minuten geleden","{{ num }} hours ago":"{{ num }} uur geleden","{{ num }} days ago":"{{ num }} dagen geleden","{{ num }} weeks ago":"{{ num }} weken geleden","{{ num }} months ago":"{{ num }} maanden geleden","{{ num }} years ago":"{{ num }} jaar geleden","Loading...":"bezig met laden...",Submit:"Verzenden",Skip:"Negeren",Testimonials:"Getuigenissen"},de:{"Real shoppers":"Echter K\xe4ufer",Anonymous:"Anonym","verified by Fera.ai":"verifiziert von Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} Produktbewertung{% if review_count != 1 %}en{% endif %}","Product Reviews":"Produktrezensionen","Customer Reviews":"Kundenrezensionen",Reviews:"Bewertungen","Product:":"Produkt:","Write a review":"Eine Rezension schreiben","Review The Store":"\xdcberpr\xfcfen Sie den Laden","How was your experience?":"Wie war deine Erfahrung?","Reviews From Similar Products":"Bewertungen von \xe4hnlichen Produkten","Show More":"Zeig Mehr","No reviews for this product yet.":"Es gibt noch keine Bewertungen f\xfcr dieses Produkt.","{{ store_name }} replied:":"{{ store_name }} antwortete:","We're adding a 2nd item to your cart now!":"Wir legen jetzt einen zweiten Artikel in Ihren Warenkorb!","{{ user.name }} from {{ store.name }}":"{{ user.name }} von {{ store.name }}","{{ num }} second ago":"vor {{ num }} Sekunde","{{ num }} minute ago":"vor {{ num }} Minute","{{ num }} hour ago":"vor {{ num }} Stunde","{{ num }} day ago":"vor {{ num }} Tag","{{ num }} week ago":"vor {{ num }} Woche","{{ num }} month ago":"vor {{ num }} Monat","{{ num }} year ago":"vor {{ num }} Jahr","{{ num }} seconds ago":"vor {{ num }} Sekunden","{{ num }} minutes ago":"vor {{ num }} Minuten","{{ num }} hours ago":"vor {{ num }} Stunden","{{ num }} days ago":"vor {{ num }} Tagen","{{ num }} weeks ago":"vor {{ num }} Wochen","{{ num }} months ago":"vor {{ num }} Monaten","{{ num }} years ago":"vor {{ num }} Jahren","Loading...":"wird geladen...",Submit:"Einreichen",Skip:"Auslassen",Testimonials:"Referenzen"},id:{"Real shoppers":"Pembeli sungguhan",Anonymous:"Anonim","verified by Fera.ai":"diverifikasi oleh Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} ulasan","Product Reviews":"Ulasan produk","Customer Reviews":"Ulasan Pelanggan",Reviews:"Ulasan","Product:":"Produk:","Write a review":"Menulis review","How was your experience?":"Bagaimana pengalaman Anda?","Reviews From Similar Products":"Review Dari Produk Sejenis","Review The Store":"Tinjau Toko","Show More":"Menampilkan Lebih Banyak","No reviews for this product yet.":"Belum ada review untuk produk ini.","{{ store_name }} replied:":"{{ store_name }} menjawab:","We're adding a 2nd item to your cart now!":"Kami menambahkan item kedua ke keranjang Anda sekarang!","{{ user.name }} from {{ store.name }}":"{{ user.name }} dari {{ store.name }}","{{ num }} second ago":"{{ num }} detik yang lalu","{{ num }} minute ago":"{{ num }} menit yang lalu","{{ num }} hour ago":"{{ num }} jam yang lalu","{{ num }} day ago":"{{ num }} hari yang lalu","{{ num }} week ago":"{{ num }} minggu yang lalu","{{ num }} month ago":"{{ num }} bulan yang lalu","{{ num }} year ago":"{{ num }} tahun yang lalu","{{ num }} seconds ago":"{{ num }} detik yang lalu","{{ num }} minutes ago":"{{ num }} menit yang lalu","{{ num }} hours ago":"{{ num }} jam lalu","{{ num }} days ago":"{{ num }} hari yang lalu","{{ num }} weeks ago":"{{ num }} minggu yang lalu","{{ num }} months ago":"{{ num }} bulan yang lalu","{{ num }} years ago":"{{ num }} tahun yang lalu","Loading...":"memuat...",Submit:"Kirimkan",Skip:"Melewati",Testimonials:"Testimonial"},it:{"Real shoppers":"Veri clienti",Anonymous:"Anonimo","verified by Fera.ai":"verificato da Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} recension{% if review_count == 1 %}e{% else %}i{% endif %}","Product Reviews":"Recensioni dei prodotti","Customer Reviews":"Recensioni dei clienti",Reviews:"Recensioni","Product:":"Prodotto:","Write a review":"Scrivi una recensione","How was your experience?":"Come \xe8 stata la tua esperienza?","Reviews From Similar Products":"Recensioni di prodotti simili","Review The Store":"Rivedi il negozio","Show More":"Mostra Di Pi\xf9","No reviews for this product yet.":"Nessuna recensione per questo prodotto ancora.","{{ store_name }} replied:":"{{ store_name }} ha risposto:","We're adding a 2nd item to your cart now!":"Stiamo aggiungendo un secondo articolo al tuo carrello ora!","{{ user.name }} from {{ store.name }}":"{{ user.name }} da {{ store.name }}","{{ num }} second ago":"{{ num }} secondo fa","{{ num }} minute ago":"{{ num }} minuto fa","{{ num }} hour ago":"{{ num }} ora fa","{{ num }} day ago":"{{ num }} giorno fa","{{ num }} week ago":"{{ num }} settimana fa","{{ num }} month ago":"{{ num }} mese fa","{{ num }} year ago":"{{ num }} anno fa","{{ num }} seconds ago":"{{ num }} secondi fa","{{ num }} minutes ago":"{{ num }} minuti fa","{{ num }} hours ago":"{{ num }} ore fa","{{ num }} days ago":"{{ num }} giorni fa","{{ num }} weeks ago":"{{ num }} settimane fa","{{ num }} months ago":"{{ num }} mesi fa","{{ num }} years ago":"{{ num }} anni fa","Loading...":"caricamento in corso...",Submit:"Invia",Skip:"Omettere",Testimonials:"Testimonianze"},no:{"Real shoppers":"Ekte shoppere",Anonymous:"Anonym","verified by Fera.ai":"bekreftet av Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} produktanmeldelse{% if review_count != 1 %}r{% endif %}","Product Reviews":"Produktomtaler","Customer Reviews":"Kunde anmeldelser",Reviews:"Anmeldelser","Product:":"Produkt:","Write a review":"Skrive en omtale","How was your experience?":"Hvordan var opplevelsen din?","Reviews From Similar Products":"Anmeldelser Fra Lignende Produkter","Review The Store":"Anmeld butikken","Show More":"Vis Mer","No reviews for this product yet.":"Ingen anmeldelser for dette produktet enn\xe5.","{{ store_name }} replied:":"{{ store_name }} svarte:","We're adding a 2nd item to your cart now!":"Vi legger til en ny vare i handlekurven din n\xe5!","{{ user.name }} from {{ store.name }}":"{{ user.name }} fra {{ store.name }}","{{ num }} second ago":"For {{ num }} sekund siden","{{ num }} minute ago":"For {{ num }} minutt siden","{{ num }} hour ago":"{{ num }} time siden","{{ num }} day ago":"For {{ num }} dag siden","{{ num }} week ago":"{{ num }} uke siden","{{ num }} month ago":"{{ num }} m\xe5ned siden","{{ num }} year ago":"{{ num }} \xe5r siden","{{ num }} seconds ago":"{{ num }} sekunder siden","{{ num }} minutes ago":"{{ num }} minutter siden","{{ num }} hours ago":"{{ num }} timer siden","{{ num }} days ago":"{{ num }} dager siden","{{ num }} weeks ago":"{{ num }} uker siden","{{ num }} months ago":"{{ num }} m\xe5neder siden","{{ num }} years ago":"{{ num }} \xe5r siden","Loading...":"laster inn ...",Submit:"Sende inn",Skip:"Overse",Testimonials:"Attester"},ro:{"Real shoppers":"Cump\u0103r\u0103tori adev\u0103ra\u021bi",Anonymous:"Anonim","verified by Fera.ai":"verificat de Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} recenzi{% if review_count == 1 %}e{% else %}i{% endif %}","Product Reviews":"Recenzii despre produs","Customer Reviews":"Recenziile clien\u021bilor",Reviews:"Recenzii","Product:":"Produs:","Write a review":"Scrie o recenzie","How was your experience?":"Cum a fost experien\u021ba ta?","Reviews From Similar Products":"Recenzii de la produse similare","Review The Store":"Revizuie\u0219te Magazinul","Show More":"Afi\u0219a\u021bi Mai Multe","No reviews for this product yet.":"Nu exist\u0103 \xeenc\u0103 recenzii pentru acest produs.","{{ store_name }} replied:":"{{ store_name }} a r\u0103spuns:","We're adding a 2nd item to your cart now!":"Acum ad\u0103ug\u0103m un al doilea articol \xeen co\u0219!","{{ user.name }} from {{ store.name }}":"{{ user.name }} de la {{ store.name }}","{{ num }} second ago":"Acum {{ num }} secund\u0103","{{ num }} minute ago":"Acum {{ num }} minut","{{ num }} hour ago":"{{ num }} or\u0103 \xeen urm\u0103","{{ num }} day ago":"Acum o zi","{{ num }} week ago":"{{ num }} s\u0103pt\u0103m\xe2n\u0103 \xeen urm\u0103","{{ num }} month ago":"Acum o lun\u0103","{{ num }} year ago":"{{ num }} an in urma","{{ num }} seconds ago":"Acum {{ num }} secunde","{{ num }} minutes ago":"acum {{ num }} minute","{{ num }} hours ago":"{{ num }} ore \xeen urm\u0103","{{ num }} days ago":"{{ num }} zile \xeen urm\u0103","{{ num }} weeks ago":"acum {{ num }} saptamani","{{ num }} months ago":"acum {{ num }} luni","{{ num }} years ago":"Acum {{ num }} ani","Loading...":"se \xeencarc\u0103...",Submit:"Trimite",Skip:"Ignora",Testimonials:"M\u0103rturii"},ru:{"Real shoppers":"\u041d\u0430\u0441\u0442\u043e\u044f\u0449\u0438\u0435 \u043f\u043e\u043a\u0443\u043f\u0430\u0442\u0435\u043b\u0438",Anonymous:"\u0410\u043d\u043e\u043d\u0438\u043c\u043d\u044b\u0439","verified by Fera.ai":"\u043f\u0440\u043e\u0432\u0435\u0440\u0435\u043d\u043e Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{% assign mod_t = review_count | modulo: 10 %}{{ review_count }} \u043e\u0442\u0437\u044b\u0432{% if mod_t > 1 and mod_t < 5 and review_count < 12 or review_count > 14 %}\u0430{% elsif mod_t != 1 or review_count == 11 %}\u043e\u0432{% endif %}","Product Reviews":"\u041e\u0431\u0437\u043e\u0440\u044b \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432","Customer Reviews":"\u041e\u0442\u0437\u044b\u0432\u044b \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432",Reviews:"\u041e\u0442\u0437\u044b\u0432\u044b","Product:":"\u041f\u0440\u043e\u0434\u0443\u043a\u0442:","Write a review":"\u041d\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0440\u0435\u0446\u0435\u043d\u0437\u0438\u044e","How was your experience?":"\u041a\u0430\u043a\u0438\u043c \u0431\u044b\u043b \u0442\u0432\u043e\u0439 \u043e\u043f\u044b\u0442?","Reviews From Similar Products":"\u041e\u0442\u0437\u044b\u0432\u044b \u043e \u043f\u043e\u0445\u043e\u0436\u0438\u0445 \u0442\u043e\u0432\u0430\u0440\u0430\u0445","Review The Store":"\u041e\u0431\u0437\u043e\u0440 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430","Show More":"\u043f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435","No reviews for this product yet.":"\u041d\u0435\u0442 \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043e\u0431 \u044d\u0442\u043e\u043c \u0442\u043e\u0432\u0430\u0440\u0435 \u0435\u0449\u0435.","{{ store_name }} replied:":"{{ store_name }} \u043e\u0442\u0432\u0435\u0442\u0438\u043b:","We're adding a 2nd item to your cart now!":"\u041c\u044b \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u0432 \u0432\u0430\u0448\u0443 \u043a\u043e\u0440\u0437\u0438\u043d\u0443 \u0432\u0442\u043e\u0440\u043e\u0439 \u0442\u043e\u0432\u0430\u0440!","{{ user.name }} from {{ store.name }}":"{{ user.name }} \u0438\u0437 {{ store.name }}","{{ num }} second ago":"{{ num }} \u0441\u0435\u043a\u0443\u043d\u0434\u0443 \u043d\u0430\u0437\u0430\u0434","{{ num }} minute ago":"{{ num }} \u043c\u0438\u043d\u0443\u0442\u0443 \u043d\u0430\u0437\u0430\u0434","{{ num }} hour ago":"{{ num }} \u0447\u0430\u0441 \u043d\u0430\u0437\u0430\u0434","{{ num }} day ago":"{{ num }} \u0434\u0435\u043d\u044c \u043d\u0430\u0437\u0430\u0434","{{ num }} week ago":"{{ num }} \u043d\u0435\u0434\u0435\u043b\u044e \u043d\u0430\u0437\u0430\u0434","{{ num }} month ago":"{{ num }} \u043c\u0435\u0441\u044f\u0446 \u043d\u0430\u0437\u0430\u0434","{{ num }} year ago":"{{ num }} \u0433\u043e\u0434 \u043d\u0430\u0437\u0430\u0434","{{ num }} seconds ago":"{{ num }} \u0441\u0435\u043a\u0443\u043d\u0434\u044b \u043d\u0430\u0437\u0430\u0434","{{ num }} minutes ago":"{{ num }} \u043c\u0438\u043d\u0443\u0442\u044b \u043d\u0430\u0437\u0430\u0434","{{ num }} hours ago":"{{ num }} \u0447\u0430\u0441\u0430 \u043d\u0430\u0437\u0430\u0434","{{ num }} days ago":"{{ num }} \u0434\u043d\u044f \u0441\u043f\u0443\u0441\u0442\u044f","{{ num }} weeks ago":"{{ num }} \u043d\u0435\u0434\u0435\u043b\u0438 \u043d\u0430\u0437\u0430\u0434","{{ num }} months ago":"{{ num }} \u043c\u0435\u0441\u044f\u0446\u0430 \u043d\u0430\u0437\u0430\u0434","{{ num }} years ago":"{{ num }} \u0433\u043e\u0434\u0430 \u043d\u0430\u0437\u0430\u0434","Loading...":"\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 ...",Submit:"\u0420\u0430\u0437\u043c\u0435\u0441\u0442\u0438\u0442\u044c",Skip:"\u043f\u0440\u043e\u043f\u0443\u0441\u043a",Testimonials:"\u041e\u0442\u0437\u044b\u0432\u044b"},es:{"Real shoppers":"Compradores reales",Anonymous:"An\xf3nimo","verified by Fera.ai":"verificado por Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} opini{% if review_count == 1 %}\xf3n{% else %}ones{% endif %}","Product Reviews":"Rese\xf1as de productos","Customer Reviews":"Rese\xf1as de clientes",Reviews:"Rese\xf1as","Product:":"Producto:","Write a review":"Escribe una rese\xf1a","How was your experience?":"\xbfC\xf3mo fue tu experiencia?","Reviews From Similar Products":"Rese\xf1as de productos similares","Review The Store":"Revisar la tienda","Show More":"Mostrar M\xe1s","No reviews for this product yet.":"No hay comentarios para este producto todav\xeda.","{{ store_name }} replied:":"{{ store_name }} respondi\xf3:","We're adding a 2nd item to your cart now!":"\xa1Estamos agregando un segundo art\xedculo a su carrito ahora!","{{ user.name }} from {{ store.name }}":"{{ user.name }} para {{ store.name }}","{{ num }} second ago":"hace {{ num }} segundo","{{ num }} minute ago":"Hace {{ num }} minuto","{{ num }} hour ago":"{{ num }} hora antes","{{ num }} day ago":"Hace {{ num }} d\xeda","{{ num }} week ago":"Hace {{ num }} semana","{{ num }} month ago":"Hace {{ num }} mes","{{ num }} year ago":"hace {{ num }} a\xf1o","{{ num }} seconds ago":"Hace {{ num }} segundos","{{ num }} minutes ago":"hace {{ num }} minutos","{{ num }} hours ago":"Hace {{ num }} horas","{{ num }} days ago":"hace {{ num }} d\xedas","{{ num }} weeks ago":"hace {{ num }} semanas","{{ num }} months ago":"hace {{ num }} meses","{{ num }} years ago":"hace {{ num }} a\xf1os","Loading...":"cargando...",Submit:"Enviar",Skip:"Omitir",Testimonials:"Testimonios"},sk:{"Real shoppers":"Skuto\u010dn\xed kupuj\xfaci",Anonymous:"Anonymn\xfd","verified by Fera.ai":"overen\xe9 Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} recenzi{% if review_count == 1 %}a{% elsif review_count > 1 and review_count < 5 %}e{% else %}\xed{% endif %}","Product Reviews":"Recenzie produktu","Customer Reviews":"Z\xe1kazn\xedcke recenzie",Reviews:"Recenzie","Product:":"V\xfdrobok:","Write a review":"Nap\xedsa\u0165 recenziu","How was your experience?":"Ak\xe1 bola va\u0161a sk\xfasenos\u0165?","Reviews From Similar Products":"Recenzie z podobn\xfdch produktov","Review The Store":"Recenzia Obchod","Show More":"Zobrazi\u0165 Viac","No reviews for this product yet.":"Zatia\u013e nie s\xfa k tomuto produktu \u017eiadne recenzie.","{{ store_name }} replied:":"{{ store_name }} je odgovoril:","We're adding a 2nd item to your cart now!":"Teraz do v\xe1\u0161ho ko\u0161\xedka prid\xe1vame druh\xfa polo\u017eku!","{{ user.name }} from {{ store.name }}":"{{ user.name }} z {{ store.name }}","{{ num }} second ago":"Pred {{ num }} sekundou","{{ num }} minute ago":"Pred {{ num }} min\xfatou","{{ num }} hour ago":"pred {{ num }} hodinou","{{ num }} day ago":"Pred {{ num }} d\u0148om","{{ num }} week ago":"Pred {{ num }} t\xfd\u017ed\u0148om","{{ num }} month ago":"Pred {{ num }} mesiacom","{{ num }} year ago":"Pred {{ num }} rokom","{{ num }} seconds ago":"Pred {{ num }} sekundami","{{ num }} minutes ago":"Pred {{ num }} min\xfatami","{{ num }} hours ago":"pred {{ num }} hodinami","{{ num }} days ago":"pred {{ num }} d\u0148ami","{{ num }} weeks ago":"Pred {{ num }} tyzdnami","{{ num }} months ago":"Pred {{ num }} mesiacmi","{{ num }} years ago":"Pred {{ num }} rokmi","Loading...":"na\u010d\xedtava...",Submit:"Predlo\u017ei\u0165",Skip:"Ignorova\u0165",Testimonials:"Ohlasy"},sv:{"Real shoppers":"Riktiga shoppare",Anonymous:"Anonym","verified by Fera.ai":"verifierad av Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} produktrecension{% if review_count != 1 %}er{% endif %}","Product Reviews":"Produktrecensioner","Customer Reviews":"Kundrecensioner",Reviews:"Recensioner","Product:":"Produkt:","Write a review":"Skriva en recension","How was your experience?":"Hur var din upplevelse?","Reviews From Similar Products":"Recensioner fr\xe5n liknande produkter","Review The Store":"Recensera butiken","Show More":"Visa Mer","No reviews for this product yet.":"Inga recensioner f\xf6r denna produkt \xe4nnu.","{{ store_name }} replied:":"{{ store_name }} svarade:","We're adding a 2nd item to your cart now!":"Vi l\xe4gger till en andra artikel i din kundvagn nu!","{{ user.name }} from {{ store.name }}":"{{ user.name }} fr\xe5n {{ store.name }}","{{ num }} second ago":"{{ num }} sekund sedan","{{ num }} minute ago":"{{ num }} minut sedan","{{ num }} hour ago":"{{ num }} timme sedan","{{ num }} day ago":"{{ num }} dag sedan","{{ num }} week ago":"{{ num }} vecka sedan","{{ num }} month ago":"{{ num }} m\xe5nad sedan","{{ num }} year ago":"{{ num }} \xe5r sedan","{{ num }} seconds ago":"{{ num }} sekunder sedan","{{ num }} minutes ago":"f\xf6r {{ num }} minuter sedan","{{ num }} hours ago":"{{ num }} timmar sedan","{{ num }} days ago":"{{ num }} dagar sedan","{{ num }} weeks ago":"{{ num }} veckor sedan","{{ num }} months ago":"{{ num }} m\xe5nader sedan","{{ num }} years ago":"{{ num }} \xe5r sedan","Loading...":"l\xe4ser in...",Submit:"Skicka in",Skip:"Ignorera",Testimonials:"Vittnesm\xe5l"},th:{"Real shoppers":"\u0e1c\u0e39\u0e49\u0e0b\u0e37\u0e49\u0e2d\u0e08\u0e23\u0e34\u0e07",Anonymous:"\u0e44\u0e21\u0e48\u0e23\u0e30\u0e1a\u0e38\u0e0a\u0e37\u0e48\u0e2d","verified by Fera.ai":"\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e42\u0e14\u0e22 Fera.ai","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} \u0e04\u0e27\u0e32\u0e21\u0e04\u0e34\u0e14\u0e40\u0e2b\u0e47\u0e19\u0e15\u0e48\u0e2d\u0e2a\u0e34\u0e19\u0e04\u0e49\u0e32","Product Reviews":"\u0e1a\u0e17\u0e27\u0e34\u0e08\u0e32\u0e23\u0e13\u0e4c\u0e2a\u0e34\u0e19\u0e04\u0e49\u0e32","Customer Reviews":"\u0e04\u0e27\u0e32\u0e21\u0e04\u0e34\u0e14\u0e40\u0e2b\u0e47\u0e19\u0e02\u0e2d\u0e07\u0e25\u0e39\u0e01\u0e04\u0e49\u0e32",Reviews:"\u0e04\u0e27\u0e32\u0e21\u0e04\u0e34\u0e14\u0e40\u0e2b\u0e47\u0e19","Product:":"\u0e2a\u0e34\u0e19\u0e04\u0e49\u0e32:","Write a review":"\u0e41\u0e2a\u0e14\u0e07\u0e04\u0e27\u0e32\u0e21\u0e04\u0e34\u0e14\u0e40\u0e2b\u0e47\u0e19","How was your experience?":"\u0e1b\u0e23\u0e30\u0e2a\u0e1a\u0e01\u0e32\u0e23\u0e13\u0e4c\u0e02\u0e2d\u0e07\u0e04\u0e38\u0e13\u0e40\u0e1b\u0e47\u0e19\u0e2d\u0e22\u0e48\u0e32\u0e07\u0e44\u0e23?","Reviews From Similar Products":"\u0e1a\u0e17\u0e27\u0e34\u0e08\u0e32\u0e23\u0e13\u0e4c\u0e08\u0e32\u0e01\u0e1c\u0e25\u0e34\u0e15\u0e20\u0e31\u0e13\u0e11\u0e4c\u0e17\u0e35\u0e48\u0e04\u0e25\u0e49\u0e32\u0e22\u0e04\u0e25\u0e36\u0e07\u0e01\u0e31\u0e19","Review The Store":"\u0e23\u0e35\u0e27\u0e34\u0e27\u0e23\u0e49\u0e32\u0e19","Show More":"\u0e41\u0e2a\u0e14\u0e07\u0e21\u0e32\u0e01\u0e02\u0e36\u0e49\u0e19","No reviews for this product yet.":"\u0e22\u0e31\u0e07\u0e44\u0e21\u0e48\u0e21\u0e35\u0e01\u0e32\u0e23\u0e23\u0e35\u0e27\u0e34\u0e27\u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e2a\u0e34\u0e19\u0e04\u0e49\u0e32\u0e19\u0e35\u0e49","{{ store_name }} replied:":"{{ store_name }} \u0e15\u0e2d\u0e1a\u0e01\u0e25\u0e31\u0e1a:","We're adding a 2nd item to your cart now!":"\u0e40\u0e23\u0e32\u0e01\u0e33\u0e25\u0e31\u0e07\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e2a\u0e34\u0e19\u0e04\u0e49\u0e32\u0e0a\u0e34\u0e49\u0e19\u0e17\u0e35\u0e48\u0e2a\u0e2d\u0e07\u0e43\u0e19\u0e23\u0e16\u0e40\u0e02\u0e47\u0e19\u0e02\u0e2d\u0e07\u0e04\u0e38\u0e13\u0e15\u0e2d\u0e19\u0e19\u0e35\u0e49!","{{ user.name }} from {{ store.name }}":"{{ user.name }} \u0e08\u0e32\u0e01 {{ store.name }}","{{ num }} second ago":"{{ num }} \u0e27\u0e34\u0e19\u0e32\u0e17\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} minute ago":"{{ num }} \u0e19\u0e32\u0e17\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} hour ago":"{{ num }} \u0e0a\u0e31\u0e48\u0e27\u0e42\u0e21\u0e07\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} day ago":"{{ num }} \u0e27\u0e31\u0e19\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} week ago":"{{ num }} \u0e2a\u0e31\u0e1b\u0e14\u0e32\u0e2b\u0e4c\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} month ago":"{{ num }} \u0e40\u0e14\u0e37\u0e2d\u0e19\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} year ago":"{{ num }} \u0e1b\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} seconds ago":"{{ num }} \u0e27\u0e34\u0e19\u0e32\u0e17\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} minutes ago":"{{ num }} \u0e19\u0e32\u0e17\u0e35\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} hours ago":"{{ num }} \u0e0a\u0e31\u0e48\u0e27\u0e42\u0e21\u0e07\u0e17\u0e35\u0e48\u0e1c\u0e48\u0e32\u0e19\u0e21\u0e32","{{ num }} days ago":"{{ num }} \u0e27\u0e31\u0e19\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} weeks ago":"{{ num }} \u0e2a\u0e31\u0e1b\u0e14\u0e32\u0e2b\u0e4c\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} months ago":"{{ num }} \u0e40\u0e14\u0e37\u0e2d\u0e19\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","{{ num }} years ago":"{{ num }} \u0e1b\u0e35\u0e17\u0e35\u0e48\u0e41\u0e25\u0e49\u0e27","Loading...":"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e42\u0e2b\u0e25\u0e14 ...",Submit:"\u0e2a\u0e48\u0e07",Skip:"\u0e44\u0e21\u0e48\u0e2a\u0e19\u0e43\u0e08",Testimonials:"\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21\u0e23\u0e31\u0e1a\u0e23\u0e2d\u0e07"},zh:{"Real shoppers":"\u771f\u6b63\u7684\u8d2d\u7269\u8005",Anonymous:"\u533f\u540d\u7684","verified by Fera.ai":"\u7531Fera.ai\u9a8c\u8bc1","{{ review_count }} review{% if review_count != 1 %}s{% endif %}":"{{ review_count }} {% if review_count == 1 %}\u4e2a\u4ea7{% else %}\u4ef6\u5546{% endif %}\u54c1\u8bc4\u8bba","Product Reviews":"\u7522\u54c1\u8a55\u8ad6","Customer Reviews":"\u9867\u5ba2\u8a55\u8ad6",Reviews:"\u8a55\u8ad6","Product:":"\u7522\u54c1\uff1a","Write a review":"\u5beb\u4e00\u7bc7\u8a55\u8ad6","How was your experience?":"\u4f60\u7684\u7d93\u6b77\u600e\u9ebc\u6a23\uff1f","Reviews From Similar Products":"\u4f86\u81ea\u985e\u4f3c\u7522\u54c1\u7684\u8a55\u8ad6","Review The Store":"\u8a55\u8ad6\u5546\u5e97","Show More":"\u986f\u793a\u66f4\u591a","No reviews for this product yet.":"\u8fd9\u4ef6\u5546\u54c1\u8fd8\u6ca1\u6709\u4efb\u4f55\u8bc4\u8bba\u3002","{{ store_name }} replied:":"{{ store_name }} \u56de\u7b54\uff1a","We're adding a 2nd item to your cart now!":"\u6211\u5011\u73fe\u5728\u5c07\u7b2c\u4e8c\u4ef6\u5546\u54c1\u6dfb\u52a0\u5230\u60a8\u7684\u8cfc\u7269\u8eca\uff01","{{ user.name }} from {{ store.name }}":"\u4ee3\u8868 {{ store.name }} \u7684 {{ user.name }}","{{ num }} second ago":"{{ num }}\u79d2\u524d","{{ num }} minute ago":"{{ num }}\u5206\u9418\u524d","{{ num }} hour ago":"{{ num }}\u5c0f\u6642\u524d","{{ num }} day ago":"{{ num }}\u5929\u524d","{{ num }} week ago":"{{ num }}\u9031\u524d","{{ num }} month ago":"{{ num }}\u500b\u6708\u524d","{{ num }} year ago":"{{ num }}\u5e74\u524d","{{ num }} seconds ago":"{{ num }}\u79d2\u524d","{{ num }} minutes ago":"{{ num }}\u5206\u9418\u524d","{{ num }} hours ago":"{{ num }}\u5c0f\u6642\u524d","{{ num }} days ago":"{{ num }}\u5929\u524d","{{ num }} weeks ago":"{{ num }}\u500b\u661f\u671f\u524d","{{ num }} months ago":"{{ num }}\u500b\u6708\u524d","{{ num }} years ago":"{{ num }}\u5e74\u524d","Loading...":"\u8f09\u5165\u4e2d...",Submit:"\u63d0\u4ea4",Skip:"\u8df3\u904e",Testimonials:"\u611f\u8a00"}}}},Fera.ImageViewer=class{init(e){this.$=Fera.Util.$(),this.$el=this.$(this.selector),this.$el.length<1&&(this._render(),this.$el=this.$(this.selector),this.$el.find(".fera-imageViewer-container").on("click",this._hide.bind(this))),e.on("click",this._show.bind(this))}get selector(){return".fera-imageViewer-overlay"}_show(e){let t=this.$(e.target).clone().removeClass();if(t.data("imageUrl")){const e=t.data("imageUrl");t=this.$(`<img src="${e}" />`)}const i=this.$('<a href="#" class="fera-imageViewer-close-btn">&times;</a>');this.$el.removeClass("fera-hidden"),this.$el.find(".fera-imageViewer").html(t),this.$el.find(".fera-imageViewer").append(i),this.$("body").addClass("fera-modal--open"),i.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this._hide()})),this.$(document).on("keydown",(e=>{27===(e.keyCode||e.which)&&this._hide()}))}_hide(e){if(e){if(!this.$(e.target).is(".fera-imageViewer-container"))return}this.$el.addClass("fera-hidden"),this.$("body").removeClass("fera-modal--open")}_render(){this.$("body").append(this._tpl()).append(`<style>${this._css()}</style>`)}_tpl(){return'\n<div class="fera-imageViewer-overlay fera-hidden">\n    <div class="fera-imageViewer-container">\n        <div class="fera-imageViewer"></div>\n    </div>\n</div>\n        '}_css(){return"\n.fera-modal--open {\n    overflow: hidden !important;\n}\n\n.fera-hidden {\n    display: none !important;\n}\n\n.fera-imageViewer-overlay {\n    position: fixed;\n    background: rgba(0,0,0,0.4);\n    z-index: 9999999;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n\n.fera-imageViewer-container {\n    height: 100%;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.fera-imageViewer {\n    max-width: 100%;\n    max-height: 100%;\n    line-height: 0;\n    position: relative;\n    margin-left: 1%;\n    margin-right: 1%;\n    text-align: center;\n    text-shadow: 0 0 1px white, 0 0 1px white, 0 0 1px white;\n}\n\n.fera-imageViewer-close-btn {\n    color: #000000;\n    font-weight: 100;\n    font-size: 1.5rem;\n    line-height: 0.75rem;\n    position: absolute;\n    right: 14px;\n    top: 14px;\n}\n\n.fera-imageViewer img {\n    width: auto !important;\n    max-width: 100%;\n    max-height: 768px; /* fallback */\n    max-height: 98vh;\n    background-color: #ffffff;\n}\n\n.fera-imageViewer-viewable {\n    cursor: pointer;\n}\n        "}},Fera.InactivityDetector=function(e){e=e||{};var t,i=this,r=!1,n=Fera.Util.$(),a=void 0===e.reactToWindowBlurs||e.reactToWindowBlurs,o=[],s=[],c=[],u=!0;i.hadInteraction=!1;var l=function(){e.timeLimit=e.timeLimit||6e4,f()};i.attachToFrames=function(){for(var t=0;t<window.frames.length;t++)try{m(window.frames[t],window.frames[t].document)}catch(i){e.logger.log("Failed to attach to frame. Likely due to it being of a different origin than the main frame.",t)}},i.afterFirstInteraction=function(e,t){i.hadInteraction?e():(c.push(e),t&&setTimeout((function(){if(!i.hadInteraction){for(var t=0;t<c.length;t++)if(c[t]===e){c.splice(t,1);break}e()}}),t))},i.addInactivityListener=function(e){o.push(e)},i.addReactivityListener=function(e){s.push(e)},i.isActive=function(){return u};var d=function(){for(var e=0;e<s.length;e++)s[e](i);u=!0},p=function(){for(var e=0;e<o.length;e++)o[e](i);u=!1},h=function(){i.hadInteraction=!0;for(var e=0;e<c.length;e++)c[e](i)},f=function(){m(window,document),i.attachToFrames()},m=function(e,t){n(t).on("mousemove keypress mousedown touchstart click scroll",g),a&&(n(e).on("blur",v),n(e).on("focus",_)),n(e).on("scroll",(function(){r&&_()}))},g=function(){_(),t=setTimeout(v,e.timeLimit)},v=function(){var e=r;r=!0,e||p()},_=function(){t&&clearTimeout(t),i.hadInteraction||h();var e=r;r=!1,e&&d()};l()},Fera.Liquid={registerFilters:function(e){Fera.Liquid.Template.registerFilter(e)},parse:function(e){return Fera.Liquid.Template.parse(e)}},Fera.Liquid.extensions={},Fera.Liquid.extensions.object={},Fera.Liquid.extensions.object.update=function(e){for(var t in e)this[t]=e[t];return this},Fera.Liquid.extensions.object.hasKey=function(e){return!!this[e]},Fera.Liquid.extensions.object.hasValue=function(e){for(var t in this)if(this[t]==e)return!0;return!1},Fera.Liquid.extensions.object.isEmpty=function(e){if(!e||""===Fera.Liquid.extensions.stringTools.strip(e.toString()))return!0;if(e.length&&e.length>0)return!1;if("number"==typeof e)return!1;for(var t in e)if(e[t])return!1;return!0},Fera.Liquid.extensions.stringTools={},Fera.Liquid.extensions.stringTools.capitalize=function(e){
return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()},Fera.Liquid.extensions.stringTools.strip=function(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")},Fera.Liquid.extensions.arrayTools={},Fera.Liquid.extensions.arrayTools.last=function(e){return e[e.length-1]},Fera.Liquid.extensions.arrayTools.indexOf=function(e,t){for(var i=0;i<e.length;i++)if(e[i]==t)return i;return-1},Fera.Liquid.extensions.arrayTools.map=function(e,t){var i=e.length;if("function"!=typeof t)throw"Fera.Liquid.extensions.arrayTools.map requires first argument to be a function";for(var r=new Array(i),n=arguments[2],a=0;a<i;a++)a in e&&(r[a]=t.call(n,e[a],a,e));return r},Fera.Liquid.extensions.arrayTools.flatten=function(e){for(var t=e.length,i=[],r=0;r<t;r++)e[r]instanceof Array?i=i.concat(e[r]):i.push(e[r]);return i},Fera.Liquid.extensions.arrayTools.each=function(e,t){var i=e.length;if("function"!=typeof t)throw"Fera.Liquid.extensions.arrayTools.each requires first argument to be a function";for(var r=arguments[2],n=0;n<i;n++)n in e&&t.call(r,e[n],n,e);return null},Fera.Liquid.extensions.arrayTools.include=function(e,t){e.length;return Fera.Liquid.extensions.arrayTools.indexOf(e,t)>=0},function(){var e=!1,t=/xyz/.test((function(){xyz}))?/\b_super\b/:/.*/;this.Class=function(){},this.Class.extend=function(i){function r(){!e&&this.init&&this.init.apply(this,arguments)}var n=this.prototype;e=!0;var a=new this;for(var o in e=!1,i)a[o]="function"==typeof i[o]&&"function"==typeof n[o]&&t.test(i[o])?function(e,t){return function(){var i=this._super;this._super=n[e];var r=t.apply(this,arguments);return this._super=i,r}}(o,i[o]):i[o];return r.prototype=a,r.prototype.constructor=r,r.extend=arguments.callee,r}}.call(Fera.Liquid),Fera.Liquid.Tag=Fera.Liquid.Class.extend({init:function(e,t,i){this.tagName=e,this.markup=t,this.nodelist=this.nodelist||[],this.parse(i)},parse:function(){},render:function(){return""}}),Fera.Liquid.Block=Fera.Liquid.Tag.extend({init:function(e,t,i){this.blockName=e,this.blockDelimiter="end"+this.blockName,this._super(e,t,i)},parse:function(e){this.nodelist||(this.nodelist=[]),this.nodelist.length=0;var t=e.shift();for(e.push("");e.length;){if(/^\{\%/.test(t)){this.whitespaceHandler(t,e);var i=t.match(/^\{\%-?\s*(\w+)\s*(.*?)-?\%\}$/);if(!i)throw"Tag '"+t+"' was not properly terminated with: %}";if(this.blockDelimiter==i[1])return void this.endTag();i[1]in Fera.Liquid.Template.tags?this.nodelist.push(new Fera.Liquid.Template.tags[i[1]](i[1],i[2],e)):this.unknownTag(i[1],i[2],e)}else/^\{\{/.test(t)?(this.whitespaceHandler(t,e),this.nodelist.push(this.createVariable(t))):this.nodelist.push(t);t=e.shift()}this.assertMissingDelimitation()},endTag:function(){},unknownTag:function(e){switch(e){case"else":throw this.blockName+" tag does not expect else tag";case"end":throw"'end' is not a valid delimiter for "+this.blockName+" tags. use "+this.blockDelimiter;default:throw"Unknown tag: "+e}},createVariable:function(e){var t=e.match(/^\{\{-?(.*?)-?\}\}$/);if(t)return new Fera.Liquid.Variable(t[1]);throw"Variable '"+e+"' was not properly terminated with: }}"},render:function(e){return this.renderAll(this.nodelist,e)},renderAll:function(e,t){return Fera.Liquid.extensions.arrayTools.map(e||[],(function(e){var i="";try{i=e.render?e.render(t):e}catch(e){i=t.handleError(e)}return i}))},assertMissingDelimitation:function(){throw this.blockName+" tag was never closed"},whitespaceHandler:function(e,t){"-"==e[2]&&this.nodelist.length>0&&""===this.nodelist[this.nodelist.length-1].trim()&&this.nodelist.pop(),"-"===e[e.length-3]&&t.length>0&&""===t[0].trim()&&t.shift()}}),Fera.Liquid.Document=Fera.Liquid.Block.extend({init:function(e){this.blockDelimiter=[],this.parse(e)},assertMissingDelimitation:function(){}}),Fera.Liquid.Strainer=Fera.Liquid.Class.extend({init:function(e){this.context=e},respondTo:function(e){return!(e=e.toString()).match(/^__/)&&(!Fera.Liquid.extensions.arrayTools.include(Fera.Liquid.Strainer.requiredMethods,e)&&e in this)}}),Fera.Liquid.Strainer.filters={},Fera.Liquid.Strainer.globalFilter=function(e){for(var t in e)Fera.Liquid.Strainer.filters[t]=e[t]},Fera.Liquid.Strainer.requiredMethods=["respondTo","context"],Fera.Liquid.Strainer.create=function(e){var t=new Fera.Liquid.Strainer(e);for(var i in Fera.Liquid.Strainer.filters)t[i]=Fera.Liquid.Strainer.filters[i];return t},Fera.Liquid.Context=Fera.Liquid.Class.extend({init:function(e,t,i){this.scopes=[e||{}],this.registers=t||{},this.errors=[],this.rethrowErrors=i,this.strainer=Fera.Liquid.Strainer.create(this)},get:function(e){return this.resolve(e)},set:function(e,t){this.scopes[0][e]=t},hasKey:function(e){return!!this.resolve(e)},push:function(){var e={};return this.scopes.unshift(e),e},merge:function(e){return Fera.Liquid.extensions.object.update.call(this.scopes[0],e)},pop:function(){if(1==this.scopes.length)throw"Context stack error";return this.scopes.shift()},stack:function(e,t){var i=null;this.push();try{i=e.apply(t||this.strainer)}finally{this.pop()}return i},invoke:function(e,t){return this.strainer.respondTo(e)?this.strainer[e].apply(this.strainer,t):0==t.length?null:t[0]},resolve:function(e){switch(e){case null:case"nil":case"null":case"":return null;case"true":return!0;case"false":return!1;case"blank":case"empty":return"";default:if(/^'(.*)'$/.test(e))return e.replace(/^'(.*)'$/,"$1");if(/^"(.*)"$/.test(e))return e.replace(/^"(.*)"$/,"$1");if(/^(\d+)$/.test(e))return parseInt(e.replace(/^(\d+)$/,"$1"));if(/^(\d[\d\.]+)$/.test(e))return parseFloat(e.replace(/^(\d[\d\.]+)$/,"$1"));if(/^\((\S+)\.\.(\S+)\)$/.test(e)){var t=e.match(/^\((\S+)\.\.(\S+)\)$/),i=parseInt(t[1]),r=parseInt(t[2]),n=[];if(isNaN(i)){var a=this.resolve(t[1]);if(i=parseInt(a),isNaN(i))throw new Error("Incorrect param for range: "+e)}if(isNaN(r)){var o=this.resolve(t[2]);if(r=parseInt(o),isNaN(r))throw new Error("Incorrect param for range: "+e)}for(var s=r-i+1,c=0;c<s;c++)n.push(c+i);return n}return this.variable(e)}},findVariable:function(e){for(var t=0;t<this.scopes.length;t++){var i=this.scopes[t];if(i&&void 0!==i[e]){var r=i[e];return"function"==typeof r&&(r=r.apply(this),i[e]=r),r&&this._isObject(r)&&"toFera.Liquid"in r&&(r=r.toFera.Liquid()),r&&this._isObject(r)&&"setContext"in r&&r.setContext(self),r}}return null},variable:function(e){if("string"!=typeof e)return null;var t=e.match(/\[[^\]]+\]|(?:[\w\-]\??)+/g),i=t.shift(),r=i.match(/^\[(.*)\]$/);r&&(i=this.resolve(r[1]));var n=this.findVariable(i),a=this;return n&&Fera.Liquid.extensions.arrayTools.each(t,(function(e){var t=e.match(/^\[(.*)\]$/);if(t){e=a.resolve(t[1]);"function"==typeof n[e]&&(n[e]=n[e].apply(this)),n=n[e],a._isObject(n)&&"toFera.Liquid"in n&&(n=n.toFera.Liquid())}else{if((a._isObject(n)||"hash"==typeof n)&&e in n){var i=n[e];"function"==typeof i&&(i=n[e]=i.apply(a)),n=a._isObject(i)&&"toFera.Liquid"in i?i.toFera.Liquid():i}else if(/^\d+$/.test(e)){var r=parseInt(e);"function"==typeof n[r]&&(n[r]=n[r].apply(a)),n=a._isObject(n)&&a._isObject(n[r])&&"toFera.Liquid"in n[r]?n[r].toFera.Liquid():n[r]}else{if(!n||"function"!=typeof n[e]||!Fera.Liquid.extensions.arrayTools.include(["length","size","first","last"],e))return n=null;"toFera.Liquid"in(n=n[e].apply(e))&&(n=n.toFera.Liquid())}a._isObject(n)&&"setContext"in n&&n.setContext(a)}})),n},addFilters:function(e){e=Fera.Liquid.extensions.arrayTools.flatten(e),Fera.Liquid.extensions.arrayTools.each(e,(function(e){if(!this._isObject(e))throw"Expected object but got: "+typeof e;this.strainer.addMethods(e)}))},handleError:function(e){if(this.errors.push(e),this.rethrowErrors)throw e;return"Fera.Liquid error: "+(e.message?e.message:e.description?e.description:e)},_isObject:function(e){return null!=e&&"object"==typeof e}}),Fera.Liquid.Template=Fera.Liquid.Class.extend({init:function(){this.root=null,this.registers={},this.assigns={},this.errors=[],this.rethrowErrors=!1},parse:function(e){return this.root=new Fera.Liquid.Document(Fera.Liquid.Template.tokenize(e)),this},render:function(){if(!this.root)return"";var e={ctx:arguments[0],filters:arguments[1],registers:arguments[2]},t=null;e.ctx instanceof Fera.Liquid.Context?(t=e.ctx,this.assigns=t.assigns,this.registers=t.registers):(e.ctx&&Fera.Liquid.extensions.object.update.call(this.assigns,e.ctx),e.registers&&Fera.Liquid.extensions.object.update.call(this.registers,e.registers),t=new Fera.Liquid.Context(this.assigns,this.registers,this.rethrowErrors)),e.filters&&t.addFilters(e.filters);try{return this.root.render(t).join("")}finally{this.errors=t.errors}},renderWithErrors:function(){var e=this.rethrowErrors;this.rethrowErrors=!0;var t=this.render.apply(this,arguments);return this.rethrowErrors=e,t}}),Fera.Liquid.Template.tags={},Fera.Liquid.Template.registerTag=function(e,t){Fera.Liquid.Template.tags[e]=t},Fera.Liquid.Template.registerFilter=function(e){Fera.Liquid.Strainer.globalFilter(e)},Fera.Liquid.Template.tokenize=function(e){var t=e.split(/(\{\%.*?\%\}|\{\{.*?\}\}?)/);return""==t[0]&&t.shift(),t},Fera.Liquid.Template.parse=function(e){return(new Fera.Liquid.Template).parse(e)},Fera.Liquid.Variable=Fera.Liquid.Class.extend({init:function(e){this.markup=e,this.name=null,this.filters=[];var t=this,i=e.match(/\s*("[^"]+"|'[^']+'|[^\s,|]+)/);if(i){this.name=i[1];var r=e.match(/\|\s*(.*)/);if(r){var n=r[1].split(/\|/);Fera.Liquid.extensions.arrayTools.each(n,(function(e){var i=e.match(/\s*(\w+)/);if(i){var r=i[1],n=[];Fera.Liquid.extensions.arrayTools.each(Fera.Liquid.extensions.arrayTools.flatten(e.match(/(?:[:|,]\s*)("[^"]+"|'[^']+'|[^\s,|]+)/g)||[]),(function(e){var t=e.match(/^[\s|:|,]*(.*?)[\s]*$/);t&&n.push(t[1])})),t.filters.push([r,n])}}))}}},render:function(e){if(null==this.name)return"";var t=e.get(this.name);return Fera.Liquid.extensions.arrayTools.each(this.filters,(function(i){var r=i[0],n=Fera.Liquid.extensions.arrayTools.map(i[1]||[],(function(t){return e.get(t)}));n.unshift(t),t=e.invoke(r,n)})),t}}),Fera.Liquid.Condition=Fera.Liquid.Class.extend({init:function(e,t,i){this.left=e,this.operator=t,this.right=i,this.childRelation=null,this.childCondition=null,this.attachment=null},evaluate:function(e){e=e||new Fera.Liquid.Context;var t=this.interpretCondition(this.left,this.right,this.operator,e);switch(this.childRelation){case"or":return t||this.childCondition.evaluate(e);case"and":return t&&this.childCondition.evaluate(e);default:return t}},or:function(e){this.childRelation="or",this.childCondition=e},and:function(e){this.childRelation="and",this.childCondition=e},attach:function(e){return this.attachment=e,this.attachment},isElse:!1,interpretCondition:function(e,t,i,r){if(!i)return r.get(e);if(e=r.get(e),t=r.get(t),!(i=Fera.Liquid.Condition.operators[i]))throw"Unknown operator "+i;return i(e,t)},toString:function(){return"<Condition "+this.left+" "+this.operator+" "+this.right+">"}}),Fera.Liquid.Condition.operators={"==":function(e,t){return e==t},"=":function(e,t){return e==t},"!=":function(e,t){return e!=t},"<>":function(e,t){return e!=t},"<":function(e,t){return e<t},">":function(e,t){return e>t},"<=":function(e,t){return e<=t},">=":function(e,t){return e>=t},contains:function(e,t){return"[object Array]"===Object.prototype.toString.call(e)?Fera.Liquid.extensions.arrayTools.indexOf(e,t)>=0:e.match(t)},hasKey:function(e,t){return Fera.Liquid.extensions.object.hasKey.call(e,t)},hasValue:function(e,t){return Fera.Liquid.extensions.object.hasValue.call(e,t)}},Fera.Liquid.ElseCondition=Fera.Liquid.Condition.extend({isElse:!0,evaluate:function(){return!0},toString:function(){return"<ElseCondition>"}}),Fera.Liquid.Drop=Fera.Liquid.Class.extend({setContext:function(e){this.context=e},beforeMethod:function(){},invokeDrop:function(e){var t=this.beforeMethod();return!t&&e in this&&(t=this[e].apply(this)),t},hasKey:function(){return!0}});var hackObjectEach=function(e){if("function"!=typeof e)throw"Object.each requires first argument to be a function";var t=0,i=arguments[1];for(var r in this){var n=this[r],a=[r,n];a.key=r,a.value=n,e.call(i,a,t,this),t++}return null},split;Fera.Liquid.Template.registerTag("assign",Fera.Liquid.Tag.extend({tagSyntax:/((?:\(?[\w\-\.\[\]]\)?)+)\s*=\s*(.+)/,init:function(e,t,i){var r=t.match(this.tagSyntax);if(!r)throw"Syntax error in 'assign' - Valid syntax: assign [var] = [source]";this.to=r[1],this.from=r[2],this._super(e,t,i)},render:function(e){var t=new Fera.Liquid.Variable(this.from);return Fera.Liquid.extensions.arrayTools.last(e.scopes)[this.to.toString()]=t.render(e),""}})),Fera.Liquid.Template.registerTag("cache",Fera.Liquid.Block.extend({tagSyntax:/(\w+)/,init:function(e,t,i){var r=t.match(this.tagSyntax);if(!r)throw"Syntax error in 'cache' - Valid syntax: cache [var]";this.to=r[1],this._super(e,t,i)},render:function(e){var t=this._super(e);return Fera.Liquid.extensions.arrayTools.last(e.scopes)[this.to]=Fera.Liquid.extensions.arrayTools.flatten([t]).join(""),""}})),Fera.Liquid.Template.registerTag("capture",Fera.Liquid.Block.extend({tagSyntax:/(\w+)/,init:function(e,t,i){var r=t.match(this.tagSyntax);if(!r)throw"Syntax error in 'capture' - Valid syntax: capture [var]";this.to=r[1],this._super(e,t,i)},render:function(e){var t=this._super(e);return Fera.Liquid.extensions.arrayTools.last(e.scopes)[this.to.toString()]=Fera.Liquid.extensions.arrayTools.flatten([t]).join(""),""}})),Fera.Liquid.Template.registerTag("case",Fera.Liquid.Block.extend({tagSyntax:/("[^"]+"|'[^']+'|[^\s,|]+)/,tagWhenSyntax:/("[^"]+"|'[^']+'|[^\s,|]+)(?:(?:\s+or\s+|\s*\,\s*)("[^"]+"|'[^']+'|[^\s,|]+.*))?/,init:function(e,t,i){this.blocks=[],this.nodelist=[];var r=t.match(this.tagSyntax);if(!r)throw"Syntax error in 'case' - Valid syntax: case [condition]";this.left=r[1],this._super(e,t,i)},unknownTag:function(e,t,i){switch(e){case"when":this.recordWhenCondition(t);break;case"else":this.recordElseCondition(t);break;default:this._super(e,t,i)}},render:function(e){var t=this,i=[],r=!0;return e.stack((function(){for(var n=0;n<t.blocks.length;n++){var a=t.blocks[n];if(a.isElse)return 1==r&&(i=Fera.Liquid.extensions.arrayTools.flatten([i,t.renderAll(a.attachment,e)])),i;a.evaluate(e)&&(r=!1,i=Fera.Liquid.extensions.arrayTools.flatten([i,t.renderAll(a.attachment,e)]))}})),i},recordWhenCondition:function(e){for(;e;){var t=e.match(this.tagWhenSyntax);if(!t)throw"Syntax error in tag 'case' - Valid when condition: {% when [condition] [or condition2...] %} ";e=t[2];var i=new Fera.Liquid.Condition(this.left,"==",t[1]);this.blocks.push(i),this.nodelist=i.attach([])}},recordElseCondition:function(e){if(""!=Fera.Liquid.extensions.stringTools.strip(e||""))throw"Syntax error in tag 'case' - Valid else condition: {% else %} (no parameters) ";var t=new Fera.Liquid.ElseCondition;this.blocks.push(t),this.nodelist=t.attach([])}})),Fera.Liquid.Template.registerTag("comment",Fera.Liquid.Block.extend({render:function(){return""}})),Fera.Liquid.Template.registerTag("cycle",Fera.Liquid.Tag.extend({tagSimpleSyntax:/"[^"]+"|'[^']+'|[^\s,|]+/,tagNamedSyntax:/("[^"]+"|'[^']+'|[^\s,|]+)\s*\:\s*(.*)/,init:function(e,t,i){var r;if(r=t.match(this.tagNamedSyntax))this.variables=this.variablesFromString(r[2]),this.name=r[1];else{if(!(r=t.match(this.tagSimpleSyntax)))throw"Syntax error in 'cycle' - Valid syntax: cycle [name :] var [, var2, var3 ...]";this.variables=this.variablesFromString(t),this.name="'"+this.variables.toString()+"'"}this._super(e,t,i)},render:function(e){var t=this,i=e.get(t.name),r="";return e.registers.cycle||(e.registers.cycle={}),e.registers.cycle[i]||(e.registers.cycle[i]=0),e.stack((function(){var n=e.registers.cycle[i],a=e.get(t.variables[n]);(n+=1)==t.variables.length&&(n=0),e.registers.cycle[i]=n,r=a})),r},variablesFromString:function(e){return Fera.Liquid.extensions.arrayTools.map(e.split(","),(function(e){var t=e.match(/\s*("[^"]+"|'[^']+'|[^\s,|]+)\s*/);return t[1]?t[1]:null}))}})),Fera.Liquid.Template.registerTag("for",Fera.Liquid.Block.extend({tagSyntax:/(\w+)\s+in\s+((?:\(?[\w\-\.\[\]]\)?)+)/,init:function(e,t,i){var r=t.match(this.tagSyntax);if(!r)throw"Syntax error in 'for loop' - Valid syntax: for [item] in [collection]";this.variableName=r[1],this.collectionName=r[2],this.name=this.variableName+"-"+this.collectionName,this.attributes={};t.replace(this.tagSyntax,"");var n=t.match(/(\w*?)\s*\:\s*("[^"]+"|'[^']+'|[^\s,|]+)/g);n&&Fera.Liquid.extensions.arrayTools.each(n,(function(e){e=e.split(":"),this.attributes[Fera.Liquid.extensions.stringTools.strip(e[0])]=Fera.Liquid.extensions.stringTools.strip(e[1])}),this),this._super(e,t,i)},render:function(e){var t=this,i=[],r=e.get(this.collectionName)||[],n=[0,r.length];if(e.registers.for||(e.registers.for={}),this.attributes.limit||this.attributes.offset){var a=0,o=0,s=0,c=null;n=[a="continue"==this.attributes.offset?e.registers.for[this.name]:e.get(this.attributes.offset)||0,(s=(o=e.get(this.attributes.limit))?a+o+1:r.length)-1],e.registers.for[this.name]=s}return(c=r.slice(n[0],n[1]))&&0!=c.length?(e.stack((function(){var r=c.length;Fera.Liquid.extensions.arrayTools.each(c,(function(n,a){e.set(t.variableName,n),e.set("forloop",{name:t.name,length:r,index:a+1,index0:a,rindex:r-a,rindex0:r-a-1,first:0==a,last:a==r-1}),i.push((t.renderAll(t.nodelist,e)||[]).join(""))}))})),Fera.Liquid.extensions.arrayTools.flatten([i]).join("")):""}})),Fera.Liquid.Template.registerTag("if",Fera.Liquid.Block.extend({tagSyntax:/("[^"]+"|'[^']+'|[^\s,|]+)\s*([=!<>a-z_]+)?\s*("[^"]+"|'[^']+'|[^\s,|]+)?/,init:function(e,t,i){this.nodelist=[],this.blocks=[],this.pushBlock("if",t),this._super(e,t,i)},unknownTag:function(e,t,i){Fera.Liquid.extensions.arrayTools.include(["elsif","else"],e)?this.pushBlock(e,t):this._super(e,t,i)},render:function(e){var t=this,i="";return e.stack((function(){for(var r=0;r<t.blocks.length;r++){var n=t.blocks[r];if(n.evaluate(e))return void(i=t.renderAll(n.attachment,e))}})),Fera.Liquid.extensions.arrayTools.flatten([i]).join("")},pushBlock:function(e,t){var i;if("else"==e)i=new Fera.Liquid.ElseCondition;else{var r=t.split(/\b(and|or)\b/).reverse();if(!(a=r.shift().match(this.tagSyntax)))throw"Syntax Error in tag '"+e+"' - Valid syntax: "+e+" [expression]";for(var n=new Fera.Liquid.Condition(a[1],a[2],a[3]);r.length>0;){var a,o=r.shift();if(!(a=r.shift().match(this.tagSyntax)))throw"Syntax Error in tag '"+e+"' - Valid syntax: "+e+" [expression]";var s=new Fera.Liquid.Condition(a[1],a[2],a[3]);s[o](n),n=s}i=n}i.attach([]),this.blocks.push(i),this.nodelist=i.attachment}})),Fera.Liquid.Template.registerTag("ifchanged",Fera.Liquid.Block.extend({render:function(e){var t=this,i="";return e.stack((function(){var r=t.renderAll(t.nodelist,e).join("");r!=e.registers.ifchanged&&(i=r,e.registers.ifchanged=i)})),i}})),Fera.Liquid.Template.registerTag("include",Fera.Liquid.Tag.extend({tagSyntax:/((?:"[^"]+"|'[^']+'|[^\s,|]+)+)(\s+(?:with|for)\s+((?:"[^"]+"|'[^']+'|[^\s,|]+)+))?/,init:function(e,t,i){var r=(t||"").match(this.tagSyntax);if(!r)throw"Error in tag 'include' - Valid syntax: include '[template]' (with|for) [object|collection]";this.templateName=r[1],this.templateNameVar=this.templateName.substring(1,this.templateName.length-1),this.variableName=r[3],this.attributes={};var n=t.match(/(\w*?)\s*\:\s*("[^"]+"|'[^']+'|[^\s,|]+)/g);n&&Fera.Liquid.extensions.arrayTools.each(n,(function(e){e=e.split(":"),this.attributes[Fera.Liquid.extensions.stringTools.strip(e[0])]=Fera.Liquid.extensions.stringTools.strip(e[1])}),this),this._super(e,t,i)},render:function(e){var t=this,i=Fera.Liquid.readTemplateFile(e.get(this.templateName)),r=Fera.Liquid.parse(i),n=e.get(this.variableName||this.templateNameVar),a="";return e.stack((function(){t.attributes.each=hackObjectEach,t.attributes.each((function(t){e.set(t.key,e.get(t.value))})),n instanceof Array?a=Fera.Liquid.extensions.arrayTools.map(n,(function(i){return e.set(t.templateNameVar,i),r.render(e)})):(e.set(t.templateNameVar,n),a=r.render(e))})),a=Fera.Liquid.extensions.arrayTools.flatten([a]).join("")}})),Fera.Liquid.Template.registerTag("unless",Fera.Liquid.Template.tags.if.extend({render:function(e){var t=this,i="";return e.stack((function(){if((n=t.blocks[0]).evaluate(e))for(var r=1;r<t.blocks.length;r++){var n;if((n=t.blocks[r]).evaluate(e))return void(i=t.renderAll(n.attachment,e))}else i=t.renderAll(n.attachment,e)})),Fera.Liquid.extensions.arrayTools.flatten([i]).join("")}})),Fera.Liquid.Template.registerTag("raw",Fera.Liquid.Block.extend({parse:function(e){this.nodelist||(this.nodelist=[]),this.nodelist.length=0;var t=e.shift();for(e.push("");e.length;){if(/^\{\%/.test(t)){var i=t.match(/^\{\%\s*(\w+)\s*(.*)?\%\}$/);if(i&&this.blockDelimiter==i[1])return void this.endTag()}this.nodelist.push(t||""),t=e.shift()}this.assertMissingDelimitation()},render:function(){return this.nodelist.join("")}})),Fera.Liquid.Template.registerTag("increment",Fera.Liquid.Tag.extend({tagSyntax:/((?:\(?[\w\-\.\[\]]\)?)+)/,init:function(e,t,i){var r=t.match(this.tagSyntax);if(console.log(e,t,i),console.log(r[1]),!r)throw"Syntax error in 'assign' - Valid syntax: increment [var]";this.name=r[1],this._super(e,t,i)},render:function(e){var t=this.name,i="";return e.registers.increment||(e.registers.increment={}),e.registers.increment[t]||(e.registers.increment[t]=0),i=String(e.registers.increment[t]),e.registers.increment[t]++,i}})),Fera.Liquid.Template.registerTag("decrement",Fera.Liquid.Tag.extend({tagSyntax:/((?:\(?[\w\-\.\[\]]\)?)+)/,init:function(e,t,i){var r=t.match(this.tagSyntax);if(console.log(e,t,i),console.log(r[1]),!r)throw"Syntax error in 'assign' - Valid syntax: decrement [var]";this.name=r[1],this._super(e,t,i)},render:function(e){var t=this.name,i="";return e.registers.decrement||(e.registers.decrement={}),e.registers.decrement[t]||(e.registers.decrement[t]=-1),i=String(e.registers.decrement[t]),e.registers.decrement[t]--,i}})),Fera.Liquid.Template.registerFilter({_HTML_ESCAPE_MAP:{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"},size:function(e){return e.length?e.length:0},downcase:function(e){return e.toString().toLowerCase()},upcase:function(e){return e.toString().toUpperCase()},capitalize:function(e){return Fera.Liquid.extensions.stringTools.capitalize(e.toString())},escape:function(e){var t=this;return e.replace(/[&<>"']/g,(function(e){return t._HTML_ESCAPE_MAP[e]}))},h:function(e){var t=this;return e.replace(/[&<>"']/g,(function(e){return t._HTML_ESCAPE_MAP[e]}))},default:function(e,t){return Fera.Liquid.extensions.object.isEmpty(e)?t:e},truncate:function(e,t,i){if(!e||""==e)return"";t=t||50,i=i||"...";e.slice(0,t);return e.length>t?e.slice(0,t)+i:e},truncatewords:function(e,t,i){if(!e||""==e)return"";t=parseInt(t||15),i=i||"...";var r=e.toString().split(" "),n=Math.max(t,0);return r.length>n?r.slice(0,n).join(" ")+i:e},truncate_words:function(e,t,i){if(!e||""==e)return"";t=parseInt(t||15),i=i||"...";var r=e.toString().split(" "),n=Math.max(t,0);return r.length>n?r.slice(0,n).join(" ")+i:e},strip_html:function(e){return e.toString().replace(/<.*?>/g,"")},strip_newlines:function(e){return e.toString().replace(/\n/g,"")},join:function(e,t){return t=t||" ",e.join(t)},split:function(e,t){return t=t||" ",e.split(t)},sort:function(e){return e.sort()},reverse:function(e){return e.reverse()},replace:function(e,t,i){return i=i||"",e.toString().replace(new RegExp(t,"g"),i)},replace_first:function(e,t,i){return i=i||"",e.toString().replace(new RegExp(t,""),i)},newline_to_br:function(e){return e.toString().replace(/\n/g,"<br/>\n")},date:function(e,t){var i;return e instanceof Date&&(i=e),i instanceof Date||"now"!=e||(i=new Date),i instanceof Date||"number"!=typeof e||(i=new Date(1e3*e)),i instanceof Date||"string"!=typeof e||(i=new Date(Date.parse(e))),i instanceof Date?i.strftime(t):e},first:function(e){return e[0]},last:function(e){return(e=e)[e.length-1]},minus:function(e,t){return(Number(e)||0)-(Number(t)||0)},plus:function(e,t){return(Number(e)||0)+(Number(t)||0)},times:function(e,t){return(Number(e)||0)*(Number(t)||0)},divided_by:function(e,t){return(Number(e)||0)/(Number(t)||0)},modulo:function(e,t){return(Number(e)||0)%(Number(t)||0)},map:function(e,t){e=e||[];for(var i=[],r=0;r<e.length;r++)i.push(e[r][t]);return i},escape_once:function(e){var t=this;return e.replace(/["><']|&(?!([a-zA-Z]+|(#\d+));)/g,(function(e){return t._HTML_ESCAPE_MAP[e]}))},remove:function(e,t){return e.toString().replace(new RegExp(t,"g"),"")},remove_first:function(e,t){return e.toString().replace(t,"")},prepend:function(e,t){return""+(t||"").toString()+(e||"").toString()},append:function(e,t){return""+(e||"").toString()+(t||"").toString()}}),(new Date).strftime||(Date.ext={},Date.ext.util={},Date.ext.util.xPad=function(e,t,i){for(void 0===i&&(i=10);parseInt(e,10)<i&&i>1;i/=10)e=t.toString()+e;return e.toString()},Date.prototype.locale="en-GB",document.getElementsByTagName("html")&&document.getElementsByTagName("html")[0].lang&&(Date.prototype.locale=document.getElementsByTagName("html")[0].lang),Date.ext.locales={},Date.ext.locales.en={a:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],A:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],b:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],B:["January","February","March","April","May","June","July","August","September","October","November","December"],c:"%a %d %b %Y %T %Z",p:["AM","PM"],P:["am","pm"],x:"%d/%m/%y",X:"%T"},"undefined"!=typeof JSON?Date.ext.locales["en-US"]=JSON.parse(JSON.stringify(Date.ext.locales.en)):Date.ext.locales["en-US"]=Date.ext.locales.en,Date.ext.locales["en-US"].c="%a %d %b %Y %r %Z",Date.ext.locales["en-US"].x="%D",Date.ext.locales["en-US"].X="%r",Date.ext.locales["en-GB"]=Date.ext.locales.en,Date.ext.locales["en-AU"]=Date.ext.locales["en-GB"],Date.ext.formats={a:function(e){return Date.ext.locales[e.locale].a[e.getDay()]},A:function(e){return Date.ext.locales[e.locale].A[e.getDay()]},b:function(e){return Date.ext.locales[e.locale].b[e.getMonth()]},B:function(e){return Date.ext.locales[e.locale].B[e.getMonth()]},c:"toLocaleString",C:function(e){return Date.ext.util.xPad(parseInt(e.getFullYear()/100,10),0)},d:["getDate","0"],e:["getDate"," "],g:function(e){return Date.ext.util.xPad(parseInt(Date.ext.util.G(e)/100,10),0)},G:function(e){var t=e.getFullYear(),i=parseInt(Date.ext.formats.V(e),10),r=parseInt(Date.ext.formats.W(e),10);return r>i?t++:0===r&&i>=52&&t--,t},H:["getHours","0"],I:function(e){var t=e.getHours()%12;return Date.ext.util.xPad(0===t?12:t,0)},j:function(e){var t=e-new Date(e.getFullYear()+"/1/1 GMT");t+=6e4*e.getTimezoneOffset();var i=parseInt(t/6e4/60/24,10)+1;return Date.ext.util.xPad(i,0,100)},m:function(e){return Date.ext.util.xPad(e.getMonth()+1,0)},M:["getMinutes","0"],p:function(e){return Date.ext.locales[e.locale].p[e.getHours()>=12?1:0]},P:function(e){return Date.ext.locales[e.locale].P[e.getHours()>=12?1:0]},S:["getSeconds","0"],u:function(e){var t=e.getDay();return 0===t?7:t},U:function(e){var t=parseInt(Date.ext.formats.j(e),10),i=6-e.getDay(),r=parseInt((t+i)/7,10);return Date.ext.util.xPad(r,0)},V:function(e){var t=parseInt(Date.ext.formats.W(e),10),i=new Date(e.getFullYear()+"/1/1").getDay(),r=t+(i>4||i<=1?0:1);return 53==r&&new Date(e.getFullYear()+"/12/31").getDay()<4?r=1:0===r&&(r=Date.ext.formats.V(new Date(e.getFullYear()-1+"/12/31"))),Date.ext.util.xPad(r,0)},w:"getDay",W:function(e){var t=parseInt(Date.ext.formats.j(e),10),i=7-Date.ext.formats.u(e),r=parseInt((t+i)/7,10);return Date.ext.util.xPad(r,0,10)},y:function(e){return Date.ext.util.xPad(e.getFullYear()%100,0)},Y:"getFullYear",z:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+Date.ext.util.xPad(parseInt(Math.abs(t/60),10),0)+Date.ext.util.xPad(t%60,0)},Z:function(e){return e.toString().replace(/^.*\(([^)]+)\)$/,"$1")},"%":function(){return"%"}},Date.ext.aggregates={c:"locale",D:"%m/%d/%y",h:"%b",n:"\n",r:"%I:%M:%S %p",R:"%H:%M",t:"\t",T:"%H:%M:%S",x:"locale",X:"locale"},Date.ext.aggregates.z=Date.ext.formats.z(new Date),Date.ext.aggregates.Z=Date.ext.formats.Z(new Date),Date.ext.unsupported={},Date.prototype.strftime=function(e){this.locale in Date.ext.locales||(this.locale.replace(/-[a-zA-Z]+$/,"")in Date.ext.locales?this.locale=this.locale.replace(/-[a-zA-Z]+$/,""):this.locale="en-GB");for(var t=this;e.match(/%[cDhnrRtTxXzZ]/);)e=e.replace(/%([cDhnrRtTxXzZ])/g,(function(e,i){var r=Date.ext.aggregates[i];return"locale"==r?Date.ext.locales[t.locale][i]:r}));var i=e.replace(/%([aAbBCdegGHIjmMpPSuUVwWyY%])/g,(function(e,i){var r=Date.ext.formats[i];return"string"==typeof r?t[r]():"function"==typeof r?r.call(t,t):"object"==typeof r&&"string"==typeof r[0]?Date.ext.util.xPad(t[r[0]](),r[1]):i}));return t=null,i}),split=split||function(e){var t,i=String.prototype.split,r=/()??/.exec("")[1]===e;return t=function(t,n,a){if("[object RegExp]"!==Object.prototype.toString.call(n))return i.call(t,n,a);var o,s,c,u,l=[],d=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.extended?"x":"")+(n.sticky?"y":""),p=0;n=new RegExp(n.source,d+"g");for(t+="",r||(o=new RegExp("^"+n.source+"$(?!\\s)",d)),a=a===e?-1>>>0:a>>>0;(s=n.exec(t))&&!((c=s.index+s[0].length)>p&&(l.push(t.slice(p,s.index)),!r&&s.length>1&&s[0].replace(o,(function(){for(var t=1;t<arguments.length-2;t++)arguments[t]===e&&(s[t]=e)})),s.length>1&&s.index<t.length&&Array.prototype.push.apply(l,s.slice(1)),u=s[0].length,p=c,l.length>=a));)n.lastIndex===s.index&&n.lastIndex++;return p===t.length?!u&&n.test("")||l.push(""):l.push(t.slice(p)),l.length>a?l.slice(0,a):l},String.prototype.split=function(e,i){return t(this,e,i)},t}(),Fera.LocalStorageJar=function(e){var t=this;t.localStorageEnabled=!0,e="string"==typeof e?{namespace:e}:e||{};var i=function(){t.cookieJar=e.cookieJar||new Fera.CookieJar,t.namespace=e.namespace||"Fera",t.localStorageEnabled=Fera.Util.checkLocalStorageEnabled()};t.clear=function(){if(!t.localStorageEnabled)return!0;for(var e=Object.keys(window.localStorage),i=0;i<e.length;i++)0===e[i].indexOf(t.namespace)&&window.localStorage.removeItem(e[i])},t.setItem=function(e,i,n){t.localStorageEnabled?(e=r(e),i={value:i,timestamp:n?(new Date).getTime()+n:null},i=Fera.Util.encode(JSON.stringify(i)),window.localStorage.setItem(e,i)):n?t.cookieJar.setCookie(e,i,n/24*60*60*1e3):t.cookieJar.setCookie(e,i)},t.getItem=function(e,i){try{if(e=r(e),i=i||null,t.localStorageEnabled){var n=window.localStorage.getItem(e);return!n&&e.match(/widget/i)&&(n=window.localStorage.getItem(e.replace("Widget","Skill").replace("widget","Skill"))),n?(n=JSON.parse(Fera.Util.decode(n))).timestamp?(new Date).getTime()<n.timestamp?n.value:i:n.value:i}return t.cookieJar.getCookie(e)}catch(e){return null}},t.setObject=function(e,i,r){return t.setItem(e,i,r)},t.getObject=function(e,i){return t.getItem(e,i)},t.removeItem=function(e){e=r(e),t.localStorageEnabled&&(window.localStorage.removeItem(e),window.localStorage.removeItem(e.replace("Fera.","BananaStand.")),window.localStorage.removeItem(e.replace("Fera.","Fera-Fera.")),window.localStorage.removeItem(e.replace("Fera.","Fera.Fera.")),window.localStorage.removeItem(e.replace("Skill","Widget")))};var r=function(e){return""!==t.namespace&&(e=t.namespace+"."+e),e};i()},Fera.Logger=function(e){e=e||{};var t=this;t.logs=[];var i=function(){};t.info=function(){!e.optionsParser.hasUrlFlag("fera_quiet")&&e.debugMode&&window.console&&!Fera.Util.ie()&&("string"==typeof arguments[0]&&(arguments[0]="[Fera.ai] "+arguments[0]),console.info.apply(this,arguments)),window.__feraTestMode&&t.logs.push({type:"info",args:arguments})},t.log=function(){!e.optionsParser.hasUrlFlag("fera_quiet")&&e.debugMode&&window.console&&!Fera.Util.ie()&&("string"==typeof arguments[0]&&(arguments[0]="[Fera.ai] "+arguments[0]),console.log.apply(this,arguments)),window.__feraTestMode&&t.logs.push({type:"log",args:arguments})},t.logWarning=function(){!e.optionsParser.hasUrlFlag("fera_quiet")&&e.debugMode&&window.console&&!Fera.Util.ie()&&("string"==typeof arguments[0]&&(arguments[0]="[Fera.ai] "+arguments[0]),console.warn.apply(this,arguments)),window.__feraTestMode&&t.logs.push({type:"warning",args:arguments})},t.warn=function(){e.optionsParser.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||("string"==typeof arguments[0]&&(arguments[0]="[Fera.ai] "+arguments[0]),console.warn.apply(this,arguments)),window.__feraTestMode&&t.logs.push({type:"warning",args:arguments})},t.error=function(){window.console&&!Fera.Util.ie()&&("string"==typeof arguments[0]&&(arguments[0]="[Fera.ai] "+arguments[0]),console.error.apply(this,arguments)),window.__feraTestMode&&t.logs.push({type:"error",args:arguments})},i()},Fera.OptionsParser=function(e){e=e||{};var t=this,i=function(){t.urlParams=t.getJsonFromUrl(),t.previewMode=t.hasPreviewFilterById(),t.feraParams=n();var i=t.urlParams.fera||t.urlParams.f;i&&e.app.push(i,t.getFeraActionParams()),r()};t.getFeraActionParams=function(){
for(var e=Object.keys(t.feraParams),i={},r=0;r<e.length;r++){var n=e[r];-1===["debug","test","preview","admin","shopper"].indexOf(n)&&(i[n]=t.feraParams[n])}return i},t.getJsonFromUrl=function(e){var t;if(e){var i=location.href.indexOf("?");if(-1==i)return[];t=location.href.substr(i+1)}else t=location.search.substr(1);var r={};return t.split("&").forEach((function(e){if(e&&-1===e.indexOf("__")){var t=(e=e.split("+").join(" ")).indexOf("="),i=t>-1?e.substr(0,t):e,n=t>-1?decodeURIComponent(e.substr(t+1)):"",a=i.indexOf("[");if(-1==a)r[decodeURIComponent(i)]=n;else{var o=i.indexOf("]",a),s=decodeURIComponent(i.substring(a+1,o));i=decodeURIComponent(i.substring(0,a)),r[i]||(r[i]=[]),s?r[i][s]=n:r[i].push(n)}}})),r},t.showContainer=function(e,i){var r=t.urlParams.fera_preview||t.urlParams.preview;return!r||(t.hasPreviewFilterById()?parseInt(r)===i:r===e)},t.getPreviewId=function(){return parseInt(t.urlParams.fera_preview||t.urlParams.preview)},t.hasPreviewFilterById=function(){var e=t.urlParams.fera_preview||t.urlParams.preview;return/^[0-9]+$/i.test(e)},t.hasUrlFlag=function(e){var t=new RegExp("((.*)(([?&])"+e+"=)(t|1|y|true|yes|on))(.*)","i");return-1!==window.location.toString().search(t)},t.hasUrlFlagOff=function(e){var t=new RegExp("((.*)(([?&])"+e+"=)(f|0|n|false|no|off))(.*)","i");return-1!==window.location.toString().search(t)},t.parseTestMode=function(){return t.hasUrlFlag("test_mode")||t.hasUrlFlag("fera_test")?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("TEST Mode activated via URL params."),!0):e.testMode?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("TEST Mode activated via initialization options."),!0):"t"===e.cookieJar.getCookie("Fera.SandboxTest.Enabled")&&(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("TEST Mode activated via sandbox cookie."),!0)},t.parseSandboxMode=function(){return t.hasUrlFlag("fera_sandbox")?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("SANDBOX Mode activated via URL params."),t.extendSandboxCookie(),!0):-1!==["yes","true","1","t","on",!0,1].indexOf(e.cookieJar.getCookie("Fera.SandboxTest.Enabled",!1))?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("SANDBOX Mode activated via sandbox cookie."),!0):void 0},t.extendSandboxCookie=function(){e.cookieJar.setCookie("Fera.SandboxTest.Enabled","t",2/24/60)},t.parseShowErrors=function(){return!!window.feraShowErrors||(!!e.cookieJar.getCookie("Fera.ShowErrors",!1)||t.feraParams.show_errors)},t.parseDebugMode=function(){return!(!window.__bsioDebugMode&&!window.feraDebugMode)||(!!e.cookieJar.getCookie("Fera.DebugMode",!1)||(t.hasUrlFlag("debug_mode")||t.hasUrlFlag("fera_debug")?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("DEBUG Mode activated via URL params."),!0):!!e.debugMode&&(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("DEBUG Mode activated via initialization options."),!0)))},t.parseAdminMode=function(){var i=t.isAdminMode();return e.adminSessionToken=t.urlParams.fera_site_com_token||t.urlParams.fera_admin_session,e.adminSessionToken?e.cookieJar.setCookie("Fera.Admin.SessionToken",e.adminSessionToken,30):e.adminSessionToken=e.cookieJar.getCookie("Fera.Admin.SessionToken"),i},t.parseCheckIntegration=function(){return!(!t.urlParams||!t.urlParams.check_integration_type)&&(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("Integration Checking enabled: "+t.urlParams.check_integration_type),t.urlParams.check_integration_type)},t.detectProductId=function(){return t.urlParams.product||t.urlParams.product_id||t.urlParams.productId||t.urlParams.p||t.feraParams&&(t.feraParams.product||t.feraParams.productId||t.feraParams.product_id||t.feraParams.pid||t.feraParams.p)},t.detectCustomerName=function(){return t.urlParams.customer_name||t.urlParams.customerName||t.urlParams.shopper_name||t.urlParams.shopperName||t.urlParams.name||t.urlParams.customer&&!t.urlParams.customer.match(/@/)&&t.urlParams.customer||t.feraParams&&(t.feraParams.customer_name||t.feraParams.customerName||t.feraParams.shopper_name||t.feraParams.shopperName||t.feraParams.name)},t.detectCustomerEmail=function(){return t.urlParams.customer_email||t.urlParams.customerEmail||t.urlParams.shopper_email||t.urlParams.shopperEmail||t.urlParams.customer&&-1!==t.urlParams.customer.indexOf("@")&&t.urlParams.customer||t.urlParams.email||t.feraParams&&(t.feraParams.customer_email||t.feraParams.customerEmail||t.feraParams.shopper_email||t.feraParams.shopperEmail||t.feraParams.email)};var r=function(){t.sandboxMode=t.parseSandboxMode();var e=window.feraAdminSandboxStatus;t.sandboxStatus=e?parseInt(e):200,t.sandboxError=t.sandboxMode&&t.sandboxStatus>=400},n=function(){for(var e=Object.keys(t.urlParams),i={},r=0;r<e.length;r++){var n=e[r];if(n.match(/^f(era)?_(.+)/i)){var a=n.replace(/^f(era)?_(.+)/i,"$2");i[a]=t.urlParams[n],-1!==["yes","true","1","t","on"].indexOf(i[a])&&(i[a]=!0),-1!==["no","false","","off"].indexOf(i[a])&&(i[a]=!1)}}return i};t.isAdminMode=function(){return!!t.urlParams.show_element_selector||(!!t.urlParams.ensure_loaded_cart||(t.hasUrlFlag("admin_mode")||t.hasUrlFlag("fera_admin")?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("ADMIN Mode activated via URL params."),e.cookieJar.setCookie("Fera.Admin.Enabled","t",1),!0):t.hasUrlFlagOff("admin_mode")||t.hasUrlFlagOff("fera_admin")?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("ADMIN Mode DEactivated via URL params."),e.cookieJar.setCookie("Fera.Admin.Enabled","f",1),!1):"t"===e.cookieJar.getCookie("Fera.Admin.Enabled")?(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("ADMIN Mode active via cookie."),!0):!!e.adminMode&&(t.hasUrlFlag("fera_quiet")||!window.console||Fera.Util.ie()||console.info("ADMIN Mode activated via initialization options."),e.cookieJar.setCookie("Fera.Admin.Enabled","t",1),!0)))},i()},Fera.TimeAgo=function(e){var t,i=this,r=e.language||"en",n=function(){t=o()};this.toSeconds=function(){var e=new Date;return Math.floor((e.getTime()-t.getTime())/1e3)},this.toDays=function(){var e=this.toSeconds();return Math.floor(e/60/60/24)},this.toString=function(){var e,t=i.toSeconds();return(e=a(t,31536e3,"year"))||(e=a(t,2628e3,"month"))||(e=a(t,604800,"week"))||(e=a(t,86400,"day"))||(e=a(t,3600,"hour"))||(e=a(t,60,"minute"))?e:e=a(Math.max(t,1),1,"second")};var a=function(e,t,i){if(e/t>=1){var n=Math.round(e/t);try{var a=new Intl.RelativeTimeFormat(r,{numeric:"always"});return n*=-1,a.format(n,i)}catch(e){var o=n>1?"{{ num }} "+i+"s ago":"{{ num }} "+i+" ago";return Fera.t(o).replace("{{ num }}",n)}}return!1},o=function(){if("string"==typeof e.time){var t;t=e.time.indexOf("Z")===e.time.length-1?e.time.replace("Z"," GMT").replace("T"," ").replace(".000","").replace(/-/g,"/"):e.time;var r=Date.parse(t);return r||(r=(new Date).getTime()-36e5,Fera.logger.error("Failed to parse time: ",e.time,e,i)),new Date(r)}return e.time};n()},Fera.TimeTracker=function(e){var t=this;e=e||{};var i=3e4,r=0,n=1e3,a=!1,o=!1,s="default-page-name",c=[],u=[],l=[],d={},p=0,h={},f=function(){h=e.localStorage;var t=i||30,r=r||window.location.pathname;t=e.idleTimeoutInSeconds||t,r=e.currentPageName||r,m(),I(),A(t),E(r),B(),x(),setInterval(L,1e3)},m=function(){t.data=h.localStorageEnabled?h.getObject("TimeTracker",{}):{}};t.getTimeOnCurrentPage=function(){return T($(s))},t.getSessionTime=function(){var e=v()||(new Date).getTime();return Math.round(((new Date).getTime()-e)/1e3)},t.getTotalInteractionTime=function(){return Math.round(parseFloat(g()||0))},t.setTotalInteractionTime=function(e){y(e)},t.getTimeSinceFirstSeen=function(){var e=0;return t.data.timeFirstSeen&&(e=(new Date).getTime()-t.data.timeFirstSeen),T(e)},t.setTimeFirstSeen=function(e){w(e)},t.setTimeSinceFirstSeen=function(e){w((new Date).getTime()-1e3*e)},t.reset=function(){F(),h.removeItem("TimeTracker"),d={},x()};var g=function(){return t.data.totalInteractionTime||0},v=function(){var e=new Date;return t.data.sessionStartTime||e.getTime()},_=function(){var e=new Date;return t.data.sessionLastUpdateTime||e.getTime()},w=function(e){t.data.timeFirstSeen=e,S()},y=function(e){t.data.totalInteractionTime=e,S()},b=function(e){t.data.sessionStartTime=e,S()},C=function(e){t.data.sessionLastUpdateTime=e,S()},S=function(){h.setObject("TimeTracker",t.data)},x=function(e){if(e||(e=s),void 0===d[e])d[e]=[];else{var t=d[e],i=t[t.length-1];if(void 0!==i&&void 0===i.stopTime)return}d[e].push({startTime:new Date,stopTime:void 0}),a=!0},F=function(){for(var e=Object.keys(d),t=0;t<e.length;t++)k(e[t])},k=function(e){e||(e=s);var t=d[e];void 0!==t&&0!==t.length&&(void 0===t[t.length-1].stopTime&&(t[t.length-1].stopTime=new Date),a=!1)},T=function(e){return void 0===e?void 0:Math.round(e/1e3)},$=function(e){var t=d[e];if(void 0!==t){for(var i=0,r=0;r<t.length;r++){var n=t[r].startTime,a=t[r].stopTime;void 0===a&&(a=new Date),i+=a-n}return Number(i)}};t.getInactiveTimeOnPage=function(){var e=d[s];if(void 0===e||e.length<1)return 0;var t=e[e.length-1].stopTime;return t?T(Number(new Date-t)):0};var P,R,I=function(){if(!t.data.timeFirstSeen){var e=Math.max(t.getTimeSinceFirstSeen()||0,t.getTotalInteractionTime()||0,t.getTimeOnCurrentPage()||0,t.getSessionTime()||0);w((new Date).getTime()-1e3*e)}},A=function(e){var r=parseFloat(e);if(!1!==isNaN(r))throw{name:"InvalidDurationException",message:"An invalid duration time ("+e+") was provided."};return i=1e3*e,t},E=function(e){return s=e,t},M=function(){if(a){var e=t.getTimeOnCurrentPage(),i=e-p;if(!(i<=.1)){var r=t.getTotalInteractionTime();return y(r+=i),p=e,r}}},L=function(){var e=_(),i=(new Date).getTime();!t.data.sessionStartTime||i-e>3e3?b(i):i-(v()||i)>864e5&&b(i);C(i)},O=function(){o&&D(),o=!1,r=0},D=function(){if(!a)for(var e=0;e<l.length;e++){var t=l[e],i=t.numberOfTimesToInvoke;(isNaN(i)||void 0===i||i>0)&&(t.numberOfTimesToInvoke-=1,t.callback())}x()},q=function(){if(a)for(var e=0;e<u.length;e++){var t=u[e],i=t.numberOfTimesToInvoke;(isNaN(i)||void 0===i||i>0)&&(t.numberOfTimesToInvoke-=1,t.callback())}F()},j=function(){for(var e=M(),t=0;t<c.length;t++)c[t].pending&&e>c[t].timeInSeconds&&(c[t].callback(),c[t].pending=!1);!1===o&&r>i?(o=!0,q()):r+=n},B=function(){void 0!==document.hidden?(R="hidden",P="visibilitychange"):void 0!==document.mozHidden?(R="mozHidden",P="mozvisibilitychange"):void 0!==document.msHidden?(R="msHidden",P="msvisibilitychange"):void 0!==document.webkitHidden&&(R="webkitHidden",P="webkitvisibilitychange"),document.addEventListener(P,(function(){document[R]?q():D()}),!1),window.addEventListener("blur",(function(){q()})),window.addEventListener("focus",(function(){D()})),document.addEventListener("mousemove",(function(){O()})),document.addEventListener("keyup",(function(){O()})),document.addEventListener("touchstart",(function(){O()})),window.addEventListener("scroll",(function(){O()})),setInterval(j,n)};t.callAfterTimeElapsedInSeconds=function(e,t){c.push({timeInSeconds:e,callback:t,pending:!0})},t.callWhenUserLeaves=function(e,t){u.push({callback:e,numberOfTimesToInvoke:t})},t.callWhenUserReturns=function(e,t){l.push({callback:e,numberOfTimesToInvoke:t})},f()},Fera.Util={toTitleCase:function(e){return e.replace(/\w\S*/g,(function(e,t,i){return e.indexOf(".")>0&&e.indexOf(".")<e.length-1||e.length<=3&&(","===e.trim().substr(-1)||e.length+t===i.length)&&(t>0&&","===i.substr(t-1,1)||t>1&&","===i.substr(t-2,1))?e.toUpperCase():e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))},checkLocalStorageEnabled:function(){try{if(window.localStorage.setItem("test","test"),"test"!==window.localStorage.getItem("test"))return!1;window.localStorage.removeItem("test")}catch(e){return!1}return!0},truncateTextToMaxWidth:function(e){var t=this.$();e.each((function(){var e=t(this),i=parseFloat(e.css("max-width"));if(e.width()>i)for(var r=e.html().trim();e.width()>i;)r=r.slice(0,-1),e.html(r+"...")}))},debounce:function(e,t,i){var r;return function(){var n=this,a=arguments;clearTimeout(r),r=setTimeout((function(){r=null,i||e.apply(n,a)}),t),i&&!r&&e.apply(n,a)}},throttle:function(e,t,i){var r,n;return function(){var a=this,o=arguments,s=(new Date).getTime();if(!n||s>n+t)return n=(new Date).getTime(),e.apply(a,o);i&&(r=r||setTimeout((function(){r=null,n=(new Date).getTime(),e.apply(a,o)}),t-(s-n)))}},generateUUID:function(){var e=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?i:3&i|8).toString(16)}))},isFullyVisible:function(e){return this._checkVisibility(e,!0)},isVisible:function(e){return this._checkVisibility(e,!1)},_checkVisibility:function(e,t){if(e.data("always_visible"))return!0;if((Object&&Object.getPrototypeOf?Object.getPrototypeOf(e).jquery:$&&$.zepto)&&!e.is(":visible"))return!1;if(t&&!this.isScrolledIntoView(e))return!1;if("none"==e.css("display")||"hidden"==e.css("visibility")||0==e.css("opacity"))return!1;for(var i=e.parent();"BODY"!==i.prop("tagName");){if("hidden"==i.css("visibility")||0==i.css("opacity"))return!1;i=i.parent()}return!0},parseBool:function(e){return void 0!==e&&-1!==[1,"1","true","t","yes",!0,2].indexOf(e)},outerHeight:function(e){var t,i,r=e.get(0);if(navigator&&navigator.appVersion&&-1!==navigator.appVersion.indexOf("MSIE 9.")){var n=r.offsetHeight,a=getComputedStyle(r);return n+parseInt(a.marginTop)+parseInt(a.marginBottom)}return void 0!==r.offsetHeight?r.offsetHeight:("number"!=typeof(t=document.defaultView.getComputedStyle(r,"").getPropertyValue("height"))&&(t=0),i=parseInt(document.defaultView.getComputedStyle(r,"").getPropertyValue("margin-top"))+parseInt(document.defaultView.getComputedStyle(r,"").getPropertyValue("margin-bottom")),parseFloat(t)+parseFloat(i))},isHome:function(){return-1===window.location.toString().replace(/^https?:\/\/([a-zA-Z0-9_\-.]+)(\/(af|agq|ak|am|ar|as|asa|ast|az|bas|be|bem|bez|bg|bm|bn|bo|br|brx|bs|ca|ccp|ce|cgg|chr|ckb|cs|cy|da|dav|de|dje|dsb|dua|dyo|dz|ebu|ee|el|en|es|et|eu|ewo|fa|ff|fi|fil|fo|fr|fur|fy|ga|gd|gl|gsw|gu|guz|gv|ha|haw|he|hi|hr|hsb|hu|hy|id|ig|ii|is|it|ja|jgo|jmc|ka|kab|kam|kde|kea|khq|ki|kk|kkj|kl|kln|km|kn|ko|kok|ks|ksb|ksf|ksh|kw|ky|lag|lb|lg|lkt|ln|lo|lrc|lt|lu|luo|luy|lv|mas|mer|mfe|mg|mgh|mgo|mk|ml|mn|mr|ms|mt|mua|my|mzn|naq|nb|nd|nds|ne|nl|nmg|nn|nnh|nus|nyn|om|or|os|pa|pl|ps|pt|qu|rm|rn|ro|rof|ru|rw|rwk|sah|saq|sbp|se|seh|ses|sg|shi|si|sk|sl|smn|sn|so|sq|sr|sv|sw|ta|te|teo|tg|th|ti|to|tr|tt|twq|tzm|ug|uk|ur|uz|vai|vi|vun|wae|wo|xog|yav|yi|yo|yue|zgh|zh|zu)(-[A-Z]{2,4}){0,2})?\/?([?#][#a-z=\-_A-Z0-9&]+)?$/i,"$1").indexOf("/")},updateURLParameter:function(e,t,i){var r="",n=e.split("?"),a=n[0],o=n[1],s="";if(o){n=o.split("&");for(var c=0;c<n.length;c++)n[c].split("=")[0]!=t&&(r+=s+n[c],s="&")}var u=a+"?"+r;return null!==i&&(u+=s+t+"="+i),u===a+"?"?a:u},isScrolledIntoView:function(e){var t=Fera.Util.$()(window).scrollTop(),i=t+Fera.Util.$()(window).height(),r=e.offset().top;return r+e.height()<=i&&r>=t},scrollToElement:function(e,t){(t="object"==typeof t?t:{}).duration=void 0===t.duration?200:t.duration,t.callback=t.callback||function(){},t.position=void 0===t.position?"center":t.position;var i,r=Fera.Util.$()(window),n=t.duration,a=window.innerHeight||r.height(),o=Fera.Util.outerHeight(e),s=e[0],c=10,u=(new Date).getTime();const l=e.parents(".cc-tabs__tab__panel[hidden]");l.length>0&&l.siblings(".cc-tabs__accordion__header").first().click();var d=function(){var i=e.offset().top;return"center"===t.position&&o<a&&(i-=a/2,i+=o/2),i},p=function(){var e=s.getBoundingClientRect();return document.elementFromPoint(e.left,e.top)!==s},h=function(e){var t=f(e);r.scrollTop(t)},f=function(e){var t,i,r,n=1e3;r=(t=s.getBoundingClientRect()).top,i=document.elementFromPoint(t.left,r);var a,o=s.contains(i);for(a=0;!o&&a<n;a++)r+=1,i=document.elementFromPoint(t.left,r),o=s.contains(i);return a==n&&Fera.logger.warn("Warning: Maximum scroll distance was reached when scrolling past overlaid elements"),e-r},m=setInterval((function(){if(i=(new Date).getTime(),n-=c=i-u,!e.offset()||0===e.offset().top)return clearInterval(m),t.callback(e);var a=d();if(n<=0)return r.scrollTop(a),clearInterval(m),p()&&setTimeout((()=>h(a)),a>2e3?1e3:1),t.callback(e);var o,s=r.scrollTop()-a;o=t.duration-n<100?s/(n/c*2):n<100?s/(n/c):s/((n-50)/c),r.scrollTop(r.scrollTop()-o),u=(new Date).getTime()}),10)},$:function(){return void 0!==window.F$?window.F$:this._$&&"function"==typeof this._$?this._$:this._hasValidJQueryInstalled()?this._$=jQuery:this._$=F$},_hasValidJQueryInstalled:function(){return!("undefined"==typeof jQuery||!jQuery.fn||!jQuery.fn.jquery||this._isUsingIncompatibleJQuery())},_isUsingIncompatibleJQuery:function(){return"undefined"!=typeof jQuery&&jQuery&&jQuery.fn&&(-1!==jQuery.fn.jquery.indexOf("-ajax")||jQuery.fn.jquery.match(/1\.[0-9]\./))},showWithoutTransform:function(e){e.show().css({"-webkit-transform":"","-moz-transform":"","-ms-transform":"","-o-transform":"",transform:""})},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},shuffleArray:function(e){var t,i,r;for(r=e.length-1;r>0;r--)t=Math.floor(Math.random()*(r+1)),i=e[r],e[r]=e[t],e[t]=i;return e},isNullOrEmpty:function(e){return!e||void 0===e||""===e||0===e.length},maxGetRequestChars:function(){return-1!==this.detectBrowser().indexOf("MSIE")?2e3:6e3},sizeOfParams:function(e){return encodeURI(Fera.Util.$().param(e)).split(/%..|./).length-1},_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,i,r,n,a,o,s,c="",u=0;for(e=this._utf8_encode(e);u<e.length;)n=(t=e.charCodeAt(u++))>>2,a=(3&t)<<4|(i=e.charCodeAt(u++))>>4,o=(15&i)<<2|(r=e.charCodeAt(u++))>>6,s=63&r,isNaN(i)?o=s=64:isNaN(r)&&(s=64),c=c+this._keyStr.charAt(n)+this._keyStr.charAt(a)+this._keyStr.charAt(o)+this._keyStr.charAt(s);return c},decode:function(e){var t,i,r,n,a,o,s="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)t=this._keyStr.indexOf(e.charAt(c++))<<2|(n=this._keyStr.indexOf(e.charAt(c++)))>>4,i=(15&n)<<4|(a=this._keyStr.indexOf(e.charAt(c++)))>>2,r=(3&a)<<6|(o=this._keyStr.indexOf(e.charAt(c++))),s+=String.fromCharCode(t),64!=a&&(s+=String.fromCharCode(i)),64!=o&&(s+=String.fromCharCode(r));return s=this._utf8_decode(s)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var r=e.charCodeAt(i);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},_utf8_decode:function(e){for(var t="",i=0,r=0,n=0,a=0;i<e.length;)(r=e.charCodeAt(i))<128?(t+=String.fromCharCode(r),i++):r>191&&r<224?(n=e.charCodeAt(i+1),t+=String.fromCharCode((31&r)<<6|63&n),i+=2):(n=e.charCodeAt(i+1),a=e.charCodeAt(i+2),t+=String.fromCharCode((15&r)<<12|(63&n)<<6|63&a),i+=3);return t},jsonHasArray:function(e){for(var t in e)if(e[t]&&"object"==typeof e[t]&&e[t].constructor===Array)return!0;return!1},httpMethodToUse:function(e){return this.sizeOfParams(e)>this.maxGetRequestChars()||this.jsonHasArray(e)?"POST":"GET"},onRemove:function(e,t){var i=Fera.Util.$()(e),r=new MutationObserver((function(){var e=function(t){return t.parentNode!==document&&(null===t.parentNode||void 0===t.parentNode||e(t.parentNode))};e(i[0])&&(r.disconnect(),t(i))}));r.observe(document,{childList:!0,subtree:!0});var n=i.data("removeObservers")||[];return n.push(r),i.data("removeObservers",n),r},disconnectRemoveHandlers:function(e){var t=Fera.Util.$()(e),i=t.data("removeObservers");return!!i&&(Fera.Util.$().each(i,(function(e,t){t.disconnect()})),t.data("removeObservers",[]),!0)},abbreviateNumber:function(e,t){if(null===e)return null;if(0===e)return"0";t=!t||t<0?0:t;var i=e.toPrecision(2).split("e"),r=1===i.length?0:Math.floor(Math.min(i[1].slice(1),14)/3),n=r<1?e.toFixed(0+t):(e/Math.pow(10,3*r)).toFixed(1+t);return(n<0?n:Math.abs(n))+["","K","M","B","T"][r]},arrayToSentence:function(e){return 0===e.length?"":1===e.length?e[0]:e.slice(0,-1).join(", ")+" and "+e[e.length-1]},htmlDecode:function(e){try{return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent}catch(t){return e}},detectBrowser:function(){var e,t=navigator.userAgent,i=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(i[1])?"IE "+((e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""):"Chrome"===i[1]&&null!=(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&i.splice(1,1,e[1]),i.join(" "))},ie:function(){return 0===this.detectBrowser().indexOf("IE")||-1!==this.detectBrowser().indexOf("MSIE")},isBot:function(){return void 0!==this._isBot?this._isBot:window&&window.location&&window.location.toString().match(/localhost|127\.0\.0\.1|samplesnek|(test|example|dev)-?(store|shop)|(store|shop)-?(test|example|dev)/)||"undefined"==typeof navigator?this._isBot=!1:navigator.webdriver?this._isBot=!0:navigator.userAgent?this._isBot=!!/bot|googlebot|crawl|spider|robot|headless/i.test(navigator.userAgent):this._isBot=!1},setIsBot:function(e){return this._isBot=e,this},isSpeedMode:function(){return void 0!==this._isSpeedMode||(window&&window.location&&window.location.toString().match(/localhost|127\.0\.0\.1|samplesnek|(test|example|dev)-?(store|shop)|(store|shop)-?(test|example|dev)/)?this._isSpeedMode=!1:navigator&&navigator.webdriver?this._isSpeedMode=!0:"undefined"!=typeof navigator&&navigator.userAgent?this._isSpeedMode=!!navigator.userAgent.match(/lighthouse|metrix|(speed.*test)|pingdom/i):this._isSpeedMode=!1),this._isSpeedMode},setIsSpeedMode:function(e){return this._isSpeedMode=e,this}},Fera.VariantLoader=function(e){var t=this;e=e||{};var i=Fera.Util.$(),r=function(){t.$form=i('form[action~="/cart/add"]'),t.variantId=null,t.loadVariant(),t.$form.find("select,input,textarea").on("change",(function(){setTimeout((function(){t.loadVariant(!0)}),1)})),t.onUrlChange((function(){t.loadVariant(!0)}))};t.onUrlChange=function(e){i(window).on("hashchange",e);var t=window.location.toString();setInterval((function(){var i=window.location.toString();i!==t&&(t=i,e())}),100)},t.loadVariant=function(i){void 0===i&&(i=!1),t.findVariantId(),e.app.getVariantId()!==t.variantId&&(e.app.setVariantId(t.variantId),i&&e.app.refreshContent())},t.findVariantId=function(){if(t.variantId=n(),t.variantId&&""!==t.variantId)return t.variantId;var i=t.$form.serializeArray().find((function(e){return"id"===e.name}));if(i)return t.variantId=i.value,t.variantId;var r=e.app.getProduct();return r?r.variants[0].id:null};var n=function(){var e=/variant=(.*?)(&|$)/,t=window.location.href.match(e);return t?parseInt(t[1]):null};r()},Fera.Verifier=class{constructor(e){this._opts=e,this.$=Fera.Util.$(),this._skillSelectorsToVerify=[],this._popovers=[],this.app=this._opts.app,this._opts.app.on("widget.create",this._onSkillCreate.bind(this)),this._opts.app.on("notification.show",this._onNotifShow.bind(this)),this._opts.debugMode&&(window.verifier=this)}_onSkillCreate(e){e.settings&&e.settings.show_verification&&e.$el&&(e.$el.length<1||("product_detail_counter"!=e.type||e.$el.is(".fera-recentOrderCount")?"product_list_counter"==e.type&&this._skillSelectorsToVerify.push(e.$el):this._skillSelectorsToVerify.push(e.$el.find(".banana-sentence,.fera-sentence")),this._attachPopovers()))}addVerificationIcon(e,t={}){const i=this.$(this.constructor._iconTpl(t));return e.append(i),this._attachPopover(e),i}addVerificationPopover(e){return this._attachPopover(e),e}_attachPopovers(){this._skillSelectorsToVerify.forEach((e=>{this.$(e).each(((e,t)=>{this._attachPopover(this.$(t))}))}))}_onNotifShow(e){e.settings.show_verification&&this.addNotifIcon(e.popup.$el)}addNotifIcon(e){this._loadAssets((()=>{this._notifIcon=new Fera.Verification.Icon({$target:e.find(".fera-event-time-ago"),iconTpl:this.constructor._iconTpl()}),this._notifIcon.show()}))}_attachPopover(e){e.data("fera-verifier-attached")||e.on("mouseenter",(()=>{this._loadAssets((()=>{if(e.data("fera-verifier-attached"))return;const t=new Fera.Verification.Popover(e);if(t.show(),this._popovers.push(t),this._popovers.length>1){let e=this._popovers.map((e=>e.getInstance()));e=e.filter((e=>e)),this._popovers[0].createOrUpdateSingleton(e)}e.addClass("fera-verified"),e.data("fera-verifier-attached",!0)}))}))}_setupListeners(){var e;new MutationObserver((t=>{t.forEach((t=>{t.addedNodes&&(e||(e=setTimeout((()=>{clearTimeout(e),this._attachPopovers()}),10)))}))})).observe(document.body,{childList:!0,subtree:!0,attributes:!1,characterData:!1})}_loadAssets(e){return e=e||(()=>{}),this._loadedAssets?e():this._loadingAssets?setTimeout((()=>this._loadAssets(e)),50):(this._loadingAssets=!0,void("undefined"!=typeof requirejs?require(["https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js"],(t=>{window.Popper=t,this._loadFeraVerificationAsset(e)})):this._loadFeraVerificationAsset(e)))}_loadFeraVerificationAsset(e){var t="";t=this._opts.api.baseAppPath&&this._opts.api.baseAppPath.match(/((test|ngrok|localhost|dev|development)[.-]|127\.0\.0\.1)/i)?this._opts.api.baseAppPath+"/assets/public/fera.verification.js?v="+this.app.version:`https://cdn.fera.ai/js/fera.verification.js?v=${this.app.version}`;var i=this._opts.debugMode?1:900;new FeraCachedAsset({name:"Fera.Verification.Js",url:t,expiresIn:i}).load((()=>{try{this._setupListeners(),this._loadedAssets=!0,this._loadingAssets=!1,e()}catch(e){if(this._opts.debugMode)throw e}}))}static _iconTpl(e={}){return`<svg height="${e.height||16}" viewBox="0 0 28 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="fera-validation-icon fera-validation-icon--sm">\n            <path d="M8.08787 1.53793C8.08787 2.38731 7.39477 3.07586 6.53979 3.07586C5.68481 3.07586 4.99171 2.38731 4.99171 1.53793C4.99171 0.688554 5.68481 0 6.53979 0C7.39477 0 8.08787 0.688554 8.08787 1.53793Z" fill="#EF4323" class="fera-verification-icon-sm-1"></path>\n            <path d="M16.3635 1.66374C16.3635 2.51312 15.6704 3.20167 14.8155 3.20167C13.9605 3.20167 13.2674 2.51312 13.2674 1.66374C13.2674 0.814365 13.9605 0.125811 14.8155 0.125811C15.6704 0.125811 16.3635 0.814365 16.3635 1.66374Z" fill="#EF4323" class="fera-verification-icon-sm-2"></path>\n            <path d="M20.5 5.54887C20.5 6.39825 19.8069 7.0868 18.9519 7.0868C18.0969 7.0868 17.4038 6.39825 17.4038 5.54887C17.4038 4.69949 18.0969 4.01094 18.9519 4.01094C19.8069 4.01094 20.5 4.69949 20.5 5.54887Z" fill="#EF4323" class="fera-verification-icon-sm-3"></path>\n            <path d="M3.54806 5.44971C3.54806 6.29908 2.85496 6.98763 1.99998 6.98763C1.145 6.98763 0.451904 6.29908 0.451904 5.44971C0.451904 4.60033 1.145 3.91178 1.99998 3.91178C2.85496 3.91178 3.54806 4.60033 3.54806 5.44971Z" fill="#EF4323" class="fera-verification-icon-sm-4"></path>\n            <path d="M12.3526 5.54888C12.3526 6.39826 11.6595 7.08681 10.8045 7.08681C9.94953 7.08681 9.25643 6.39826 9.25643 5.54888C9.25643 4.6995 9.94953 4.01095 10.8045 4.01095C11.6595 4.01095 12.3526 4.6995 12.3526 5.54888Z" fill="#EF4323" class="fera-verification-icon-sm-5"></path>\n            <path d="M6.64421 10.5C6.64421 11.3494 5.95111 12.0379 5.09614 12.0379C4.24116 12.0379 3.54806 11.3494 3.54806 10.5C3.54806 9.65062 4.24116 8.96207 5.09614 8.96207C5.95111 8.96207 6.64421 9.65062 6.64421 10.5Z" fill="#EF4323" class="fera-verification-icon-sm-6"></path>\n            <path d="M12.3526 14.4621C12.3526 15.3115 11.6595 16 10.8045 16C9.94953 16 9.25643 15.3115 9.25643 14.4621C9.25643 13.6127 9.94953 12.9241 10.8045 12.9241C11.6595 12.9241 12.3526 13.6127 12.3526 14.4621Z" fill="#EF4323" class="fera-verification-icon-sm-7"></path>\n            <path d="M19 5.5L14.8155 1.53796L10.8045 6L6.34792 1.53796L2 5.5L5 10.5L10.8045 14.4621" stroke="#EF4323" class="fera-verification-icon-sm-8"></path>\n            <path d="M13.5872 9.66042L18.0438 14.4621L27 5" stroke="#00C48D" stroke-width="2" stroke-linejoin="round" class="fera-verification-icon-sm-9"></path>\n        </svg>`}},Fera.VideoViewer=class{init(e){this.$=Fera.Util.$(),this.$el=this.$(this.selector),this.$el.length<1&&(this._render(),this.$el=this.$(this.selector),this.$el.find(".fera-videoViewer-container").on("click",this._hide.bind(this))),e.on("click",this._show.bind(this))}get selector(){return".fera-videoViewer-overlay"}_videoType(e){const t={youtube:/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube\.com|youtu\.be))(\/(?:[\w-]+\?v=|embed\/|v\/)?)([\w-]+)(\S+)?$/,facebook:/^(?:(?:https?:)?\/\/)?(?:(www|web|m)\.)?(facebook|fb)\.com\/[a-zA-Z0-9.]+\/videos\/(?:[a-zA-Z0-9.]+\/)?([0-9]+)/,vimeo:/(http|https)?:\/\/(www\.|player\.)?vimeo\.com\/(?:(channels|video)\/(?:\w+\/)?|groups\/([^/]*)\/videos\/|)(\d+)(?:|\/\?)/,instagram:/(https?:\/\/(?:www\.)?instagram\.com\/p\/([^/?#&]+)).*/};return t.youtube.test(e)?"youtube":t.vimeo.test(e)?"vimeo":t.instagram.test(e)?"instagram":"url"}_show(e){let t=this.$(e.target).clone().removeClass();if(t.data("videoUrl")){const e=t.data("videoUrl"),i=this._videoType(e);t="url"!==i?this.$(this.setImportedVideoTpl(e,i)):this.$(`<video src="${e}" controls>`)}const i=this.$('<a href="#" class="fera-videoViewer-close-btn">&times;</a>');this.$el.removeClass("fera-hidden"),this.$el.find(".fera-videoViewer").html(t.attr("controls",!0)),this.$el.find(".fera-videoViewer").append(i),this.$("body").addClass("fera-modal--open"),i.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this._hide()})),this.$(document).on("keydown",(e=>{27===(e.keyCode||e.which)&&this._hide()})),e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation())}setImportedVideoTpl(e,t){const i=this._prepareImportedVideoUrl(e,t);return["youtube","vimeo","instagram"].includes(t)?`<iframe src="${i}" width="640" height="480"\n                    frameborder="0" allow="accelerometer; autoplay; picture-in-picture"\n                    allowfullscreen></iframe>`:`<video src="${i}" controls>`}_prepareImportedVideoUrl(e,t){if("url"===t)return e;({youtube:/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube\.com|youtu\.be))(\/(?:[\w-]+\?v=|embed\/|v\/)?)([\w-]+)(\S+)?$/,facebook:/^(?:(?:https?:)?\/\/)?(?:(www|web|m)\.)?(facebook|fb)\.com\/[a-zA-Z0-9.]+\/videos\/(?:[a-zA-Z0-9.]+\/)?([0-9]+)/,vimeo:/(http|https)?:\/\/(www\.|player\.)?vimeo\.com\/(?:(channels|video)\/(?:\w+\/)?|groups\/([^/]*)\/videos\/|)(\d+)(?:|\/\?)/,instagram:/(https?:\/\/(?:www\.)?instagram\.com\/p\/([^/?#&]+)).*/})[t].test(e);return"youtube"===t?e=`https://www.youtube.com/embed/${RegExp.$5}`:"vimeo"===t?e=`https://player.vimeo.com/video/${RegExp.$5}`:"instagram"===t&&(e=`https://www.instagram.com/p/${RegExp.$2}/embed`),e}_hide(e){if(e){if(!this.$(e.target).is(".fera-videoViewer-container"))return}var t=this.$el.find("video");t.length>0&&t[0].pause(),this.$el.addClass("fera-hidden"),this.$("body").removeClass("fera-modal--open"),e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation())}_render(){this.$("body").append(this._tpl()).append(`<style>${this._css()}</style>`)}_tpl(){return'\n<div class="fera-videoViewer-overlay fera-hidden">\n    <div class="fera-videoViewer-container">\n        <div class="fera-videoViewer"></div>\n    </div>\n</div>\n        '}_css(){return"\n.fera-modal--open {\n    overflow: hidden !important;\n}\n\n.fera-hidden {\n    display: none !important;\n}\n\n.fera-videoViewer-overlay {\n    position: fixed;\n    background: rgba(0,0,0,0.4);\n    z-index: 9999999;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n}\n\n.fera-videoViewer-container {\n    height: 100vh;\n    width: 100vw;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.fera-videoViewer {\n    max-width: 900px;\n    position: relative;\n    margin: 15px;\n}\n\n.fera-videoViewer-close-btn {\n    color: #000000;\n    font-weight: 100;\n    font-size: 1.5rem;\n    line-height: 0.75rem;\n    position: absolute;\n    right: 14px;\n    top: 14px;\n}\n\n.fera-videoViewer video {\n    width: 100% !important;\n    max-height: 100vh;\n}\n\n.fera-videoViewer-viewable {\n    cursor: pointer;\n}\n        "}},Fera.BaseContainer=function(e){e=e||{};var t=this,i=Fera.Util.$();t.id=e.id;var r=function(){t.$container=e.el,t.dataAttr=n(t.$container)};this.dispatchEvent=function(e,i,r){r=r||function(){},t.each((function(t){"function"==typeof t.dispatchEvent&&t.dispatchEvent(e,i,r)}))},this.selector=function(){return t.$container},this.hasDataAttr=function(e){return t.dataAttr[e]&&""!=t.dataAttr[e]},this.getDataAttr=function(e){return t.dataAttr[e]};var n=function(e){var t={},r=/^data-(.+)$/
;return i.each(e.get(0).attributes,(function(e,i){if(r.test(i.nodeName)){var n=i.nodeName.match(r)[1];t[n]=i.nodeValue}})),t};r()},Fera.ContainerCollection=function(e){e=e||{};var t,i=this,r=Fera.Util.$(),n=[],a=0,o=!1,s=function(){i.locateNewContainers(),c()};this.startWatchingForChanges=function(){setTimeout((function(){m(),l()}),100)},this.updateContentFromCache=function(){i.globalBottom&&i.globalBottom.updateContentFromCache()},this.locateNewContainers=function(){var t=[];return r(".banana-container").each((function(){var a=e;if(a.el=r(this),!a.el.data("bsio-container-id")){var o=Fera.ContainerFactory.create(a.el.data("container_type"),a);o&&(n.push(o),t.push(o),o.constructor===Fera.GlobalBottomContainer&&(i.globalBottom=o))}})),i.length=n.length,t},this.triggerWidget=function(e,t){this.each((function(i){void 0!==i.triggerWidget&&i.triggerWidget(e,t)}))},this.triggerSkill=this.triggerWidget;var c=function(){i.length>20&&(o=!0)};this.size=function(){return n.length},this.updateContent=function(t,r,n){if(n=n||function(){},!t.content_responses)return e.logger.logWarning("Content responses result was empty so content couldn't be updated.",t),n();for(var a=t.content_responses.length,o=0,s=function(){o++},c=Date.now(),u=setInterval((function(){(o>=a||Date.now()-c>1e4)&&(clearInterval(u),u=null,n())}),1),l=0;l<t.content_responses.length;l++){var d=t.content_responses[l];if(d){var p=i.getContainerById(d.container_id);if(!p){s();continue}try{p.updateContent(d,s)}catch(t){e.logger.error(t),s()}p.needsUpdate=!1}else e.logger.logWarning("Fera did not receive persistent content for container so nothing was displayed for that container.",d),s()}},this.markAllContainersAsDirty=function(){n&&i.each((function(e){e.needsUpdate=!0}))},this.getContainerById=function(e){for(var t=0;t<n.length;t++)if(n[t].id==e)return n[t];return null},this.getContentRequest=function(e,t){for(var i=[],r=void 0===t?n:t,a=0;a<r.length;a++){var o=r[a];if(o.needsUpdate){if(u(o))continue;var s=o.getContentRequest(e);if(!s){o.needsUpdate=!1;continue}s.container_id=o.id,i.push(s)}}return i};var u=function(e){return!!o&&(!e.isVisible()&&!e.alwaysVisible&&(a/1e3<(new Date).getTime()/1e3-60&&(a=(new Date).getTime()),!0))};this.each=function(e){for(var t=0;t<n.length;t++)e(n[t],t);return this},this.find=function(e){for(var t=0;t<n.length;t++)if(e(n[t],t))return n[t];return null},this.toArray=function(){return n},this.indexOf=function(e){for(var t="number"==typeof e?e:e.id,i=0;i<n.length;i++)if(n[i].id==t)return i;return-1},this.removeByIndex=function(t){return n[t]?n.splice(t,1):(e.logger.logWarning("Could not remove container at index because it does not exist.",t),null)},this.remove=function(e){return i.removeByIndex(i.indexOf(e))},this.removeAll=function(e){for(var t=0;t<e.length;t++)i.remove(e[t]);return e},this.forceRefresh=function(){f(),i.globalBottom.needsUpdate=!0;var e=i.getContentRequest({});i.updateContainers(!1,(function(){m()}),e)},this.refresh=Fera.Util.throttle(this.forceRefresh,100),this.dispatchEvent=function(e,t,r){r=r||function(){},i.each((function(i){i.dispatchEvent&&i.dispatchEvent(e,t,r)}))};var l=function(){i.each((function(e){e.wasVisible=e.isVisible()}))},d=function(){var e=[],t=[];i.each((function(i){!i.isVisible()||i.wasVisible||i.alwaysVisible?i.isVisible()||!i.wasVisible||i.alwaysVisible||(t.push(i),i.wasVisible=!1):(e.push(i),i.wasVisible=!0)})),e.length>0&&l();var r=0;for(r=0;r<e.length;r++)e[r].onBecomeVisible&&e[r].onBecomeVisible();for(r=0;r<t.length;r++)t[r].onBecomeVisible&&t[r].onBecomeInvisible()},p=function(){var e=i.locateNewContainers();if(e.length>0){f();var t=i.getContentRequest({},e);return i.updateContainers(!1,(function(){m()}),t),!0}return!1};i.checkForNewContexts=function(){var e=i.context||{};return i.context=i.getContext()||{},JSON.stringify(i.context)!==JSON.stringify(e)&&(Fera.logger.log("New context detected:",e,i.context),i.refresh(),!0)};var h=function(){var e=[];return i.each((function(t){r.contains(document.documentElement,t.$container[0])||e.push(t)})),i.removeAll(e),e},f=function(){clearInterval(t)},m=function(){t&&clearInterval(t),i.context=i.getContext()||{},t=setInterval((function(){h(),p()?l():(i.checkForNewContexts(),d())}),1e3)};s()},Fera.ContainerFactory={create:function(e,t){t.id=Fera.ContainerFactory.nextContainerId();var i=!1;return"global_bottom"==e&&(i=new Fera.GlobalBottomContainer(t)),i&&(i.$container.data("bsio-container-id",t.id),i.$container.data("fera-container-id",t.id)),i},nextContainerId:function(){return window.__bsioLastContainerId=window.__bsioLastContainerId||0,window.__bsioLastContainerId++,window.__bsioLastContainerId}},Fera.GlobalBottomContainer=function(e){e=e||{};var t=this;t.baseContainer=new Fera.BaseContainer(e),t.id=e.id;var i,r=1,n="global_bottom";t.alwaysVisible=!0;var a=[],o=!1,s=Fera.Util.$(),c=function(){t.needsUpdate=!0,(i={container:t,cookieJar:e.cookieJar,debugMode:e.debugMode,testMode:e.testMode,logger:e.logger,localStorage:e.localStorage,adminMode:e.adminMode,optionsParser:e.optionsParser,app:e.app,api:e.api,timeTracker:e.timeTracker}).engagementTracker=e.engagementTracker,t.abstractBlocks={},l()};this.updateContentFromCache=function(){return!(e.app.opts.sandboxMode||e.app.opts.testMode||e.app.opts.adminMode||e.app.opts.previewMode)&&(o=!0,d(a),o=!1,!0)},this.triggerWidget=function(e,i){this.each((function(r,n){parseInt(e)===parseInt(n)&&void 0!==r.triggerWidget&&(r.triggerWidget(i)||"manual"!==r.settings.trigger||"custom_popup"!==r.type||(r.remove(),t.abstractBlocks[r.skillId]=g(r.lastDisplayerResponse),t.abstractBlocks[r.skillId].triggerWidget(i)))}))},this.triggerSkill=this.triggerWidget,this.each=function(e){for(var i=Object.keys(t.abstractBlocks),r=0;r<i.length;r++)e(t.abstractBlocks[i[r]],i[r],r);return t},this.removeAllBlocks=function(){return t.each((function(e,i){e&&e.remove(),delete t.abstractBlocks[i]})),t};var u=function(i){if(!e.sandboxMode&&!t.hasPreview&&!o){for(var r=[],n=864e5,a=0;a<i.length;a++){var s=i[a];s.cacheable&&r.push(s)}e.app.localStorage.setObject("Cache.DisplayerResponses",r,n)}},l=function(){if(e.app.opts.sandboxMode||e.app.opts.testMode||e.app.opts.adminMode||e.app.opts.previewMode)return!1;a=e.app.localStorage.getObject("Cache.DisplayerResponses",[])},d=function(e,i,r){i=i||[];var n=!1,a={},o=e.length,c=0,l=0,d=3e3;u(e);for(var f=function(){c++},g=setInterval((function(){l+=1,c>=o?(clearInterval(g),g=null,r&&r(n)):l>d&&(clearInterval(g),r&&r(!1),g=null)}),1),v=0;v<o;v++){var _=e[v],w=_.campaign_id;t.hasPreview=t.hasPreview||_.isPreview,s.isArray(_.contexts)?p(a,_,w,f)&&(n=!0):h(a,_,w,f)&&(n=!0)}return m(i),n},p=function(t,i,r,n){for(var a=!1,o=Object.keys(i.html),c=0;c<o.length;c++){var u=o[c],l=String(u)==String(e.app.getProductId()),d=l?r:[r,u].join("."),p=s.extend({},i,{html:i.html[u]}),f="tag"===i.settings.integration_mode&&!0===i.settings.depends_on_product;f=f&&!i.transient,l&&!f||(p.context=String(u)),p.settings=s.extend({},i.settings),h(t,p,d,n)&&(a=!0)}return a},h=function(i,r,n,a){try{if(f(n),t.abstractBlocks[n]){if(t.abstractBlocks[n].isPreview){var o=t.abstractBlocks[n];t.abstractBlocks[n]=g(r,(function(e){o.remove(),a(e)}),(function(){o.remove()}))}else t.abstractBlocks[n].settings&&!t.abstractBlocks[n].settings.needs_updates||t.abstractBlocks[n].update(r,a);i[n]=!0}else t.abstractBlocks[n]=g(r,a);return Fera.Util.showWithoutTransform(t.$container),!0}catch(t){e.logger.error(t)}return!1},f=function(e){t.abstractBlocks[e]&&t.abstractBlocks[e].$el&&(s.contains(document.documentElement,t.abstractBlocks[e].$el[0])||(t.abstractBlocks[e].remove(),delete t.abstractBlocks[e]))},m=function(i){if(t.abstractBlocks)for(var r=Object.keys(t.abstractBlocks),n=0;n<i.length;n++)try{for(var a=i[n],o=0;o<r.length;o++){var s=r[o];s.split(".")[0]==a&&t.abstractBlocks[s].settings&&t.abstractBlocks[s].settings.needs_updates&&(t.abstractBlocks[s].remove(),t.abstractBlocks[s]=null)}}catch(t){e.logger.error(t)}},g=function(e,n,a){var o=new Fera.CustomContainer(i);return o.id=t.id.toString()+"_"+r++,o.initialPageUrl=window.location.href,o.create(e,(function(){const e=!t.removingAllBlocks&&!o.removed&&o.initialPageUrl==window.location.href;o.remove(),e&&(t.abstractBlocks[o.widgetId]=g(o.lastDisplayerResponse))}),n,a),o};this.updateContent=function(e,i){return i=i||function(){},e.abstract_blocks?d(e.abstract_blocks,e.hidden_blocks,i):(t.$container.hide(),i(!1),!1)},this.getContentRequest=function(e){e=e||{};var i=t.dataAttr;return i.container_type=n,i},this.getDataAttr=t.baseContainer.getDataAttr,this.hasDataAttr=t.baseContainer.hasDataAttr,this.dataAttr=t.baseContainer.dataAttr,this.selector=t.baseContainer.selector,this.$container=t.baseContainer.$container,this.isVisible=function(){return Fera.Util.isFullyVisible(t.$container)},c()},Fera.Actions=Fera.Actions||{},Fera.Actions.Base=class extends Fera.Base{run(e){this._error("isStillThere must be implemented by Fera.Actions.CustomBlocks.Base")}update(e){}},Fera.Actions.ChangeBlockAction=class extends Fera.Base{constructor(e){super(),this.skill=e,this.action=null}run(){if(this.$target=this.$(this.skill.settings.target_selector),"hide"===this.skill.settings.target_action)this.action=this._createNewAction(this.$target,"hide");else if("move"===this.skill.settings.target_action){this.$destination=this.$(this.skill.settings.integration_selector);var e=this.skill.settings.integration_selector_action;this.action=this._createNewAction(this.$destination,e)}else this.action=this._createNewAction(this.$target,"replace");this.action&&this.action.run(this.skill)}update(){this.action&&this.action.update(this.skill)}_createNewAction(e,t){return"insert_after"===t?new Fera.Actions.CustomBlocks.InsertAfterAction(e):"insert_before"===t?new Fera.Actions.CustomBlocks.InsertBeforeAction(e):"append_to"===t?new Fera.Actions.CustomBlocks.AppendAction(e):"prepend_to"===t?new Fera.Actions.CustomBlocks.PrependAction(e):"replace"===t?new Fera.Actions.CustomBlocks.ReplaceAction(e):"hide"===t?new Fera.Actions.CustomBlocks.HideAction(e):(this._error("Unknown integration selector location configured.",this.skill.settings,e),null)}remove(){this.action&&this.action.remove()}},Fera.Actions.CustomBlocks=Fera.Actions.CustomBlocks||{},Fera.Actions.CustomBlocks.Base=class extends Fera.Actions.Base{constructor(e){super(),this.$targetEl=e}isStillThere(){return this.$.contains(document.documentElement,this.$el.get(0))}makeChange(){this._error("#makeChange must be implemented by Fera.Actions.CustomBlocks.Base")}run(e){if(this.$el&&this.isStillThere())return!1;this._setElement(e),this.makeChange()}refreshOnTargetChange(){return!1}_setElement(e){"hide"===e.settings.target_action?this.$el=this.$targetEl:"move"===e.settings.target_action?(this.$movePlaceHolder=this.$("<div></div>"),this.$el=this.$(e.settings.target_selector).replaceWith(this.$movePlaceHolder)):(this.$el=this.$(e.html.replace(/<!--[\s\S]*?-->/g,"").trim()),this.$el.attr("data-fera-widget",e.widgetId),this.$el.attr("data-fera-skill",e.widgetId))}update(e){return this.isStillThere()?this._updateBlock(e):this.run(e),!0}remove(){this.$el.remove(),this.$movePlaceHolder&&this.$movePlaceHolder.replaceWith(this.$el)}_updateBlock(e){"move"!==e.settings.target_action&&"hide"!==e.settings.target_action&&this.$el.html(this.$(e.html.replace(/<!--[\s\S]*?-->/g,"").trim()).html())}},Fera.Actions.CustomBlocks.AppendAction=class extends Fera.Actions.CustomBlocks.Base{makeChange(){this.$targetEl.append(this.$el)}isStillThere(){return this.$.contains(this.$targetEl.get(0),this.$el.get(0))}},Fera.Actions.CustomBlocks.HideAction=class extends Fera.Actions.CustomBlocks.Base{makeChange(){this.$targetEl.hide()}isStillThere(){return"none"==this.$targetEl.css("display")}remove(){this.$targetEl.show()}},Fera.Actions.CustomBlocks.InsertAfterAction=class extends Fera.Actions.CustomBlocks.Base{makeChange(){this.$targetEl.after(this.$el)}isStillThere(){return this.$.contains(this.$targetEl.parent().get(0),this.$el.get(0))}refreshOnTargetChange(){return!0}},Fera.Actions.CustomBlocks.InsertBeforeAction=class extends Fera.Actions.CustomBlocks.Base{makeChange(){this.$targetEl.before(this.$el)}isStillThere(){return this.$.contains(this.$targetEl.parent().get(0),this.$el.get(0))}refreshOnTargetChange(){return!0}},Fera.Actions.CustomBlocks.PrependAction=class extends Fera.Actions.CustomBlocks.Base{makeChange(){this.$targetEl.prepend(this.$el)}},Fera.Actions.CustomBlocks.ReplaceAction=class extends Fera.Actions.CustomBlocks.Base{makeChange(){this.$oldElement=this.$targetEl.replaceWith(this.$el)}remove(){this.$el.replaceWith(this.$oldElement),super.remove()}},Fera.Actions.CustomBlocks.ReplaceContentAction=class extends Fera.Actions.CustomBlocks.Base{makeChange(){this.$targetEl.empty(),this.$targetEl.append(this.$el)}},Fera.CustomContainer=function CustomContainer(opts){opts=opts||{};var self=this,$=Fera.Util.$(),campaignSettings,ran=!1,registeredEngagement=!1,keyNamespace,feraSkill,eventPrefix,previousSection,previousProductIdOrContext,actions=new Fera.ActionCollection,triggered=!1,triggerDelay,init=function(){self.$globalTopContainer=opts.container.$container,self.$container=$('<div class="banana-container-row banana-custom-container" style="display: none;"></div>'),self.$container.appendTo(self.$globalTopContainer)};this.create=function(jsonResponse,removeCallback,afterCreate,beforeRun){ran=!1;var continueCreate=!0;assignLocalVarsFromServer(jsonResponse),triggerBeforeCreateEvents(eventPrefix),eval(self.lastDisplayerResponse.js),"function"==typeof FeraWidget?feraSkill=new FeraWidget(self):"function"==typeof FeraSkill&&(feraSkill=new FeraSkill(self)),prepare(feraSkill,(function(e,t){return self.removed?(afterCreate&&afterCreate(!1),!1):!1===e?(Fera.logger.log("Widget hidden by beforeRender",t,self),self.createInProgress=!1,afterCreate&&afterCreate(!1),!1):void generateStateVars((function(){if(self.removed)return afterCreate&&afterCreate(!1),!1;if(!self.isPreview&&opts.app.storeSettings.use_client_side_processing){if(!checkConditions())return self.createInProgress=!1,afterCreate&&afterCreate(!1),!1;if(!checkAbTests())return self.createInProgress=!1,afterCreate&&afterCreate(!1),!1}!self.html&&self.lastDisplayerResponse.renders_template_client_side&&_renderTemplate(),setupShopperActionTriggers(),setupTriggerDelays(),waitForRun((function(){if(self.removed)return afterCreate&&afterCreate(!1),!1;beforeRun&&beforeRun(),feraSkill&&feraSkill.run&&(continueCreate=feraSkill.run()),!1!==continueCreate?(Fera.Util.showWithoutTransform(self.$container),campaignSettings.target_selector&&pullElementsFromTarget(),self.isPreview||(markSeen(),self.registerEngagement(jsonResponse.campaign_id)),triggerAfterCreateEvents(eventPrefix),feraSkill&&feraSkill.afterCreate&&feraSkill.afterCreate(),self.$el&&-1===["replace","replace_content"].indexOf(campaignSettings.integration_selector_action)&&self.$el.each((function(e,t){Fera.Util.onRemove(t,removeCallback||function(){})})),afterCreate&&afterCreate(!0)):(opts.logger.log("Creation blocked by Fera widget returned response.",feraSkill),afterCreate&&afterCreate(!1)),self.createInProgress=!1}))}))}))};var assignLocalVarsFromServer=function(e){self.lastDisplayerResponse=e,(campaignSettings=self.lastDisplayerResponse.settings).id=self.lastDisplayerResponse.campaign_id,self.app=opts.app,self.api=opts.api,self.adminMode=opts.adminMode,self.memory=new Fera.SkillsLocalStorage({logger:opts.logger,cookieJar:opts.cookieJar,namespace:keyNamespace}),self.localStorage=self.memory,self.lastDisplayerResponse.html&&(self.html=self.lastDisplayerResponse.html),self.options=self.settings=campaignSettings,self.storeSettings=self.app.storeSettings||self.lastDisplayerResponse.store||self.lastDisplayerResponse.store_settings||{},self.widgetId=self.skillId=self.lastDisplayerResponse.campaign_id,self.isPreview=e.isPreview||opts.optionsParser.getPreviewId()==self.widgetId,self.type=self.lastDisplayerResponse.type,self.context=self.lastDisplayerResponse.context,previousSection=opts.app.getSection(),previousProductIdOrContext=opts.app.getProductId()||self.context,keyNamespace="Fera.Widget."+self.widgetId,eventPrefix="widget."+self.widgetId};self.needsUpdate=function(){return!(self.settings&&!self.settings.needs_updates)||(opts.app.getSection()!=previousSection||(opts.app.getProductId()||self.context)!=previousProductIdOrContext)};var triggerBeforeCreateEvents=function(e){triggerFeraEvent(e+".create:before"),triggerFeraEvent("widget.create:before"),triggerEvent("Fera.Skill."+self.widgetId+"-create-before"),triggerEvent("fera-skill-create-before"),triggerFeraEvent(e.replace("widget","skill")+".create:before"),triggerFeraEvent("skill.create:before")},triggerAfterCreateEvents=function(e){triggerFeraEvent(e+".create"),triggerFeraEvent(e+".create:after"),triggerFeraEvent("widget.create"),triggerFeraEvent("widget.create:after"),triggerEvent("Fera.Skill."+self.widgetId+"-create-after"),triggerEvent("fera-skill-create-after"),triggerFeraEvent("skill.create"),triggerFeraEvent("skill.create:after"),triggerFeraEvent(e.replace("widget","skill")+".create"),triggerFeraEvent(e.replace("widget","skill")+".create:after")},prepare=function(e,t){return self.lastDisplayerResponse.renders_template_client_side&&e?e.beforeRender?(self.renderInProgress=new Date,e.beforeRender((function(e,i){delete self.renderInProgress,!1===e?t(!1,i):(self.vars=e,t())}))):void t():t()},checkConditions=function(){return!self.lastDisplayerResponse.conditions||new Fera.Conditions_Evaluator(self.lastDisplayerResponse.conditions,self.vars).isTrue()},checkAbTests=function(){return!!self.app.abTests.onFor(self.skillId)||(opts.logger.log("Widget blocked by AB Test running (wait 15min if recently changed).",self),!1)},generateStateVars=function(e){opts.app.getState((function(t){self.vars=$.extend({},{options:self.options,store:self.storeSettings,shopper:{location:t.location,customer_id:t.customer_id}},t,self.vars||{}),e(self.vars)}))},_renderTemplate=function(){var e=self.options.template;if(!e||""===e.trim())return"";try{var t=e.replace(new RegExp(/\s*({%-)/g,"g"),"{%").replace(new RegExp(/(-%})\s*/,"g"),"%}");self.lastDisplayerResponse.html=self.html=Fera.Liquid.parse(t).render(self.vars)}catch(t){if(opts.debugMode)throw t;console.error(t),self.lastDisplayerResponse.html=self.html=e}};this.isTransient=function(){return self.lastDisplayerResponse.transient},this.registerEngagement=function(e){if(e=e||self.widgetId,!self.isTransient())return!registeredEngagement&&!0!==self.skipRegisterEngagement&&!opts.testMode&&(opts.engagementTracker.register(e),registeredEngagement=!0,!0)};var canRunWithoutRepeating=function(){if(self.isPreview)return!0;if(!campaignSettings.trigger_repeat)return!0;var e=self.memory.get("last_seen");if(!e)return!0;var t=parseInt(e)+1e3*parseInt(campaignSettings.trigger_repeat);return(new Date).getTime()>t},markSeen=function(){self.memory.set("last_seen",(new Date).getTime())};this.getState=opts.app.getState,this.update=function(e,t){if(!self.removed)if(ran){self.lastDisplayerResponse=e,campaignSettings=self.lastDisplayerResponse.settings,self.lastDisplayerResponse.html&&(self.html=self.lastDisplayerResponse.html),self.settings=self.options=campaignSettings,triggerEvent("Fera.Skill."+e.campaign_id+"-update-before"),triggerEvent("fera-skill-update-before");var i=!0;waitForRun((function(){if(self.removed)return t&&t(!1),!1;generateStateVars((function(){if(self.removed)return t&&t(!1),!1;if(!self.isPreview&&opts.app.storeSettings.use_client_side_processing){if(!checkConditions())return t&&t(!1),!1;if(!checkAbTests())return t&&t(!1),!1}!self.lastDisplayerResponse.html&&self.lastDisplayerResponse.renders_template_client_side&&_renderTemplate(),updateActions(),feraSkill&&feraSkill.update&&(i=feraSkill.update()),!1!==i?(triggerFeraEvent(eventPrefix+".update"),triggerEvent("Fera.Skill."+e.campaign_id+"-update-after"),triggerEvent("fera-skill-update-after"),triggerFeraEvent(eventPrefix.replace("widget","skill")+".update"),feraSkill&&feraSkill.afterUpdate&&feraSkill.afterUpdate(),t&&t(!0)):(opts.logger.log("Update blocked by Fera Widget",feraSkill),t&&t(!1))}))}))}else t&&t(!1)},this.hide=function(){self.$container&&self.$container.hide()},this.remove=function(){self.removed||(self.removed=!0,self.$el&&self.$el.each((function(e,t){Fera.Util.disconnectRemoveHandlers(t)})),feraSkill&&feraSkill.remove&&feraSkill.remove(),actions.remove(),self.$container.remove())},this.triggerWidget=function(){return!triggered&&(!self.removed&&(triggered=!0,!0))},this.triggerSkill=this.triggerWidget;var setupTriggerDelays=function(){if(campaignSettings.trigger_value&&-1!==["after_time_on_page","after_time_on_site","after_inactive_time_on_page","after_time_since_first_seen"].indexOf(campaignSettings.trigger))if("string"==typeof campaignSettings.trigger_value)if(campaignSettings.trigger_value.match(/^[0-9]+$/))triggerDelay=parseInt(campaignSettings.trigger_value);else{var e=0,t=15;"random_1_to_15_sec"===campaignSettings.trigger_value||("random_15_to_60_sec"===campaignSettings.trigger_value?(e=15,t=60):"random_1_to_5_min"===campaignSettings.trigger_value?(e=60,t=900):Fera.logger.warn("Widget settings for trigger random range are invalid. Fell back on 1-15 seconds range.",campaignSettings)),(triggerDelay=Math.round(Math.random()*t)+e)<1&&(triggerDelay=1)}else triggerDelay=parseInt(campaignSettings.trigger_value)},setupShopperActionTriggers=function(){if("on_exit_intent"===campaignSettings.trigger)new Fera.ExitIntentDetector({onExitIntent:self.triggerWidget});else if(-1!==["on_click","on_mouseenter","on_mouseleave"].indexOf(campaignSettings.trigger)){var e=campaignSettings.trigger.replace("on_","");$(campaignSettings.trigger_value).on(e,self.triggerWidget)}},waitForRun=function(e){if(ran)return e();if("custom_action"==self.type||"change_block"==self.type)return e();if(!1===runActions())return self.remove(),e();if(ran)return e();var t=setInterval((function(){if(!self.removed)return runActions(),ran?(clearInterval(t),e()):void 0;clearInterval(t)}),10)},updateActions=function(){foreachTargetEl((function(e,t){if(!self.removed){var i=actions.get(t);if(i){if(i.$targetEl.get(0)!==e.get(0)){if(!i.refreshOnTargetChange())return;i.$targetEl=e}i.update(self),e.data("feraFoundExisting",!0)}}})),foreachTargetEl((function(e){if(e.data("feraFoundExisting"));else{var t=createNewAction(e);actions.add(t),t.run(self.lastDisplayerResponse)}e.data("feraFoundExisting",null)})),pullElementsFromActions()},triggerConditionsMet=function(){if(triggered)return!0;if(self.isPreview&&opts.app.sandboxMode)return!0;if(!campaignSettings.trigger||"on_load"===campaignSettings.trigger)return!0;if("after_time_on_page"===campaignSettings.trigger){if(opts.timeTracker.getTimeOnCurrentPage()>=triggerDelay)return!0}else if("after_time_on_site"===campaignSettings.trigger){if(opts.timeTracker.getSessionTime()>=triggerDelay)return!0}else if("after_inactive_time_on_page"===campaignSettings.trigger){if(opts.timeTracker.getInactiveTimeOnPage()>=triggerDelay)return!0}else{if("after_time_since_first_seen"!==campaignSettings.trigger)return-1===["manual","on_click","on_mouseenter","on_mouseleave","on_exit_intent"].indexOf(campaignSettings.trigger)&&(Fera.logger.logWarning("Unknown trigger conditions so triggering now.",campaignSettings,self),!0);if(opts.timeTracker.getTimeSinceFirstSeen()>=triggerDelay)return!0}return!1},runActions=function(){if(triggerConditionsMet()&&canRunWithoutRepeating()){if(new Fera.IntegrationLocator(opts.app).repositionWidget(campaignSettings,self.context),"tag"==campaignSettings.integration_mode&&(campaignSettings.integration_selector_action="replace_content"),campaignSettings.integration_selector&&campaignSettings.integration_selector_action){if(!1===createActions())return!1}else{if(!campaignSettings.has_location_on_page&&"custom_popup"!=self.type&&"custom_push_notif"!=self.type)return!1;ran=!0}actions.run(self),pullElementsFromActions()}},pullElementsFromActions=function(){self.$el=$([]),actions.each((function(e){e.$el&&(self.$el=self.$el.add(e.$el))})),self.$el.data("fera-preview-container")&&1===self.$el.children().length&&(self.$el=self.$el.children()),self.$el.attr("data-fera-widget",self.widgetId),self.$el.attr("data-fera-skill",self.widgetId)},pullElementsFromTarget=function(){var e=$(campaignSettings.target_selector);e&&(self.$el=self.$el||$([]),self.$el=self.$el.add(e),self.$el.attr("data-fera-widget",self.widgetId),self.$el.attr("data-fera-skill",self.widgetId))},foreachTargetEl=function(e){var t=$(campaignSettings.integration_selector);if(t.length<1)return!1;t.each((function(t){var i=$(this);e(i,t)}))},createActions=function(){if(!self.lastDisplayerResponse.html)return!1;var e=!1;if(!1===foreachTargetEl((function(t){var i=createNewAction(t);i&&(actions.add(i),e=!0)}))&&self.isPreview)return!1;e&&(ran=!0)},createNewAction=function(e){var t=campaignSettings.integration_selector_action;return"insert_after"===t?new Fera.Actions.CustomBlocks.InsertAfterAction(e):"insert_before"===t?new Fera.Actions.CustomBlocks.InsertBeforeAction(e):"append_to"===t?new Fera.Actions.CustomBlocks.AppendAction(e):"prepend_to"===t?new Fera.Actions.CustomBlocks.PrependAction(e):"replace"===t?new Fera.Actions.CustomBlocks.ReplaceAction(e):"replace_content"===t?new Fera.Actions.CustomBlocks.ReplaceContentAction(e):(opts.logger.error("Unknown integration selector location configured.",campaignSettings),null)},triggerEvent=function(e){!function(t){try{t(document).trigger(e,self)}catch(e){opts.logger.error(e),opts.adminMode&&opts.optionsParser.hasPreviewFilterById()&&alert("Your custom widget produced an error: "+e.message+" (see console for more info).\n\n**THIS MESSAGE WILL NOT APPEAR TO YOUR SHOPPERS ***")}}($)},triggerFeraEvent=function(e){try{opts.app.trigger(e,self)}catch(e){opts.logger.error(e),opts.adminMode&&opts.optionsParser.hasPreviewFilterById()&&alert("Your custom widget produced an error: "+e.message+" (see console for more info).\n\n**THIS MESSAGE WILL NOT APPEAR TO YOUR SHOPPERS ***")}};init()},Fera.IntegrationLocator=class{constructor(e){this.$=Fera.Util.$(),this.app=e}repositionWidget(e,t){const i=new Date(e.updated_at),r=new Date("2021-02-18T19:10:00.000Z");let n=null==e.integration_mode&&null==e.integration_selector;if(n=n||"preset"===e.integration_mode&&i>r,n){const i=this.findBestLocation(e.presets,t);i?(e.designer_css=this._applyDefaultDesignerCss(e,i),"product_view"==this.app.getSection()&&t&&this.app.getProductId()==t?e.integration_selector=i.selector:e.integration_selector=this._applyContext(i.selector,t),e.integration_selector_action=i.action||"insert_after"):e.integration_selector=this._applyContext(e.integration_selector,t)}else if("chooser"==e.integration_mode){const i=(e.integration_selector||"").split(",").map((e=>e.trim()));if("product_view"==this.app.getSection()&&t&&this.app.getProductId()==t);else{const r=this._applyContext(e.integration_selector,t)||"";r.split(",").map((e=>e.trim())).forEach((e=>{i.some((t=>e==t))||i.push(r)}))}e.integration_selector=i.join(", ")}else e.integration_selector=this._applyContext(e.integration_selector,t,!1)}findBestLocation(e,t){if(!e)return null;let i=e[this.app.getSection()]||[];i=i.concat(e.any||[]);const r=this.constructor.PRESET_LOCATIONS;for(const e of i)for(const i of r[e]){let e=i.selector;"product_view"==this.app.getSection()&&this.app.getProductId()==t||(e=this._applyContext(e,t));const r=this.$(e);if(1===r.length||r.length>0&&i.multi)return i}return null}_applyDefaultDesignerCss(e,t){if(null!=e.integration_mode&&"preset"!=e.integration_mode)return e.designer_css;if(null!=e.integration_selector&&"preset"!=e.integration_mode)return e.designer_css;if(null!=e.designer_css)return e.designer_css;if(null==t.custom_styler)return null;const i=t.custom_styler.map((t=>""+(0===t.id.indexOf("container_")?`.fera-widget-${e.id} { ${t.values.map((e=>`${e.attribute}: ${e.value};`)).join("\n")} }`:""))).join("\n");if(this.$(`#widget-${e.id}-defaultDesignerCss`).length>0)return i;const r=`<style id="widget-${e.id}-defaultDesignerCss">${i}</style>`;return this.$("body").append(r),i}_applyContext(e,t,i=!0){if(!t||e.includes("[data-product_id='"))return e;const r=[`${e}[data-product_id='${t}']`];return i&&(r.push(`[data-product='${t}'] ${e}`),r.push(`[data-product-id='${t}'] ${e}`)),r.join(", ")}static selectorIsPreset(e){const t=this.PRESET_LOCATIONS;for(const i in t)if("string"==typeof i)for(const r of t[i])if(e===r.selector)return!0;return!1}static get PRESET_LOCATIONS(){const e={id:"container_margin",values:[{id:"campaign_container_margin_margin_top",value:"6px",attribute:"margin-top"},{value:"inline-block",attribute:"display"}]},t={id:"container_margin",values:[{id:"campaign_container_margin_margin_top",value:"32px",attribute:"margin-top"},{id:"campaign_container_margin_margin_left",value:"auto",attribute:"margin-left"},{id:"campaign_container_margin_margin_right",value:"auto",attribute:"margin-right"}]},i={id:"container_padding",values:[{id:"campaign_container_padding_padding_left",value:"16px",attribute:"padding-left"},{id:"campaign_container_padding_padding_right",value:"16px",attribute:"padding-right"}]},r={id:"container_margin",values:[{id:"campaign_container_margin_margin_bottom",value:"60px",attribute:"margin-bottom"}]},n={id:"container_margin",values:[{id:"campaign_container_margin_margin_bottom",value:"32px",attribute:"margin-bottom"}]},a={id:"container_margin",values:[{id:"campaign_container_margin_margin_top",value:"72px",attribute:"margin-top"},{id:"campaign_container_margin_margin_left",value:"auto",attribute:"margin-left"},{id:"campaign_container_margin_margin_right",value:"auto",attribute:"margin-right"}]},o={id:"container_max_width",values:[{id:"campaign_container_width_max_width",value:"1200px",attribute:"max-width"}]};return{page:[{selector:"main",action:"append_to",custom_styler:[o,i,a]},{selector:"body",action:"append_to",custom_styler:[o,i,a]}],"add to cart button":[{selector:'form[action~="/cart/add"] .product-single__add-to-cart',action:"insert_before",custom_styler:[e]},{selector:'form[action~="/cart/add"] button[type=submit]',action:"insert_before",custom_styler:[e]},{selector:'form[action~="/cart/add"] input[type=submit]',action:"insert_before",custom_styler:[e]},{selector:".product-form__cart-submit",action:"insert_before",custom_styler:[e]},{selector:".add-to-cart",action:"insert_before",custom_styler:[e]},{selector:".addToCart",action:"insert_before",custom_styler:[e]},{selector:".add_to_cart",action:"insert_before",custom_styler:[e]},{selector:"#addToCart",action:"insert_before",custom_styler:[e]},{selector:"#add-to-cart",action:"insert_before",custom_styler:[e]},{selector:"#add_to_cart",action:"insert_before",custom_styler:[e]},{selector:".add-to-cart input.button",action:"insert_before",custom_styler:[e]},{selector:".btn-addtocart",action:"insert_before",custom_styler:[e]},{selector:'[data-hook="add-to-cart"]',action:"insert_before",custom_styler:[e]}],"first shopify section":[{selector:".template-index > #PageContainer.drawer-page-content",action:"insert_after",custom_styler:[r,a]},{selector:"main > .shopify-section:not(#shopify-section-header):not(#shopify-section-footer):first",action:"insert_before",custom_styler:[r,a]},{selector:"body > .shopify-section:not(#shopify-section-header):not(#shopify-section-footer):first",action:"insert_before",custom_styler:[r,a]},{selector:"#shopify-section-header",action:"insert_after",custom_styler:[r,a]},{selector:"main#MainContent",action:"prepend_to",custom_styler:[r,a]},{selector:"main section:first-of-type",action:"insert_after",custom_styler:[r,a]}],"last shopify section":[{selector:".template-index .drawer-page-content main",action:"insert_after",custom_styler:[r,a]},{selector:"main > .shopify-section:not(#shopify-section-header):not(#shopify-section-footer):last",action:"insert_after",custom_styler:[r,a]},{selector:"body > .shopify-section:not(#shopify-section-header):not(#shopify-section-footer):last",action:"insert_after",custom_styler:[r,a]},{selector:"main#MainContent",action:"append_to",custom_styler:[r,a]},{selector:"#shopify-section-footer",action:"insert_before",custom_styler:[r,a]},{selector:"main section:last-of-type",action:"insert_after",custom_styler:[r,a]},{selector:"#SITE_PAGES_TRANSITION_GROUP",action:"append_to",custom_styler:[o,i,a]},{selector:"#SITE_PAGES",action:"append_to",custom_styler:[o,i,a]}],"first header":[{selector:"h1",custom_styler:[e,n,{id:"container_margin",values:[{id:"campaign_container_margin_margin_left",value:"auto",attribute:"margin-left"},{id:"campaign_container_margin_margin_right",value:"auto",attribute:"margin-right"}]}]}],"cart form":[{selector:'form[action~="/cart"]'}],"cart footer":[{selector:".cart__footer",action:"insert_before"}],"cart header":[{
selector:".cart-header",action:"insert_before",custom_styler:[n]}],"checkout button":[{selector:'form[action~="/cart"] .cart-footer .btn-group'},{selector:" .cart__submit-controls"}],"checkout footer":[{selector:".edit_checkout .step__footer"}],"checkout total":[{selector:".sidebar .total-line-table"}],"product title":[{selector:'[data-hook="product-title"]',action:"insert_after"}],"product content":[{selector:".product__content .grid",action:"insert_after",custom_styler:[t]},{selector:".product__content .grid .grid__item",action:"append_to",custom_styler:[t]},{selector:'[data-section-id="product-template"] .product-single + .product-single__description',custom_styler:[a]},{selector:'[data-section-id="product-template"] .product-single',custom_styler:[a]},{selector:".shopify-section .product.grid",custom_styler:[a]},{selector:".product-page > .wrapper > .grid.product-single",custom_styler:[a]},{selector:".grid.product-single",custom_styler:[a]},{selector:"#shopify-section-product-template",action:"insert_after",custom_styler:[{id:"container_padding",values:[{id:"campaign_container_padding_padding_bottom",value:"60px",attribute:"padding-bottom"}]},a]},{selector:".index-section--featured-product",custom_styler:[a]},{selector:'[data-section-id="product"]',action:"insert_after",custom_styler:[t]},{selector:'[data-hook="product-page"]',action:"append_to",custom_styler:[a]},{selector:'[data-hook="bottom-placeholder"]',action:"append_to",custom_styler:[o,i,a]}],"product description":[{selector:"#shopify-product-reviews",action:"replace"},{selector:" .product-single__description",action:"insert_before"},{selector:'[data-hook="description"]',action:"insert_before"}],"before footer":[{selector:"#SITE_PAGES > div:last-child",action:"append_to",custom_styler:[o,i,a]},{selector:"main section:last-of-type",action:"insert_after",custom_styler:[o,i,a]},{selector:"body > section:last-of-type",action:"insert_after",custom_styler:[o,i,a]},{selector:"footer",action:"insert_before",custom_styler:[o,i,a]},{selector:"#SITE_PAGES_TRANSITION_GROUP",action:"append_to",custom_styler:[o,i,a]},{selector:"#SITE_PAGES",action:"append_to",custom_styler:[o,i,a]}],footer:[{selector:'[data-section-id="footer"] .site-footer__content',action:"insert_after"},{selector:"footer > .site-footer__linklist",action:"insert_after"},{selector:"footer .grid-uniform",action:"insert_before"},{selector:"footer .footer__content",action:"insert_before"},{selector:"footer .hr--small",action:"insert_before"},{selector:"footer .site-footer__bottom",action:"insert_before"},{selector:"footer .flex-footer",action:"insert_before"},{selector:'[data-section-id="footer"] .grid:last',action:"insert_before"},{selector:"footer .footer__blocks-wrapper",action:"insert_before"},{selector:"#SITE_FOOTERinlineContent",action:"prepend_to"}],"bottom of product list items":[{selector:'[data-container_type="list"]',action:"append_to",multi:!0},{selector:'[data-hook="product-item-product-details"]',action:"append_to",multi:!0},{selector:'[data-hook="product-widget-layout"] [data-hook="product-details"]',action:"append_to",multi:!0}],"bottom of product content":[{selector:'#shopify-section-product-template [data-section-id="product-template"][itemscope][itemtype="http://schema.org/Product"]',action:"append_to"},{selector:'[data-hook="bottom-placeholder"]',action:"append_to",custom_styler:[o,i,a]},{selector:"#SITE_PAGES > div:last-child",action:"append_to",custom_styler:[o,i,a]}]}}},Fera.AntiSpySupport=class{constructor(e){this._opts=e,this.removeSpies(),setInterval((()=>this.removeSpies()),5e3)}removeSpies(){F$(".ppspy-message").parents(".extension-container").remove(),F$("#shopify-raise-container, #shopify-Hunt-container").remove()}},Fera.InstantClickSupport=function(e){var t=Fera.Util.$();e=e||{};var i=function(){"undefined"!=typeof InstantClick&&(e.logger.log("Instant Click was detected, so support module was loaded."),r())},r=function(){InstantClick.on("change",(function(){var i=t(".banana-view-container").first(),r=e.app.getProductId();if(i&&i.length>0){var n=i.data("product_id");e.app.push("setProductId",{id:n})}else r&&e.app.push("setProductId",{id:null});e.app.refreshContent()}))};i()},Fera.ShogunSupport=class{constructor(e){return this._opts=e,this.$=Fera.Util.$(),this.isReady=!1,"undefined"==typeof __shgProductInits?this._ready():(Fera.logger.log("Shogun page was detected, so support module was loaded."),__shgProductInits.length<1?this._ready():(this._shogunProductData=__shgProductInits[0],void this._fetchProductData()))}_ready(){this.isReady=!0}_fetchProductData(){if(!this._shogunProductData)return this._ready();var e="/products/"+this._shogunProductData.productHandle+".js";this.$.ajax({url:e,method:"GET",type:"GET",dataType:"json",success:e=>{e&&e.id&&(this._opts.app.setProductId(e.id),this._opts.app.setSection("product_view")),this._ready()},error:()=>{this._ready()}})}},Fera.WeglotSupport=function(e){Fera.Util.$();e=e||{};var t=function(){"undefined"!=typeof Weglot&&(e.logger.log("Weglot was detected, so support module was loaded."),i())},i=function(){Weglot.on("languageChanged",(function(t){e.app.setLocale(t),e.app.forceRefreshContent()}))};t()},Fera.SkillsLocalStorage=function(e){var t,i=this,r=function(){t=new Fera.LocalStorageJar(e),i.memory=t.getObject("memory")||{}};i.set=function(e,t,r){return i.memory[e]={value:t,expiry:s(r)},n(),i},i.get=function(e,t){return void 0===i.memory[e]||o(e)?t:i.memory[e].value},i.reset=function(){return i.memory={},n(),a("Local storage was reset.",e.namespace),i};var n=function(){t.setObject("memory",i.memory)},a=function(){e.logger&&e.logger.log&&-1===Fera.Util.detectBrowser().indexOf("MSIE")&&e.logger.log.apply(this,arguments)},o=function(e){return null!==i.memory[e].expiry&&Date.now()>i.memory[e].expiry},s=function(e){return"number"!=typeof e?null:Date.now()+e};r()},Fera.ActionCollection=class{constructor(){this._actions=[]}add(e){this._actions.push(e)}run(...e){this._actions.forEach((t=>{t.run&&t.run(...e)}))}update(...e){this._actions.forEach((t=>{t.update&&t.update(...e)}))}each(e){this._actions.forEach(e)}remove(...e){this._actions.forEach((t=>{t.remove&&t.remove(...e)}))}get(e){return this._actions[e]}},Fera.Components=Fera.Components||{},Fera.Components.Base=class{constructor(e={}){this._opts=e,this._listeners=e.listeners||e.on||{},this.$globalTopContainer=Fera.Util.$()(".banana-globalTop-container")}on(e,t){return(-1===e.indexOf(" ")?[e]:e.split(" ")).forEach((e=>{this._listeners[e]=this._listeners[e]||[],this._listeners[e].push(t)})),this}render(){setTimeout((()=>this._afterRenderComplete()),1)}_afterRenderComplete(){}triggerOnce(e,t){this.trigger(e,t),this.clearListeners(e)}clearListeners(e){this._listeners[e]=[]}trigger(e,t){return(-1===e.indexOf(" ")?[e]:e.split(" ")).forEach((e=>{const i=this._listeners[e];!i||i.length<1||i.forEach((e=>{e(this,t)}))})),this}_log(){Fera.logger.log.apply(this,arguments)}_warn(){Fera.logger.warn.apply(this,arguments)}_error(){Fera.logger.error.apply(this,arguments)}_logWarning(){Fera.logger.logWarning.apply(this,arguments)}},Fera.Components.BaseModal=class extends Fera.Components.Base{constructor(e){super(e),this.$=Fera.Util.$(),this.titleCaption=e.titleCaption||"",this.classPrefix=e.classPrefix||"fera"}show(){this.rendered||this._render();const e=this.$("body");e.find(`.${this.classPrefix}-fera-modal`).length<1&&e.append(this.$el),this.$el.show()}hide(){this.$el.hide()}_render(){this.$el=this.$(this._tpl()),this.$modal=this.$el.find(".fera-modal"),this.$closeButton=this.$el.find(".fera-modal-close"),this.$modalBody=this.$el.find(".fera-modal-body"),this._setupCloseListeners(),this.rendered=!0}_setupCloseListeners(){this.$closeButton.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this.hide()})),window.onclick=e=>{this.$(e.target).hasClass("fera-modal")&&(e.stopPropagation(),this.hide())}}_tpl(){return`<div class="fera-modal ${this.classPrefix}-fera-modal" style="display: none;">\n            <div class="fera-modal-dialog">\n                <div class="fera-modal-content">\n                    <div class="fera-modal-header">\n                        <span class="fera-modal-close" data-dismiss="fera-modal">\xd7</span>\n                        <h2 class="fera-modal-title">${this.titleCaption}</h2>\n                    </div>\n                    <div class="fera-modal-body"></div>\n                </div>\n            </div>\n        </div>`}},Fera.Components.Pagination=class extends Fera.Components.Base{constructor(e){super(e),this.$=Fera.Util.$(),this.app=e.app,this.prefix=e.prefix,this._hideIfOnePage=!1!==this._opts.hideIfOnePage,this._onClick=this._opts.onClick||(()=>{}),this._noNavHelpers=this._opts.noNavHelpers,this.update(this._opts)}render(){return this.prerendered||(this.$el=this.$(this._tpl()),this.rendered=!0,this._initialize()),this.$el}_initialize(){this.$items=this.$el.find(".pagination"),this._updateView()}update(e){this.currentPage=e.currentPage||0,this.totalCount=e.totalCount||0,this.pageSize=e.pageSize||10,this.numPages=this.totalCount>0?Math.ceil(this.totalCount/this.pageSize):0,this.rendered&&this._updateView()}isVisible(){return this.$el.is(":visible")}_updateView(){this.totalCount<1||this._hideIfOnePage&&1==this.numPages?this.$el.hide():this.$el.show(),this._renderItems()}_renderItems(){this.$items.children().remove();const e=2;if(this._noNavHelpers){for(let e=1;e<=this.numPages;e++)this.$items.append(this._renderItem(e,e));return}this.currentPage>e&&this.numPages>e&&this.$items.append(this._renderItem(1,this._first(),"first")),this.currentPage>1&&this.$items.append(this._renderItem(this.currentPage-1,this._prev(),"prev"));const t=Math.max(this.currentPage-e,1),i=Math.min(this.currentPage+e,this.numPages);for(let e=t;e<=i;e++)this.$items.append(this._renderItem(e,e));this.currentPage<this.numPages&&this.$items.append(this._renderItem(this.currentPage+1,this._next(),"next")),this.currentPage<=this.numPages-e&&this.numPages>e&&this.$items.append(this._renderItem(this.numPages,this._last(),"last"))}_renderItem(e,t,i){i=i||"basic";const r=this.currentPage==e?"active":"",n=this.$(this._itemTpl(e,t,i,r));return n.find("a").on("click",(t=>{t.preventDefault(),t.stopPropagation(),n.hasClass("active")||this._onClick(e)})),n}_first(){return this._iconTpl(this._firstIcon())}_last(){return this._iconTpl(this._lastIcon())}_prev(){return this._iconTpl(this._prevIcon())}_next(){return this._iconTpl(this._nextIcon())}_iconTpl(e,t=""){return`<span class="pagination-icon ${t}">${e}</span>`}_firstIcon(){return'<svg aria-hidden="true" focusable="false" height="17" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" data-fa-i2svg=""><path fill="currentColor" d="M20.2 247.5L167 99.5c4.7-4.7 12.3-4.7 17 0l19.8 19.8c4.7 4.7 4.7 12.3 0 17L85.3 256l118.5 119.7c4.7 4.7 4.7 12.3 0 17L184 412.5c-4.7 4.7-12.3 4.7-17 0l-146.8-148c-4.7-4.7-4.7-12.3 0-17zm160 17l146.8 148c4.7 4.7 12.3 4.7 17 0l19.8-19.8c4.7-4.7 4.7-12.3 0-17L245.3 256l118.5-119.7c4.7-4.7 4.7-12.3 0-17L344 99.5c-4.7-4.7-12.3-4.7-17 0l-146.8 148c-4.7 4.7-4.7 12.3 0 17z"></path></svg>'}_lastIcon(){return'<svg aria-hidden="true" focusable="false" height="17" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" data-fa-i2svg=""><path fill="currentColor" d="M363.8 264.5L217 412.5c-4.7 4.7-12.3 4.7-17 0l-19.8-19.8c-4.7-4.7-4.7-12.3 0-17L298.7 256 180.2 136.3c-4.7-4.7-4.7-12.3 0-17L200 99.5c4.7-4.7 12.3-4.7 17 0l146.8 148c4.7 4.7 4.7 12.3 0 17zm-160-17L57 99.5c-4.7-4.7-12.3-4.7-17 0l-19.8 19.8c-4.7 4.7-4.7 12.3 0 17L138.7 256 20.2 375.7c-4.7 4.7-4.7 12.3 0 17L40 412.5c4.7 4.7 12.3 4.7 17 0l146.8-148c4.7-4.7 4.7-12.3 0-17z"></path></svg>'}_prevIcon(){return'<svg aria-hidden="true" focusable="false" height="17" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512" data-fa-i2svg=""><path fill="currentColor" d="M4.2 247.5L151 99.5c4.7-4.7 12.3-4.7 17 0l19.8 19.8c4.7 4.7 4.7 12.3 0 17L69.3 256l118.5 119.7c4.7 4.7 4.7 12.3 0 17L168 412.5c-4.7 4.7-12.3 4.7-17 0L4.2 264.5c-4.7-4.7-4.7-12.3 0-17z"></path></svg>'}_nextIcon(){return'<svg aria-hidden="true" focusable="false" height="17" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512" data-fa-i2svg=""><path fill="currentColor" d="M187.8 264.5L41 412.5c-4.7 4.7-12.3 4.7-17 0L4.2 392.7c-4.7-4.7-4.7-12.3 0-17L122.7 256 4.2 136.3c-4.7-4.7-4.7-12.3 0-17L24 99.5c4.7-4.7 12.3-4.7 17 0l146.8 148c4.7 4.7 4.7 12.3 0 17z"></path></svg>'}_itemTpl(e,t,i,r){return`<li class="page-item ${r}">\n            <a href="#" class="page-link ${r} ${i}" data-page="${e}"> ${t}</a>\n        </li>`}_tpl(){return`\n<nav aria-label="Pagination" class="fera-pagination ${this.prefix}-pagination">\n    <ul class="pagination justify-content-center">\n        <li class="page-item first"><a href="#" class="page-link">First</a></li>\n        <li class="page-item prev"><a href="#" class="page-link">Previous</a></li>\n        <li class="page-item"><a href="#" class="page-link">1</a></li>\n        <li class="page-item active"><a href="#" class="page-link">2</a></li>\n        <li class="page-item next"><a href="#" class="page-link">Next</a></li>\n        <li class="page-item last"><a href="#" class="page-link">Last</a></li>\n    </ul>\n</nav>\n        `}},Fera.ClickRegistry=function(e){e=e||{};var t=this,i=Fera.Util.$(),r="ClickEvent",n=!0,a=null,o=["iframe","lang","body","!doctype","doctype","applet","article","aside","audio","basefont","body","br","colgroup","frame","frameset","head","header","html","iframe","p","main","meta","ol","param","script","tr","ul"],s=function(){e.sandboxMode||e.designMode||Fera.Util.isBot()||Fera.Util.isSpeedMode()||window.addEventListener("pagehide",(function(){c()}))};t.isEnabled=function(){return e.app.storeSettings&&e.app.storeSettings.when_to_send_events&&e.app.storeSettings.when_to_send_events.element_click>=0},t.register=function(){if(!t.isEnabled())return;i(document).on("mousedown","*",(function(e){if(void 0!==e.originalEvent&&2!==e.button&&e.target!==a&&-1===o.indexOf(e.target.tagName.toLowerCase())){var r=i(e.target);r.hasClass("fera-highlight-placeholder")||r.find("* > * > * > *").length>0||(u(t.getEventData(e)),a=e.target)}}));const r=1e3*e.app.storeSettings.when_to_send_events.element_click+1;setInterval(l,r),setInterval((function(){a=null}),r+1500)},t.sendElementClick=function(t){e.app.pushEvent({type:"element_click",data:t})},t.getEventData=function(e){var t={};return p(e.target,t),t.client_x=e.pageX,t.client_y=e.pageY,t};var c=function(){n=!1},u=function(t){e.localStorage&&t&&e.localStorage.setObject(r,t)},l=function(){if(n){var i=e.localStorage.getObject(r);i&&(e.localStorage.removeItem(r),t.sendElementClick(i))}},d=function(e){var t=i(e).parents();return!(t.length<1)&&-1!==(t=t.map((function(){return this.tagName})).get()).indexOf("BUTTON")},p=function(e,t){d(e)&&(e=i(e).parents("button")[0]);var r=i(e);g(r,t),t.element_attributes=v(e),t.element_text=w(h(r)),t.element_tag_name=e.tagName,t.element_html=w(f(r)),r.is("select")&&(t.select_options=_(e)),t.element_css_path=m(e)},h=function(e){var t=e.clone();return t.find("style, svg").remove(),t.find(":hidden").remove(),t.text()},f=function(e){var t=e.clone();return t.find(":hidden").remove(),t.html()},m=function(e){var t=new Fera.CssPathGenerator(e,{skipDataAttributes:!0,skipAttributes:!0,skipTags:!0}).getPath();return""!==t||""===(t=new Fera.CssPathGenerator(e,{skipDataAttributes:!0,skipAttributes:!0}).getPath())||""===(t=new Fera.CssPathGenerator(e,{skipDataAttributes:!0}).getPath())?t:t=new Fera.CssPathGenerator(e).getPath()},g=function(e,t){var i=e.data("fera-widget")||e.data("fera-skill");void 0===i&&(i=(i=e.parents("[data-fera-widget],[data-fera-skill]").data("fera-widget"))||e.parents("[data-fera-widget],[data-fera-skill]").data("fera-skill")),void 0!==i&&(t.campaign_id=i,t.created_by="campaign")},v=function(e){var t={};return i.each(e.attributes,(function(){t[w(this.name,50)]=w(this.value)})),t},_=function(e){var t=[];return i.each(e.options,(function(){t.push(this.text)})),t},w=function(e,t){return t=t||300,e.replace(/\s\s+/gm," ").trim().substring(0,t)};s()},Fera.CssPathGenerator=function(e,t){var i=this;t=t||{};var r=Fera.Util.$(),n=r(e).parents(),a=[],o=t.maxDataAttrSize||50,s=function(){};i.getPath=function(){a=[];var t=c(e);return t&&""!==t&&a.push(t),n.each((function(){(t=c(this))&&""!==t&&a.push(t)})),a.slice(0,5).join(" > ")};var c=function(e){var i=r(e),n=t.skipTags?"":e.tagName;n+=u(i.attr("id")),n+=l(i.attr("class"));var a=[];return t.skipAttributes||d(e.attributes,a),t.skipDataAttributes||p(i.data(),a),a.length>0&&(n+=a.slice(0,5).join("")),n},u=function(e){return f(e)?"":"#"+e},l=function(e){return f(e)?"":e.replace(/\s\s+/gm," ").trim().split(" ").map((function(e){return e?"."+e:""})).join("")},d=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];h(r.name)&&m(r.value)&&t.push("["+r.name+'="'+r.value+'"]')}},p=function(e,t){r.each(e,(function(e,i){m(i)&&t.push("[data-"+e.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()+'="'+i+'"]')}))},h=function(e){return!e.match(/id|class|style|(data-.*)|(on.+)|(xml:.*)/i)},f=function(e){return null==e||""===e},m=function(e){return!!f(e)||(!e.trim||0!==e.trim().indexOf("{")&&(-1===e.indexOf("\n")&&e.length<=o))};s()},Fera.ContentSubmission=Fera.ContentSubmission||{},Fera.ContentSubmission.Customer=class{constructor(e={}){this.opts=e,this.$=Fera.Util.$(),this.localStorage=e.localStorage,this.$container=e.$container,this.$translationContainer=e.$translationContainer,this._extractTranslations(),this._loadFromLocalStorage(),this.name=this.opts.optionsParser.detectCustomerName()||(this.previousCustomer?this.previousCustomer.name:""),this.email=this.opts.optionsParser.detectCustomerEmail()||(this.previousCustomer?this.previousCustomer.email:"")}isPresent(){return this.name&&this.email}update(e,t){this.token=e,this.successCallback=t}requestDetails(){this.$container.find(".fera-contentSubmission-title").text(this.translatedStrings.justAFewThings),this.$form=this.$container.find("form"),this.$form.html(this._tpl()),this.$customerEmail=this.$form.find('[name="fera-customer-email"]'),this.$customerName=this.$form.find('[name="fera-customer-name"]'),!this.$customerName.val()&&this.name&&this.$customerName.val(this.name),!this.$customerEmail.val()&&this.email&&this.$customerEmail.val(this.email),this.$form.on("submit",this._handleSubmit.bind(this))}_loadFromLocalStorage(){this.localStorage&&(this.previousCustomer=this.localStorage.getObject(Fera.ContentSubmission.Customer.KEY,{}))}_saveToLocalStorage(){this.localStorage&&(this.previousCustomer={name:this.name,email:this.email},this.localStorage.setObject(Fera.ContentSubmission.Customer.KEY,this.previousCustomer))}_extractTranslations(){this.translatedStrings={},this.translatedStrings.justAFewThings=this.$translationContainer.data("caption-just-a-few-more-things")||"Just a couple more things...",this.translatedStrings.name=this.$translationContainer.data("caption-name")||"Name",this.translatedStrings.email=this.$translationContainer.data("caption-email")||"Email",this.translatedStrings.emailAddress=this.$translationContainer.data("caption-email-address")||"Email address"}_handleSubmit(e){e.preventDefault(),this.$errorContainer=this.$form.find(".fera-errorContainer"),this.$submitBtn=this.$form.find("[data-fera-contentSubmission-submitBtn]"),this.name=this.$customerName.val(),this.email=this.$customerEmail.val(),this.name.trim()&&this.email.trim()?this._submit():this.$errorContainer.text(Fera.t("Your name and email is required")).removeClass("fera-hidden")}_submit(){this.$errorContainer.addClass("fera-hidden"),this.$submitBtn.text(Fera.t("Loading...")),this.$submitBtn.prop("disabled",!0);const e="/update_customer";this.opts.api.contentSubmission({params:{customer_name:this.name,customer_email:this.email,content_submission_token:this.token,visitor_id:this.opts.visitorId},success:this._onCustomerUpdated.bind(this),error:e=>{this.$errorContainer.text(Fera.t("There was an unexpected error. Please try again")).removeClass("fera-hidden"),this.$submitBtn.text(Fera.t("Submit")),this.$submitBtn.prop("disabled",!1),this.opts.app.opts.debugMode&&console.error(e)}},e)}_onCustomerUpdated(e){this.name=e.customer_name,this.email=e.customer_email,this._saveToLocalStorage(),this.successCallback()}_tpl(){return`\n<div class="fera-contentSubmission-customer">\n    <div class="fera-errorContainer fera-hidden"></div>\n    <div class="fera-contentSubmission-row">\n        <label class="fera-contentSubmission-formControl-label">${this.translatedStrings.name}:</label>\n        <input class="fera-contentSubmission-formControl" type="text" placeholder="${this.translatedStrings.name}" name="fera-customer-name" required>\n    </div>\n    <div class="fera-contentSubmission-row">\n        <label class="fera-contentSubmission-formControl-label">${this.translatedStrings.email}:</label>\n        <input class="fera-contentSubmission-formControl" type="email" placeholder="${this.translatedStrings.emailAddress}" name="fera-customer-email" required>\n    </div>\n\n    <input type="submit" class="fera-contentSubmission-submitBtn" data-fera-contentsubmission-submitbtn="" value="${Fera.t("Submit")}" />\n</div>\n        `}},Fera.ContentSubmission.Customer.KEY="ContentSubmission_Customer",Fera.ContentSubmission=Fera.ContentSubmission||{},Fera.ContentSubmission.Submitter=class{constructor(e={}){this._opts=e,this.$=Fera.Util.$(),this.urlParams=this._opts.app.opts.urlParams||{},this.$body=this.$("body")}show(e={}){this.customerMessageToken=e.cmt||e.customer_message_token||e.customerMessageToken||this.urlParams.cmt||this.urlParams.customer_message_token||this.urlParams.customerMessageToken,this.contentCampaignToken=e.cct||e.content_campaign_token||e.contentCampaignToken||this.urlParams.cct||this.urlParams.content_campaign_token||this.urlParams.contentCampaignToken,this.productId=e.product||e.product_id||e.productId||this._opts.app.opts.detectProductId(),this.prefilledRating=e.rating||this.urlParams.rating,this.prefilledRating=Number(this.prefilledRating),this.orderId=this.urlParams.order||this.urlParams.order_id||this.urlParams.fera_order_id||this.urlParams.fera_order,this.customerName=this._opts.app.opts.detectCustomerName(),this.customerEmail=this._opts.app.opts.detectCustomerEmail(),this._edit=e.edit||this.urlParams.edit;const t=this._showLoadingState();this.$loadingStateContainer=t.find(".fera-contentSubmission--loading"),e.rt&&(this._reviewToken=e.rt),this._requestTemplate()}hide(e){this._closeWindow(e)}_requestTemplate(){const e={};if(this.customerMessageToken||this.contentCampaignToken)this.customerMessageToken&&(e.customer_message_token=this.customerMessageToken),this.contentCampaignToken&&(e.content_campaign_token=this.contentCampaignToken);else{const t=this.productId||this._opts.app.getProductId();t&&(e.product_id=t)}this.prefilledRating&&(e.rating=this.prefilledRating,this.customerMessageToken&&(e.customer_message_token=this.customerMessageToken),this.contentCampaignToken&&(e.content_campaign_token=this.contentCampaignToken)),this._opts.visitorId&&(e.visitor_id=this._opts.visitorId),this._reviewToken&&(e.review_token=this._reviewToken),this._autoRequestingStoreReview&&(e.auto_requesting_store_review=this._autoRequestingStoreReview),this.reviewType&&(e.review_type=this.reviewType),this._edit&&(e.edit=!0),this._opts.app.opts.testMode&&(e.test=!0),this.orderId&&(e.order_id=this.orderId),this.customerName&&(e.customer_name=this.customerName),this.customerEmail&&(e.customer_email=this.customerEmail),this._opts.app.opts.debugMode&&(e.debug=!0),this._opts.api.requestContentSubmissionTemplate({params:e,success:e=>this._processTemplateResponse(e),error:()=>this._handTemplateErrorResponse()})}_processTemplateResponse(e){if(e.reviewed){const t=this.$(this._getHtml(e.template)),i=this.$loadingStateContainer.find(".fera-container");return i.html(`\n                <div>${t.data("caption-already-submitted-feedback")}</div>\n                <button>${t.data("caption-close-window")}</button>\n            `),void i.find("button").on("click",(()=>this._hideLoadingState()))}e.draft_created&&(this.draft_mode=e.draft_created),this._html=this._getHtml(e.template);const t=e.compiled_css;this._products=e.products,this._totalCount=this._products.length,this._edit?this._previousReview=e.previous_review:this._totalCount<1?this._previousReview=e.previous_store_review:this._previousReview=e.previous_product_review,this._shouldAutoRequestStoreReview=e.auto_request_store_review&&!this._edit,this._alreadyReviewedStore=!!e.previous_store_review,this._requestReview=e.request_review,this._requiredReviewFields=e.required_review_fields,this._requestPhoto=(e.request_media||this._requestReview)&&e.allow_photo,this._requestVideo=(e.request_media||this._requestReview)&&e.allow_video,this.videoFiles=[];const i=this._renderTemplate(this._html,t);this._opts.app.opts.testMode&&i.addClass("fera-testMode"),this._loadCustomTitle(i),this._hideLoadingState(!1),this._initElementsAndListeners(i),this._edit&&this._reviewToken&&this.$submissionForm.append(`<input type="hidden" name="id_token" value="${this._reviewToken}">`),this._opts.app.trigger("submitter.show",{submitter:this})}_handTemplateErrorResponse(){const e=this.$loadingStateContainer.find(".fera-container"),t="We're unable to accept your feedback at this time because of an unexpected error. <br>Our engineers have been notified and we'll have it fixed in no time. Sorry about that! :(";e.html(`<div>${t}</div><button>Close Window</button>`),e.find("button").on("click",(()=>this._hideLoadingState()))}_loadCustomTitle(e){this.customTitle=this._opts.app.opts.feraParams.title||this._opts.app.opts.feraParams.heading||this._opts.app.opts.urlParams.title||this._opts.app.opts.urlParams.heading;const t=e.find(".fera-submissionForm .fera-contentSubmission-title");this.customTitle?t.text(this.customTitle):this._edit&&t.text(t.data("caption-edit"))}_getHtml(e,t={}){if(!e||""===e.trim())return"";try{const i=e.replace(new RegExp(/\s*({%-)/g,"g"),"{%").replace(new RegExp(/(-%})\s*/,"g"),"%}");return t&&Object.keys(t).length>0?Fera.Liquid.parse(i).render(t):i}catch(t){if(this._opts.app.opts.debugMode)throw t;return console.error(t),e}}_renderTemplate(e,t){this.$body.addClass("fera-modal--open");const i=this.$(`<div>${e}</div>`);return this.$body.append(i),this.$body.append(`<style>${t}</style>`),this._$renderedContainers=this._$renderedContainers||[],this._$renderedContainers.push(i),i}_initElementsAndListeners(e=null){e&&(this.$submissionFormContainer=e.find(".fera-submissionForm"),this.$submissionRewardContainer=e.find(".fera-submissionReward"),this.$submissionSuccessContainer=e.find(".fera-submissionSuccess")),this.$submissionForm=this.$submissionFormContainer.find("form"),this.$submissionFormTitle=this.$submissionFormContainer.find(".fera-contentSubmission-title"),this.$viewTermContainer=this.$submissionFormContainer.find(".fera-contentSubmission-termPreview"),this.$viewTermTitle=this.$submissionFormContainer.find(".fera-contentSubmission-termTitle"),this.$ratingInput=this.$submissionForm.find('[name="fera-rating"]'),this.$summaryInput=this.$submissionForm.find('[name="fera-summary"]'),this.$agreedTermInput=this.$submissionForm.find('[name="fera-agreed-terms"]'),this.$bodyInput=this.$submissionForm.find('[name="fera-body"]'),this.$filesInput=this.$submissionForm.find('[name="fera-files"]'),this.$errorContainer=this.$submissionForm.find(".fera-errorContainer"),this.$noticeContainer=this.$submissionForm.find(".fera-noticeContainer"),this.$translationContainer=this.$submissionForm.find(".fera-translatedStringContainer,.fera-translatedStringContainer"),this.$viewTermBtn=this.$submissionForm.find(".fera-viewTerm-Btn"),this.$closeTermBtn=this.$viewTermContainer.find(".fera-contentSubmission-termPreview-closeBtn"),this.$summaryInput.on("change",(()=>{this.$summaryInput.data("fera-modified",!0)})),this.$agreedTermInput.data("term-enabled")&&this.$agreedTermInput.prop("checked",this.$agreedTermInput.data("checked-by-default")),this.$viewTermBtn.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this.showTermModal()})),this.$closeTermBtn.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this.closeTermModal()})),this.$totalCount=this.$submissionFormContainer.find("[data-fera-contentSubmission-info]"),this.$totalCount.html(`${this._totalCount-this._products.length+1} / ${this._totalCount}`),this._totalCount<=1&&this.$totalCount.hide(),this._initReviewSections(),this._initUploadArea(),this._initSubmitAndReviewNextBtns(),this.prefilledRating&&this._applyRating(null,this.prefilledRating),this.draft_mode&&!this._opts.testMode&&this._initDraftTracking(),this.customer=new Fera.ContentSubmission.Customer(this.$.extend({},this._opts,{$container:this.$submissionFormContainer,$translationContainer:this.$translationContainer})),this.customer.name&&(this.customerName=this.customer.name),this.customer.email&&(this.customerEmail=this.customer.email),this.$submissionFormContainer.find("[data-fera-contentSubmission-closeBtn]").on("click",(e=>this._closeWindow(e))),this.$submissionSuccessContainer.find("[data-fera-contentSubmission-closeBtn]").on("click",(e=>this._closeWindow(e))),this.$submissionSuccessContainer.find("[data-fera-contentSubmission-skipBtn]").on("click",(e=>this._closeWindow(e)))}_initUploadArea(){if(!this._requestPhoto&&!this._requestVideo)return void this.$filesInput.closest(".fera-contentSubmission-formControl-uploadRow").remove();const e=this.$submissionForm.find(".fera-uploadLabel");this._requestVideo&&this._requestPhoto?e.text(e.data("caption-photos-or-videos")):this._requestPhoto?e.text(e.data("caption-photos")):e.text(e.data("caption-videos")),this.$filesInput.on("change",(e=>this._onFileChange(e))),this._initDropArea()}_initDropArea(){const e=this.$submissionForm.find(".fera-contentSubmission-formControl-uploadArea");e.on("dragenter dragover",(t=>{t.preventDefault();(t.dataTransfer||t.originalEvent&&t.originalEvent.dataTransfer).dropEffect="copy",e.addClass("fera-dropzone")})),e.on("dragleave drop",(t=>{if(t.preventDefault(),e.removeClass("fera-dropzone"),"drop"===t.type){const e=t.dataTransfer||t.originalEvent&&t.originalEvent.dataTransfer,i=e&&e.files||[];[...i].every((e=>e.type.match(/image|video/)))?(this.$filesInput.prop("files",i).trigger("change"),this.$errorContainer.addClass("fera-hidden")):this.$errorContainer.text(this.$errorContainer.data("caption-only-certain-files-allowed")).removeClass("fera-hidden")}}))}_onFileChange(e){let t="";const i=e.target.files;if(i.length>0){if(this.videoFiles=Array.from(this.$filesInput.prop("files")||[]).filter((e=>e.type.match(/video/))),i.length>1){const e=this.$filesInput.data("caption-files-selected");t=Fera.Liquid.parse(e).render({count:i.length})}else t=i[0].name;1===this.videoFiles.length&&this._loadVideoFileMeta()}this.$submissionForm.find(".fera-uploadLabel").text(t),this.$(".fera-contentSubmission-termRow").removeClass("fera-hidden")}_initReviewSections(){if(!this._requestReview)return void this.$submissionForm.find(".fera-contentSubmission-row").remove();const e=this._products[0];if(e&&e.name){const e=this._products[0],t=`<a class="fera-link" target="_blank" href="${e.url}">${e.name.length<=27?e.name:e.name.substr(0,27)+"..."}</a>`;this.$submissionForm.find(".fera-productTitle").html(t),this.reviewType="product"}else this.$submissionForm.find(".fera-productTitle").closest(".fera-contentSubmission-row").hide(),this.customTitle||this._edit||this.$submissionFormTitle.text(Fera.t("How was your experience?")),this.reviewType="store";this.$submissionForm.find("[data-fera-contentsubmission-star]").on("click",(e=>this._applyRating(e))),this.$summaryInput.focus(),this._previousReview&&!this.$.isEmptyObject(this._previousReview)?(this.$noticeContainer.text(this.$noticeContainer.data("caption-already-reviewed")).removeClass("fera-hidden"),this._populatePreviousReview()):this._opts.app.opts.testMode&&this.$noticeContainer.text("This submission will be marked as a test.").removeClass("fera-hidden")}_initDraftTracking(){var e=Fera.Util.debounce((()=>this._updateDraft()),5e3);this.$ratingInput.on("change",(()=>e())),this.$summaryInput.on("keypress change",(()=>e())),this.$bodyInput.on("keypress change",(()=>e()))}_updateDraft(){if(this.submitting)return;const e=new FormData,t=this._products[0],i=this.$ratingInput.val(),r=this.$bodyInput.val(),n=this.$summaryInput.val();e.append("customer_review[rating]",i||""),e.append("customer_review[heading]",n||""),e.append("customer_review[body]",r||"");const a={visitor_id:this._opts.visitorId,update_draft:!0};this.customerName&&(a.customer_name=this.customerName),this.customerEmail&&(a.customer_email=this.customerEmail),this.orderId&&(a.order_id=this.orderId),
t&&(a.product_id=t.id),this.customerMessageToken&&(a.customer_message_token=t.customer_message_token),this.contentCampaignToken&&(a.content_campaign_token=t.content_campaign_token),this.reviewType&&(a.review_type=this.reviewType),this._opts.api.contentSubmission({data:e,params:a})}showTermModal(){this.$submissionForm.addClass("fera-hidden"),this.$submissionFormTitle.addClass("fera-hidden"),this.$viewTermContainer.removeClass("fera-hidden"),this.$viewTermTitle.removeClass("fera-hidden")}closeTermModal(){this.$submissionForm.removeClass("fera-hidden"),this.$submissionFormTitle.removeClass("fera-hidden"),this.$viewTermContainer.addClass("fera-hidden"),this.$viewTermTitle.addClass("fera-hidden")}clearNotice(){this.$noticeContainer.empty().addClass("fera-hidden")}_applyRating(e,t=null){if(t=t||this.$(e.target).data("rating"),this.$ratingInput.val(t).trigger("change"),this.$submissionForm.find("[data-fera-contentSubmission-star]").each(((e,i)=>{e<t?this.$(i).addClass("fera-star--starred"):this.$(i).removeClass("fera-star--starred")})),1===t&&this.$noticeContainer.data("caption-store-deactivated")){const e=this.$noticeContainer.data("caption-store-deactivated-message");this.$noticeContainer.html(e).removeClass("fera-hidden")}this.$(".fera-contentSubmission-termRow").removeClass("fera-hidden"),this._prefillDefaultMessages(t),e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation())}_prefillDefaultMessages(e){if(this._opts.app.storeSettings&&this._opts.app.storeSettings.autofill_review_headings_disabled)return;if(this._previousReview&&this._previousReview.heading)return;if(this.$summaryInput.data("fera-modified")&&this.$summaryInput.val())return;if(this._opts.app.locale&&"en"!=this._opts.app.locale)return;const t={1:["Really not happy.","No good.","Pretty bad.","No thanks.","Awful","No good.","Not recommended at all!"],2:["Not happy.","Nah.","Probably not again.","Not the best.","Not for me."],3:["Meh.","Not amazing.","Pretty ok.","It's fine.","Mostly good, but...","Decent."],4:["Pretty good!","I dig it!","Solid!","Recommended!","Really, really good.","A very positive experience.","Really nice!","Glad I got this.","Really good!","Quite nice!"],5:["Great!","Fantastic!","Excellent!","Highly recommended!","How great!","Really loved it!","Terrific!","Incredible!","Wonderful!","Marvelous!","Remarkable!","Phenomenal!","Spectacular!","Definitely recommended!","You should get this!"]};this.$summaryInput.val(t[e][Math.floor(4*Math.random())]),this.$summaryInput.data("fera-modified",!1)}_populatePreviousReview(){if(!this._previousReview)return;const{rating:e,heading:t,body:i,agreed_to_terms:r}=this._previousReview;e&&this._applyRating(null,e),t&&this.$summaryInput.val(t),i&&this.$bodyInput.val(i),r&&this.$agreedTermInput.prop("checked",r)}_initSubmitAndReviewNextBtns(){this.$submissionForm.find("[data-fera-contentSubmission-submitBtn]").on("click",(e=>this._submitForm(e))),this.$submissionSuccessContainer.find("[data-fera-contentSubmission-reviewNextBtn]").on("click",(e=>this._reviewNextItem(e)))}_submitForm(e){e.preventDefault(),this.$errorContainer.addClass("fera-hidden"),this.clearNotice(),this.submitting=!0;const t=this.$(e.target),i=new FormData,r=Array.from(this.$filesInput.prop("files")||[]),n=this._products[0],a=this.$ratingInput.val(),o=this.$bodyInput.val(),s=!!o,c=this.$summaryInput.val(),u=!!c,l=this.$agreedTermInput.data("term-enabled"),d=this.$agreedTermInput.is(":checked"),p=5,h=1;if(r.length>p){const e=Fera.Liquid.parse(this.$errorContainer.data("caption-max-files-reached")).render({limit:p});return this.$errorContainer.text(e).removeClass("fera-hidden")}if(this.videoFiles.length>h){const e=Fera.Liquid.parse(this.$errorContainer.data("caption-one-video-allowed")).render({limit:h});return this.$errorContainer.text(e).removeClass("fera-hidden")}if(this.videoFiles.length){const e=this._getVideoDurationValidationErrorMsg(this.videoFiles[0]);if(e)return this.$errorContainer.text(e).removeClass("fera-hidden")}if(this._requestReview&&!a)return this.$errorContainer.text(this.$errorContainer.data("caption-rating-required")).removeClass("fera-hidden");if(this._requestReview&&this._requiredReviewFields&&this._requiredReviewFields.heading&&!u)return this.$errorContainer.text(this.$errorContainer.data("caption-heading-required")).removeClass("fera-hidden");if(this._requestReview&&this._requiredReviewFields&&this._requiredReviewFields.body&&!s)return this.$errorContainer.text(this.$errorContainer.data("caption-body-required")).removeClass("fera-hidden");if(this._requestReview&&l&&!d)return this.$errorContainer.text(this.$errorContainer.data("caption-agreed-terms-required")).removeClass("fera-hidden");if(!this._requestReview&&(this._requestVideo||this._requestPhoto)&&r.length<=0)return this.$errorContainer.text(this.$errorContainer.data("caption-files-required")).removeClass("fera-hidden");t.text(Fera.t("Loading...")),t.prop("disabled",!0),i.append("submission_details",JSON.stringify({submitted_via:"legacy submitter"})),i.append("customer_review[rating]",a||""),i.append("customer_review[heading]",c||""),i.append("customer_review[body]",o||""),l&&i.append("customer_review[agreed_to_terms]",d),r.forEach((e=>{i.append("customer_review[files][]",e,e.name.replace(/\s+/g,"-"))}));const f={visitor_id:this._opts.visitorId};this.customerName&&(f.customer_name=this.customerName),this.customerEmail&&(f.customer_email=this.customerEmail),n&&n.id&&(f.product_id=n.id),this.customerMessageToken&&(f.customer_message_token=this.customerMessageToken),this.contentCampaignToken&&(f.content_campaign_token=this.contentCampaignToken),this._edit&&this._reviewToken&&(f.id_token=this._reviewToken),this.reviewType&&(f.review_type=this.reviewType),this._opts.app.opts.testMode&&(f.test=!0),this.orderId&&(f.order_id=this.orderId),this._opts.api.contentSubmission({data:i,params:f,success:this._onContentSubmitted.bind(this),error:e=>{const i=this._genErrorMessage(e);this.$errorContainer.text(i).removeClass("fera-hidden"),t.text(Fera.t("Submit")),t.prop("disabled",!1)}})}_genErrorMessage(e){let t;try{t=JSON.parse(e.response)}catch(t){Fera.logger.warn(`ERROR! Content from server was NOT JSON. Error was: ${t.message}. Response was: ${e.response}  ...`)}if(t){if(t.duration)return this.$errorContainer.data("caption-video-min-duration-required");if(t.error||t.errors){let e=t.error||t.errors;return Array.isArray(e)&&(e=e[0]),e}if(t.file&&this.$.isArray(t.file))return t.file[0].match(/less than|smaller than/)?`Uploads ${t.file[0]}. Please try another file.`:`Your file could not be uploaded because it ${t.file[0]}.`;{const e=Object.keys(t);if(e.length>0){let i=e[0];return i=Fera.Util.toTitleCase(i.replace(/_/g," ")),`${i} ${t[e[0]]}. Please try another file.`}}}return this.$errorContainer.data("caption-server-error")}_getVideoDurationValidationErrorMsg(e){return e.duration<5?Fera.Liquid.parse(this.$errorContainer.data("caption-video-min-duration-required")).render({duration:5}):e.duration>300?Fera.Liquid.parse(this.$errorContainer.data("caption-video-max-duration-exceeded")).render({duration:5}):null}_loadVideoFileMeta(){const e=document.createElement("video");e.preload="metadata",e.onloadedmetadata=()=>{window.URL.revokeObjectURL(e.src),this.videoFiles[0].duration=e.duration},e.src=URL.createObjectURL(this.videoFiles[0])}_onContentSubmitted(e){e.created_store_review&&(this._alreadyReviewedStore=!!e.created_store_review),this._opts.app.trigger("submitter.submit",{submitter:this}),e.has_customer||this.customer.isPresent()?this._checkForNextReview():(this.customer.update(e.content_submission_token,this._checkForNextReview.bind(this)),this.customer.requestDetails())}_checkForNextReview(){if(this._products.shift(),this._autoRequestingStoreReview=!1,this._products.length>0&&this.$ratingInput.val()>1)this.$submissionSuccessContainer.removeClass("fera-hidden"),window.__feraTestMode?(this.$submissionRewardContainer.hide(),this.$submissionFormContainer.hide(),this.$submissionSuccessContainer.show()):(this.$submissionRewardContainer.fadeOut(),this.$submissionFormContainer.fadeOut(),this.$submissionSuccessContainer.fadeIn());else{if(!this._alreadyReviewedStore&&this._shouldAutoRequestStoreReview&&this.$ratingInput.val()>1)return this._closeFormAndPromptStoreReview();this._closeFormAndShowReward()}this._opts.app.trigger("submitter.complete",{submitter:this})}_closeFormAndShowReward(){this.$submissionRewardContainer.removeClass("fera-hidden"),window.__feraTestMode?(this.$submissionFormContainer.hide(),this.$submissionRewardContainer.show()):(this.$submissionFormContainer.fadeOut(),this.$submissionRewardContainer.fadeIn()),this.$submissionRewardContainer.find("[data-fera-contentSubmission-closeBtn]").on("click",(e=>this._closeWindow(e))),this.$submissionRewardContainer.find("[data-fera-contentSubmission-closeWindowBtn]").on("click",(e=>this._closeWindow(e)))}_closeFormAndPromptStoreReview(){window.__feraTestMode?(this.$submissionRewardContainer.hide(),this.$submissionFormContainer.hide()):(this.$submissionRewardContainer.fadeOut(),this.$submissionFormContainer.fadeOut()),this._totalCount=0,this._previousReview={},this._reviewToken=null,this.$submissionSuccessContainer.find("[data-fera-contentSubmission-reviewNextBtn]").text(Fera.t("Review The Store")),this.$submissionSuccessContainer.find("[data-fera-contentSubmission-skipBtn]").removeClass("fera-hidden"),this._autoRequestingStoreReview=!0,this.$submissionSuccessContainer.removeClass("fera-hidden"),window.__feraTestMode?this.$submissionSuccessContainer.show():this.$submissionSuccessContainer.fadeIn()}_closeWindow(e){this.$submissionFormContainer.remove(),this.$submissionRewardContainer.remove(),this.$submissionSuccessContainer.remove(),this.$loadingStateContainer.remove(),this.$(".fera-contentSubmission--overlay").remove(),this.$body.removeClass("fera-modal--open"),e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation()),this._opts.app.trigger("submitter.hide",{submitter:this})}_reviewNextItem(e){window.__feraTestMode?(this.$submissionSuccessContainer.hide(),this.$submissionFormContainer.show()):(this.$submissionSuccessContainer.fadeOut(),this.$submissionFormContainer.fadeIn());const t=this.$(this._html).find("form");this.$submissionForm.replaceWith(t),this._initElementsAndListeners(),e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation())}_redirectToHomeOrProductPage(){let e="/";this._products&&this._products.length>0&&(e=this._products[0].url),location.href=e}_showLoadingState(){const e='\n      <div class="fera-contentSubmission--overlay"></div>\n      <div class="fera-contentSubmission--loading">\n        <div class="fera-contentSubmission-modal">\n            <div class="fera-contentSubmission-loading">\n                <div class="fera-container">\n                    <div>\n                        <svg aria-hidden="true" height="20" focusable="false" data-prefix="fad" data-icon="spinner-third" class="fera-spinner" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g class="fa-group"><path class="fa-secondary" fill="currentColor" d="M478.71 364.58zm-22 6.11l-27.83-15.9a15.92 15.92 0 0 1-6.94-19.2A184 184 0 1 1 256 72c5.89 0 11.71.29 17.46.83-.74-.07-1.48-.15-2.23-.21-8.49-.69-15.23-7.31-15.23-15.83v-32a16 16 0 0 1 15.34-16C266.24 8.46 261.18 8 256 8 119 8 8 119 8 256s111 248 248 248c98 0 182.42-56.95 222.71-139.42-4.13 7.86-14.23 10.55-22 6.11z" opacity="0.4"></path><path class="fa-primary" fill="currentColor" d="M271.23 72.62c-8.49-.69-15.23-7.31-15.23-15.83V24.73c0-9.11 7.67-16.78 16.77-16.17C401.92 17.18 504 124.67 504 256a246 246 0 0 1-25 108.24c-4 8.17-14.37 11-22.26 6.45l-27.84-15.9c-7.41-4.23-9.83-13.35-6.2-21.07A182.53 182.53 0 0 0 440 256c0-96.49-74.27-175.63-168.77-183.38z"></path></g></svg>\n                    <div>\n                </div>\n            </div>\n        </div>\n      </div>\n    ',t="\n       body.fera-modal--open {\n         overflow: hidden !important;\n       }\n       @keyframes fera-spin {\n         from { transform:rotate(0deg); }\n         to { transform:rotate(360deg); }\n       }\n      .fera-spinner {\n        animation-name: fera-spin;\n        animation-duration: 1500ms;\n        animation-iteration-count: infinite;\n        animation-timing-function: linear;\n      }\n      .fera-contentSubmission-modal {\n        height: 100%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        padding: 10px;\n        color: #1E2139;\n      }\n      .fera-contentSubmission-loading,\n      .fera-contentSubmission {\n        position: relative;\n        background-color: white;\n        padding: 50px 45px 50px;\n        border-radius: 5px;\n        box-shadow: 0px 3px 20px rgba(0, 0, 0, 0.2);\n        width: 100%;\n        max-width: 500px;\n        max-height: 90vh;\n        display: flex;\n        justify-content: center;\n        flex-direction: column;\n        z-index: 9999999;\n      }\n      .fera-contentSubmission--overlay,\n      .fera-submissionForm,\n      .fera-submissionReward,\n      .fera-submissionSuccess,\n      .fera-contentSubmission--loading {\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        position: fixed;\n        z-index: 9999999;\n      }\n\n      .fera-contentSubmission-termTitle {\n        font-size: 29px;\n        font-weight: bold;\n        letter-spacing: 1px;\n      }\n\n      .fera-contentSubmission-termPreview-content {\n        overflow-y: scroll;\n        max-height: 45vh;\n      }\n\n      .fera-contentSubmission-termPreview-content h1,\n      .fera-contentSubmission-termPreview-content h2,\n      .fera-contentSubmission-termPreview-content h3,\n      .fera-contentSubmission-termPreview-content h4,\n      .fera-contentSubmission-termPreview-content h5,\n      .fera-contentSubmission-termPreview-content h6,\n      .fera-contentSubmission-termPreview-content p,\n      .fera-contentSubmission-termPreview-content li {\n        margin: 0 0 16px;\n        padding: 0;\n        font-size: 16px;\n      }\n      .fera-contentSubmission-termPreview-content ul {\n        list-style-type: disc;\n        margin: 0 0 16px;\n      }\n\n      .fera-contentSubmission-termPreview-closeBtn {\n        background: #00070c;\n        color: white;\n        margin-top: 32px;\n        width: 112px;\n        height: 40px;\n        outline: none;\n        border: none;\n        border-radius: 3px;\n        text-align: center;\n        font-weight: bold;\n        letter-spacing: 1px;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n      }\n\n      .fera-contentSubmission-termPreview-closeBtn span {\n        margin-left: 6px;\n      }\n\n      .fera-contentSubmission--overlay {\n        background: rgba(0,0,0,0.3);\n        z-index: 9999998;\n      }\n\n      .fera-contentSubmission-loading .fera-container {\n        text-align: center;\n        font-size: 20px;\n      }\n      .fera-contentSubmission-loading button {\n        color: white;\n        border: none;\n        padding: 12px 20px;\n        border-radius: 5px;\n        font-size: 14px;\n        background-color: #1E2139;\n        margin-top: 40px;\n      }\n      .fera-contentSubmission-loading button:hover {\n        background-color: black;\n      }\n      .fera-hidden {\n        display: none !important;\n      }\n      @media(max-width: 480px) {\n        .fera-contentSubmission {\n            width: 100%;\n            margin: 0;\n            max-height: 100%;\n            border-radius: 0;\n            padding: 42px 32px 42px;\n        }\n\n        .fera-contentSubmission-termTitle {\n            font-size: 24px;\n        }\n    }\n    ";return this._renderTemplate(e,t)}_hideLoadingState(e=!0){this.$loadingStateContainer.addClass("fera-hidden"),e&&this._redirectToHomeOrProductPage()}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.Base=class extends Fera.Components.Base{constructor(e){super(e),this.app=e.app,this.$=Fera.Util.$(),this.totalReviewCount=e.totalReviewCount||0,this.isSubmitHidden=void 0!==e.isSubmitHidden&&e.isSubmitHidden,this.prefix=e.prefix||"fera-productReviews",this.layoutCode=e.layoutCode||"list",this.pageSize=e.pageSize||5,this.paginationMode=e.paginationMode,this.sortBy=e.sortBy||"most_recent",this.tplVars=e.tplVars||{},this.reviewOptions=e.reviewOptions||{},e.template&&(this.prerendered=!0,this.$el=e.template,this._initialize()),this._triggerDebouncedResize=Fera.Util.debounce((()=>this._updateWidthClass()),100),this.$(window).on("resize",(()=>this._triggerDebouncedResize())),setInterval((()=>this._updateWidthClass(!0)),500)}render(){if(this.prerendered)return this.$el;var e=this._renderTpl(this._tpl(),this.tplVars);return this.$el=this.$(e),this._initialize(),this.$el}clear(){this.reviewList.clear()}refresh(){this.reviewList.refresh()}forceInitialLoad(){this.reviewList.forceInitialLoad()}_updateWidthClass(e=!1){if(e&&this._resizedByTimer)return!1;this.$el&&this.$el.length>0&&(this.$el.toggleClass("fera-container--thin",this.$el.width()<576),this.$el.toggleClass("fera-container--wide",this.$el.width()>1440),this._resizedByTimer=e)}_initialize(){this.$totalReviewCount=this.$el.find(`.${this.prefix}-count-total`),this.$headerTitle=this.$el.find(`.${this.prefix}-heading-header`),this.$el.toggleClass(`${this.prefix}--list`,"list"==this.layoutCode),this.$el.toggleClass(`${this.prefix}--grid`,"grid"==this.layoutCode),this._setupWriteReview(),this._setupReviewList(),Fera.t(this.$headerTitle),this._updateCountDependentDisplays(this.totalReviewCount),this._updateWidthClass()}_setupWriteReview(){this.$writeReview=this.$el.find('[data-fera-action="showContentSubmission"]'),this.$writeReview.each(((e,t)=>{const i=this.$(t);Fera.t(i),i.data("fera-deep-link-attached")||(i.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this.app.showContentSubmission()})),i.data("fera-deep-link-attached",!0))})),this.$el.toggleClass(`${this.prefix}--submitHidden`,!!this.isSubmitHidden)}_setupReviewList(){this.reviewListOpts=this.reviewListOpts||{},this.prerendered&&(this.reviewListOpts.template=this.$el),this.reviewList=new Fera.CustomerResources.CustomerReviews.List(this.reviewListOpts),this.reviewList.on("listUpdate",((e,t)=>{this._updateCountDependentDisplays(t)})),this.prerendered||(this.$body=this.$el.find(`.${this.prefix}-content`),this.$body.append(this.reviewList.render()))}_updateCountDependentDisplays(e){this._updateReviewCountStr(e),this._updateSeoAttributes(e)}_updateSeoAttributes(e){}static removeSeoAttributes(e){var t=Fera.Util.$();e.removeAttr("itemprop").removeAttr("itemtype").removeAttr("itemscope"),e.find("[itemprop],[itemtype],[itemscope]").each(((e,i)=>{t(i).removeAttr("itemprop").removeAttr("itemtype").removeAttr("itemscope")}))}_updateReviewCountStr(e){var t;if(!(this.$totalReviewCount.length<1||(this.$countStr?(this.$countStr.remove(),t=this.$countStr.find(`.${this.prefix}-reviewCount,[itemprop="reviewCount"]`)):t=this.$totalReviewCount.find(`.${this.prefix}-reviewCount,[itemprop="reviewCount"]`),t.length<1))){t.get(0).innerHTML=e;var i=Fera.Liquid.parse(Fera.t("{{ review_count }} review{% if review_count != 1 %}s{% endif %}")).render({review_count:e});this.$countStr=this.$(`<span class="${this.prefix}-count-total-str">${i.replace(e,t.get(0).outerHTML)}</span>`),t.remove(),this.$totalReviewCount.append(this.$countStr)}}_renderTpl(e,t){var i=e.replace(new RegExp(/\s*({%-)/g,"g"),"{%").replace(new RegExp(/(-%})\s*/,"g"),"%}").trim();if(!i)return Fera.logger.error("Template is empty or not valid.",e,t),"";var r=Fera.Liquid.parse(i);return r?r.render(t):(Fera.logger.error("Failed to parse template: ",r,t),"")}_tpl(){console.error("Fera.CustomerResources.CustomerReviews.Base template was not implemented.")}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.AllReviews=class extends Fera.CustomerResources.CustomerReviews.Base{constructor(e){super(e)}_setupReviewList(){this.reviewListOpts={app:this.app,singleProduct:!1,layoutCode:this.layoutCode,pageSize:this.pageSize,paginationMode:this.paginationMode,sortBy:this.sortBy,totalReviewCount:this.totalReviewCount,reviewOptions:this.reviewOptions,typesToShow:this._opts.typesToShow,prefix:this.prefix},super._setupReviewList()}_updateSeoAttributes(e){this.$el&&this.constructor.removeSeoAttributes(this.$el)}_tpl(){return'<div class="fera-allReviews">\n            <div class="fera-allReviews-heading">\n                <div class="fera-allReviews-heading-col1">\n                    <h2 class="fera-allReviews-heading-header">{{ header }}</h2>\n                    <a href="#" class="text-link fera-allReviews-writeReviewLink" data-fera-action="showContentSubmission">Write a review</a>\n                </div>\n                <div class="fera-allReviews-heading-col2" itemscope itemtype="http://schema.org/AggregateRating" itemprop="aggregateRating">\n                    <div class="fera-allReviews-totals-col1">\n                        <div class="fera-allReviews-avgRating">\n                            <span itemprop="ratingValue" class="h1 fera-allReviews-avgRating-val" data-value="{{ average_rating }}">{{ average_rating }}</span>\n                        </div>\n                    </div>\n                    <div class="fera-allReviews-totals-col2">\n                        <div class="fera-allReviews-avgRating-stars">\n                            {% if ratings_enabled %}\n                            <div class="fera-stars fera-allReviews-stars"\n                                 data-rating="{{ average_rating }}">\n                                <div class="fera-stars-rating fera-allReviews-stars-rating" style="width: {{ average_rating | divided_by: 0.05 }}%;">\u2605\u2605\u2605\u2605\u2605</div>\n                                <div class="fera-stars-bg fera-allReviews-stars-bg"></div>\n                            </div>\n                            {% endif %}\n                        </div>\n                        <div class="fera-allReviews-count">\n                            <div class="fera-allReviews-count-total" data-value="{{ review_count }}">\n                                <span itemprop="reviewCount">{{ review_count || 0 }}</span>\n                                <span itemprop="ratingCount" style="display: none;">{{ review_count || 0 }}</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="fera-allReviews-content"></div>\n        </div>'}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerMedia=class extends Fera.Components.Base{constructor(e={}){super(e),this.app=e.app,this.singleProduct=!!e.singleProduct,this.$=Fera.Util.$(),this.options=e.options,this.$el=e.$template,this._initialize()}refresh(){this.offset=0,this._setLimit(),this.customerMedia=[],this.clear(),this._fetchNextPage()}_setLimit(){this.isMobile=this.$el.width()<=500,this.limit=this.isMobile?this.options.max_to_show_on_mobile:this.options.max_to_show_on_desktop,"string"==typeof this.limit&&(this.limit=parseInt(this.limit)),this.limit=this.limit||6}clear(){this.$customerMediaContent.empty(),this.renderer.reset()}_initialize(){this._setupHeader(),this._setupCustomerMediaContent(),this._setupLoadMore(),this.renderer=new Fera.CustomerResources.CustomerMedia.Renderer({$el:this.$customerMediaContent,themeCode:this.options.theme_code}),this.renderer.on("limit:change",((e,t)=>{if(this.isMobile)return this.limit=4;this.limit=t})),this._refreshOnWindowResize()}_refreshOnWindowResize(){this.previousWidth=this.windowWidth;const e=Fera.Util.debounce((()=>{const e=this.windowWidth;Math.abs(this.previousWidth-e)>20&&this.refresh(),this.previousWidth=e}),300);this.$(window).on("resize",(()=>e()))}get windowWidth(){return document.body.offsetWidth||this.$(window).width()}get _headers(){return{media:"Customer Photos & Videos",photos:"Customer Photos",videos:"Customer Videos"}}_setupHeader(){this.$header=this.$el.find(".fera-customerMedia-header"),this.$header.toggleClass("fera-hidden",!this.options.header_enabled);let e="";this.options.images_enabled&&this.options.videos_enabled?e="media":this.options.images_enabled?e="photos":this.options.videos_enabled&&(e="videos"),Object.values(this._headers).includes(this.options.header)?this.$header.text(this._headers[e]):this.$header.text(this.options.header)}_setupCustomerMediaContent(){this.$customerMediaContent=this.$el.find(".fera-customerMedia-content"),this.$noCustomerMedia=this.$el.find(".fera-customerMedia-noCustomerMedia")}_setupLoadMore(){this.$footer=this.$el.find(".fera-customerMedia-footer"),this.$spinner=this.$el.find(".fera-loading-spinner").clone().removeClass("fera-hidden"),this.$loadMoreBtn=this.$el.find(".fera-customerMedia-loadMoreBtn"),this.$loadMoreBtn.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this._fetchNextPage()}))}_fetchNextPage(){const e={offset:this.offset,limit:this.limit,only_photos:this.options.images_enabled&&!this.options.videos_enabled,only_videos:this.options.videos_enabled&&!this.options.images_enabled,media_source:this.options.media_source,cache_key:this.singleProduct?"product":"store"},t=this._opts.productId||this.app.getProductId();if(this.singleProduct&&void 0!==t&&t.trim().length>0&&(e.product_id=t),"choose"===this.options.media_source){let t=this.options.media_ids;t="string"==typeof t?JSON.parse(t):t,e.media_ids=t.length>0?t:[-1],e.product_id=null}this.$loadMoreBtn.html(this.$spinner).append(Fera.t("Loading...")).prop("disabled",!0),this.app.api.getCustomerMedia(e,((e,t)=>{if(this.totalCount=t,this.totalCount<1)this.clear(),this.$noCustomerMedia.removeClass("fera-hidden"),"hide"!==this.options.when_no_media||this.app.opts.testMode||this.$el.hide();else{this.customerMedia=[...this.customerMedia,...e],this.offset=this.customerMedia.length;const t=this.totalCount>this.customerMedia.length;this.renderer.render(e,t)}this.$loadMoreBtn.text(Fera.t("Show More")).prop("disabled",null),this.$footer.toggleClass("fera-hidden",!this._showLoadMore())}))}_showLoadMore(){return!!this.customerMedia&&this.customerMedia.length<this.totalCount}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerMedia=Fera.CustomerResources.CustomerMedia||{},Fera.CustomerResources.CustomerMedia.Item=class extends Fera.Components.Base{constructor(e={}){super(e),this.$=Fera.Util.$(),this.model=e.model,this.model.is_imported&&(this.integrationType=this.model.integration_type),this.imageViewer=e.imageViewer,this.videoViewer=e.videoViewer}get _isPhoto(){return"photo"===this.model.type}render(){return super.render(),this.$el=this.$(this._tpl()),this.$el}_afterRenderComplete(){let e=this.$el;this._isPhoto?this.imageViewer.init(e):(e=this.$el.find(".fera-customerMedia-videoThumbnail-clickableArea"),this.videoViewer.init(e))}_imageTpl(){return`<img class="fera-customerMedia-imageThumbnail fera-customerMedia-thumbnail" id="${this.model.id}" src="${this.model.image_thumbnail_url}" alt="${this.model.caption}" data-image-url="${this.model.image_url}" itemscope itemtype="https://schema.org/Photograph" />`}videoThumbnailOrPlaceholderTpl(){return!this.model.video_thumbnail_url&&this.model.is_imported?this._importedVideoTpl(this.integrationType):`\n            <img class="fera-customerMedia-videoThumbnail" src="${this.model.video_thumbnail_url}" alt="${this.model.caption}" itemscope itemtype="https://schema.org/Photograph" />\n        `}_importedVideoTpl(e){const t=this._prepareImportedVideoUrl(this.model.video_url,e);return["youtube","vimeo","instagram"].includes(e)?`<iframe class="fera-customerMedia-videoThumbnail fera-customerMedia-video" width="100" height="100" src="${t}"\n                    frameborder="0" allow="accelerometer; autoplay; picture-in-picture"\n                    allowfullscreen></iframe>`:`<video class="fera-customerMedia-videoThumbnail fera-customerMedia-video" width="100" height="100" src="${t}#t=0.001" alt="${this.model.caption}"></video>`}_prepareImportedVideoUrl(e,t){if("url"===t)return e;({youtube:/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube\.com|youtu\.be))(\/(?:[\w-]+\?v=|embed\/|v\/)?)([\w-]+)(\S+)?$/,facebook:/^(?:(?:https?:)?\/\/)?(?:(www|web|m)\.)?(facebook|fb)\.com\/[a-zA-Z0-9.]+\/videos\/(?:[a-zA-Z0-9.]+\/)?([0-9]+)/,vimeo:/(http|https)?:\/\/(www\.|player\.)?vimeo\.com\/(?:(channels|video)\/(?:\w+\/)?|groups\/([^/]*)\/videos\/|)(\d+)(?:|\/\?)/,instagram:/(https?:\/\/(?:www\.)?instagram\.com\/p\/([^/?#&]+)).*/})[t].test(e);return"youtube"===t?e=`https://www.youtube.com/embed/${RegExp.$5}`:"vimeo"===t?e=`https://player.vimeo.com/video/${RegExp.$5}`:"instagram"===t&&(e=`https://www.instagram.com/p/${RegExp.$2}/embed`),e}_videoTpl(){return`\n            <figure class="fera-customerMedia-videoThumbnailWrapper fera-customerMedia-thumbnail" id="${this.model.id}">\n                <div\n                    class="fera-customerMedia-videoThumbnail-clickableArea"\n                    data-video-url="${this.model.video_url}"\n                    ${this.integrationType?`data-video-type="${this.integrationType}"`:""}\n                    data-video-is-imported="${this.model.is_imported}"\n                ></div>\n                ${this.videoThumbnailOrPlaceholderTpl()}\n                <div class="fera-customerMedia-videoThumbnail-playButtonWrapper ${this.integrationType||""}">\n                    <svg class="fera-customerMedia-videoThumbnail-playButton" width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n                        <path d="M0 15.223V1.77702C0 0.99739 0.852556 0.517624 1.51898 0.922237L12.5921 7.64521C13.2335 8.03461 13.2335 8.96539 12.5921 9.35479L1.51898 16.0778C0.852556 16.4824 0 16.0026 0 15.223Z" fill="black" fill-opacity="0.8"/>\n                    </svg>\n                </div>\n            </figure>\n        `}_tpl(){return"photo"===this.model.type?this._imageTpl():this._videoTpl()}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerMedia=Fera.CustomerResources.CustomerMedia||{},Fera.CustomerResources.CustomerMedia.Renderer=class extends Fera.Components.Base{constructor(e={}){super(e),this.$el=e.$el,this.$=Fera.Util.$(),this.themeCode=e.themeCode,this.customerMedia=[],this.previousCustomerMedia=[],this.imageViewer=new Fera.ImageViewer,this.videoViewer=new Fera.VideoViewer,this.hasMoreItems=!0}render(e,t){this.customerMedia=e,this.hasMoreItems=t,this._usePreviousAndCurrentMedia(),this._renderItems()}reset(){this.$el.empty(),this.previousItemsCountPerRow=null,this.firstRowFilled=!1,this.hasMoreItems=!0,this.previousCustomerMedia=[]}_usePreviousAndCurrentMedia(){this.firstRowFilled||(this.customerMedia=[...this.previousCustomerMedia,...this.customerMedia],this.previousCustomerMedia=[...this.customerMedia],this.$el.empty())}get _minItemWidths(){return{"customer_media.default":121,"customer_media.padded":170,"customer_media.rounded":145,"customer_media.circles":145}}_renderItems(){if(this.customerMedia&&!(this.customerMedia.length<1)){for(this.containerWidth=this.$el[0].offsetWidth||this.$el.width(),this.itemsCount=this.customerMedia.length,this.minItemWidth=this._minItemWidths[this.themeCode]||121,this.itemSpacing=this._getItemSpacing()||0,this.itemSpacing&&(this.minItemWidth+=this.itemSpacing),this.rowsCount=1,this.itemsCountPerRow=Math.round(this.itemsCount/this.rowsCount);this.containerWidth/this.itemsCountPerRow<this.minItemWidth;)this.rowsCount+=1,this.itemsCountPerRow=Math.round(this.itemsCount/this.rowsCount);[...Array(this.rowsCount).keys()].forEach((e=>this._renderRow(e)))}}_renderRow(e){const t=e*this.itemsCountPerRow,i=t+this.itemsCountPerRow;let r=this.customerMedia.slice(t,i);e+1===this.rowsCount&&(r=this.customerMedia.slice(t),this.itemsCountPerRow=this.hasMoreItems||r.length>this.previousItemsCountPerRow?r.length:this.previousItemsCountPerRow);const n=this.$(this._rowTpl());this._render(r,n),this.itemSpacing&&n.find(".fera-customerMedia-thumbnail").css({marginRight:this.itemSpacing}),this._resizeRowItems(n),this.$el.append(n),this.previousItemsCountPerRow=this.itemsCountPerRow}_resizeRowItems(e){let t=this.containerWidth/this.itemsCountPerRow;this.firstRowFilled||(t>2*this.minItemWidth&&(t=2*this.minItemWidth),t*this.itemsCountPerRow>=this.containerWidth&&(this.firstRowFilled=!0,this.trigger("limit:change",this.itemsCountPerRow))),this.itemSpacing&&(t-=this.itemSpacing,e.css({marginTop:this.itemSpacing})),e.find(".fera-customerMedia-thumbnail").css({width:`${t}px`,height:`${t}px`})}_getItemSpacing(){
const e=this.$el.css("grid-gap");if(!e)return;const t=e.split("px")[0];return t?parseInt(t):void 0}_render(e,t){e.forEach((e=>{const i=new Fera.CustomerResources.CustomerMedia.Item({model:e,imageViewer:this.imageViewer,videoViewer:this.videoViewer});t.append(i.render())}))}_rowTpl(){return'<div class="fera-customerMedia-content-row"></div>'}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.ProductReviews=class extends Fera.CustomerResources.CustomerReviews.Base{constructor(e){super(e),this.prerendered&&this._tryToTranslateHeader()}_setupReviewList(){this.reviewListOpts={app:this.app,singleProduct:!0,productId:this._opts.productId,layoutCode:this.layoutCode,pageSize:this.pageSize,sortBy:this.sortBy,totalReviewCount:this.totalReviewCount,reviewOptions:this.reviewOptions,paginationMode:this.paginationMode,prefix:this.prefix,typesToShow:"product"},super._setupReviewList()}_tryToTranslateHeader(){this.$header=this.$el.find(".fera-productReviews-heading-header"),Fera.t(this.$header)}_updateSeoAttributes(e){if(super._updateSeoAttributes(e),e>0){this.constructor.addReviewDataToSeoScripts(this.$el);const e=this.$el.parents("[itemType]");(e.length<1||!e.first().attr("itemType").match(/\/Product$/))&&(this.constructor.copySeoAttributesToProductContext(this.$el),Fera.CustomerResources.CustomerReviews.Base.removeSeoAttributes(this.$el)),this.constructor.removeDuplicateAggregateRatingSeoAttr()}else Fera.CustomerResources.CustomerReviews.Base.removeSeoAttributes(this.$el)}static copySeoAttributesToProductContext(e){e=e.first();const t=Fera.Util.$();this.repairProductSchemas();const i=t('[itemType*="/Product"][itemscope]');if(i.length<1)return Fera.logger.log("Tried to copy object to optimize for SEO but could not find parent product SEO item type."),!1;if(i.length>0){const t=e.clone();t.hide(),t.removeAttr("class").removeAttr("data-fera-skill").removeAttr("data-fera-widget").removeAttr("id"),t.find("[class]").removeAttr("class").removeAttr("id"),i.first().append(t)}return!0}static repairProductSchemas(){const e=Fera.Util.$(),t=e('[itemType*="/Product"]:not([itemscope])');t.length<1||t.each(((t,i)=>{const r=e(i);if(r.find('[itemProp="name"]').length<1)return;r.attr("itemscope","");const n=r.find('[itemType*="/Offer"]:not([itemscope])');n.length<1||n.each(((t,i)=>{e(i).attr("itemscope","")}))}))}static addReviewDataToSeoScripts(e){const t=Fera.Util.$(),i=t('script[type="application/ld+json"]');i.length<1?Fera.logger.log("Could not find any SEO script definitions."):i.each(((i,r)=>{const n=t(r),a=n.html().replace(/[\n\t\r]/g," ").trim();if(!a)return;let o;try{o=JSON.parse(a)}catch(e){Fera.logger.log("Encountered an error while trying to parse JSON for application/ld+json. Reading will be skipped.",e,n)}if(!o)return void Fera.logger.warn("Failed to properly parse your application/ld+json. This could indicate that your site code/theme is not properly handling SEO elements. Contact our team for help.");if(!o["@type"])return;if(!o["@type"].match(/Product$/))return;o.aggregateRating=o.aggregateRating||{},o.aggregateRating["@type"]="AggregateRating";const s=e.find('[itemprop="aggregateRating"] '),c=s.find('[itemprop="ratingValue"]').text(),u=s.find('[itemprop="ratingCount"]').text(),l=s.find('[itemprop="reviewCount"]').text();c&&(o.aggregateRating.ratingValue=c.trim()),u&&(o.aggregateRating.ratingCount=u.trim()),l&&(o.aggregateRating.reviewCount=l.trim()),o.review=o.review||[],o.aggregateRating.reviewCount||o.aggregateRating.ratingCount||delete o.aggregateRating,o.aggregateRating&&e.find('[itemprop="review"]').each(((e,i)=>{const r=t(i),n=r.find('[itemprop="datePublished"]').attr("content"),a=r.find('[itemprop="author"]').text(),s=r.find('[itemprop="ratingValue"]').text(),c=r.find('[itemprop="description"]').text()||"";if(!n||!a)return;if(o.review.find((e=>e.datePublished==n.trim()&&e.author==a.trim())))return;const u={"@context":"https://schema.org/","@type":"Review",datePublished:n,author:{"@type":"Person",name:a},reviewBody:c.trim(),reviewRating:{"@type":"Rating"}};s&&(u.reviewRating.ratingValue=s.trim()),u.reviewBody&&o.review.push(u)})),n.text(JSON.stringify(o))}))}static removeDuplicateAggregateRatingSeoAttr(){const e=Fera.Util.$(),t=e('[itemType*="Product"]').find('[itemType*="AggregateRating"]');e('script[type="application/ld+json"]');if(t.length>0){let i;t.each(((t,r)=>{const n=e(r),a=n.parents("[itemType]").first();a&&a.attr("itemType").match(/\/Product$/)&&!i?i=n:Fera.CustomerResources.CustomerReviews.Base.removeSeoAttributes(n)}))}return!0}_tpl(){return'<div class="fera-productReviews">\n            <div class="fera-productReviews-heading">\n                <div class="fera-productReviews-heading-col1">\n                    <h2 class="fera-productReviews-heading-header">{{ header }}</h2>\n                    <a href="#" class="text-link fera-productReviews-writeReviewLink" data-fera-action="showContentSubmission">Write a review</a>\n                </div>\n                <div class="fera-productReviews-heading-col2" itemscope itemtype="http://schema.org/AggregateRating" itemprop="aggregateRating">\n                    <div class="fera-productReviews-totals-col1">\n                        <div class="fera-productReviews-avgRating">\n                            <span itemprop="ratingValue" class="h1 fera-productReviews-avgRating-val" data-value="{{ average_rating | default: 0.0 }}">{{ average_rating }}</span>\n                        </div>\n                    </div>\n                    <div class="fera-productReviews-totals-col2">\n                        <div class="fera-productReviews-avgRating-stars">\n                            {% if ratings_enabled %}\n                            <div class="fera-stars fera-productReviews-stars"\n                                 data-rating="{{ average_rating | default: 0.0 }}">\n                                <div class="fera-stars-rating fera-productReviews-stars-rating" style="width: {{ average_rating | divided_by: 0.05 }}%;">\u2605\u2605\u2605\u2605\u2605</div>\n                                <div class="fera-stars-bg fera-productReviews-stars-bg"></div>\n                            </div>\n                            {% endif %}\n                        </div>\n                        <div class="fera-productReviews-count">\n                            <div class="fera-productReviews-count-total" data-value="{{ review_count | default: 0 }}">\n                                <span itemprop="reviewCount" class="fera-productReviews-reviewCount"">{{ review_count | default: 0 }}</span>\n                                <span itemprop="ratingCount" style="display: none;">{{ review_count | default: 0 }}</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div class="fera-productReviews-content"></div>\n        </div>'}},Fera.CustomerResources.ProductReviewsModal=class extends Fera.Components.BaseModal{constructor(e){super(e),this.classPrefix=e.classPrefix||"reviews",this.app=e.app,this.totalReviewCount=e.totalReviewCount,this.tplVars=e.tplVars||{},this.reviewOptions=e.reviewOptions||{}}show(e=!1){super.show(),this._setupReviewBlock(),this.reviewBlock.refresh()}hide(){super.hide(),this.reviewBlock.clear(),this.$el&&this.$el.remove(),this.reviewBlock&&delete this.reviewBlock,this.rendered=!1}_setupReviewBlock(){this.reviewBlock||(this.reviewBlock=new Fera.CustomerResources.CustomerReviews.ProductReviews({productId:this._opts.productId,app:this.app,totalReviewCount:this.totalReviewCount,tplVars:this.tplVars,reviewOptions:this.reviewOptions}),this.$modalBody.append(this.reviewBlock.render()))}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.RelatedReviews=class extends Fera.CustomerResources.CustomerReviews.Base{constructor(e){super(e)}refresh(){super.refresh(),this.reviewList.forceInitialLoad()}_initialize(){super._initialize(),this.relatedHeader=(Fera.t(this._opts.relatedHeader)||Fera.t("Reviews From Similar Products")).trim(),this.$header=this.$el.find(".fera-productReviews-heading-header"),this.$header.each(((e,t)=>{const i=this.$(t);i.html().trim()!==this.relatedHeader&&(i.html(this.relatedHeader),i.data("fera-translated",!0))})),this.$el.toggleClass("fera-productReviews--showingRelated",!0)}_setupReviewList(){this.reviewListOpts={app:this.app,singleProduct:!1,pageSize:this.pageSize,layoutCode:this.layoutCode,sortBy:this.sortBy,paginationMode:this.paginationMode,totalReviewCount:this.totalReviewCount,reviewOptions:this.reviewOptions,prefix:this.prefix,typesToShow:this._opts.typesToShow,showProducts:this._opts.showProducts},super._setupReviewList(),this.reviewList.clearListeners("listUpdate"),this.reviewList.on("listUpdate",((e,t)=>{this._updateCountDependentDisplays(t),t>1&&this.trigger("reviewsFound",!0)}))}_updateSeoAttributes(e){Fera.CustomerResources.CustomerReviews.Base.removeSeoAttributes(this.$el)}_tpl(){return'<div class="fera-productReviews">\n            <div class="fera-productReviews-heading">\n                <div class="fera-productReviews-heading-col1">\n                    <h2 class="fera-productReviews-heading-header"></h2>\n                    <a href="#" class="text-link fera-productReviews-writeReviewLink" data-fera-action="showContentSubmission">Write a review</a>\n                </div>\n            </div>\n            <div class="fera-productReviews-content"></div>\n        </div>'}},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.ProductReview=function(e){var t=this,i="https://cdn.fera.ai/img/shoppers/placeholder2.png",r=Fera.Util.$(),n=function(){t.layoutCode=e.layoutCode||"list",t.prefix=e.prefix||"fera-productReviews"};this.render=function(){var i=h($(),e);return t.$el=r(i),o(),s(),c(),"grid"===t.layoutCode&&(e.options&&e.options.headings_enabled&&u(),e.options&&e.options.bodies_enabled&&l("fera-allReviews-review-body",92),e.options&&e.options.show_replies&&l("fera-allReviews-reply-body",72)),t.$el.toggleClass("noHeading",!e.review.heading),t.$el.toggleClass("noBody",!e.review.body),t.$el.toggleClass("noRating",!e.review.rating),t.$el.toggleClass("noReply",!e.review.store_reply),t.$el.toggleClass("noAvatar",!e.options.avatar_images_enabled),t.$el.toggleClass("verified",!!e.review.verified),t._hasLocation=e.review.customer_location&&e.review.customer_location!=e.review.customer_name,t.$el.toggleClass("hasLocation",!!t._hasLocation),t.$el.toggleClass("noLocation",!t._hasLocation),d(),p(),a(),t.$el};var a=function(){!1===e.itemProp&&(t.$el.removeAttr("itemprop"),t.$el.find("[itemprop],[itemscope],[itemtype]").each((function(){r(this).removeAttr("itemprop"),r(this).removeAttr("itemscope"),r(this).removeAttr("itemtype")})))},o=function(){var i=!e.options||void 0===e.options.show_verification||e.options.show_verification;t.$verifications=t.$el.find('[data-fera-verified="true"].'+t.prefix+"-review-customer-verification"),e.options&&!i&&t.$verifications.addClass("fera-verified-hidden"),t.$verifications.each((function(t,i){e.verifier.addVerificationIcon(r(i),{height:15})}))},s=function(){t.$names=t.$el.find("."+t.prefix+"-review-customer-name"),t.$names.removeClass(t.prefix+"-review-customer-name--truncated"),setTimeout((function(){Fera.Util.truncateTextToMaxWidth(t.$names)}),500)},c=function(){t.$dateVals=t.$el.find("."+t.prefix+"-review-date-val"),t.$dateVals.each((function(){var t=r(this),i=new Fera.TimeAgo({language:Fera.i18n.locale||e.language,time:t.data("value")});t.text(i.toString()),t.data("fera-timeAgo",i)}))},u=function(){var e=t.$el.find("."+t.prefix+"-review-heading");e.click((function(){e.css("white-space","normal")}))},l=function(e,i){if("string"==typeof e){var r=t.$el.find("."+e),n=String(r.text()).trim(),a=r.html();if(n&&!(n.length<i)){var o='<div class="'+e+'"><div class="truncated-text">"'+n.slice(0,i)+'..." <span class="show-more"> '+Fera.t("Show More")+'</span></div><q class="full-text">'+a+"</q></div>";r.replaceWith(o),(r=t.$el.find("."+e)).find(".show-more").click((function(){r.find(".truncated-text").hide(),r.find(".full-text").show()}))}}},d=function(){var i=t.$el.find("."+t.prefix+"-photo");i.length<=0||e.imageViewer.init(i)},p=function(){var i=t.$el.find("."+t.prefix+"-videoViewer-viewable");i.length<=0||e.videoViewer.init(i)},h=function(e,t){t.customer_display_name=f();var i=e.replace(new RegExp(/\s*({%-)/g,"g"),"{%").replace(new RegExp(/(-%})\s*/,"g"),"%}").trim();if(!i)return Fera.logger.error("Template is empty or not valid.",e,t),"";var r=Fera.Liquid.parse(i);return r?r.render(t):(Fera.logger.error("Failed to parse template: ",r,t),"")},f=function(){return e.review.customer_name||Fera.t("Anonymous")},m=function(){return'{% if options.avatar_images_enabled %}<div class="'+t.prefix+"-review-customer-col "+t.prefix+'-review-customer-avatar-col">    <img src="{{ review.customer_avatar_url }}" onerror="this.src=\''+i+'\'" alt="'+Fera.t("Review author avatar image")+'" class="'+t.prefix+'-review-customer-avatar">'+_()+"</div>{% endif %}"},g=function(){var e="{% if review.product.thumbnail %}{{ review.product.thumbnail }}{% else %}https://cdn.fera.ai/img/products/placeholder.png{% endif %}";return'{% if review.review_type == "product" and (options.product_images_enabled != false and review.product.url != blank) %}<div class="'+t.prefix+'-review-product">    {%- if review.product.url -%}<a href="{{ review.product.url }}">{%- endif -%}        <img src="'+e+'" alt="Product image" loading="lazy" class="'+t.prefix+'-review-product-img">    {%- if review.product.url -%}</a>{%- endif -%}</div>{% endif %}'},v=function(){return'<div class="'+t.prefix+"-review-customer-col "+t.prefix+'-review-customer-info-col">    <div class="'+t.prefix+'-review-customer-name-row">        <span class="h3 '+t.prefix+"-review-customer-name "+t.prefix+'-review-customer-name--truncated" itemprop="author" itemscope itemtype="https://schema.org/Person"><span itemprop="name">{{ customer_display_name }}</span></span>        <span class="'+t.prefix+'-review-customer-verification" data-fera-verified="{{ review.verified }}"></span>    </div>    {% if review.customer_location and review.customer_location != review.customer_name %}    <div class="'+t.prefix+'-review-customer-location-row">        <span class="'+t.prefix+'-review-customer-location-marker" data-fera-customerLocation="{{ review.customer_location | replace: \'"\', "\'" }}">            <svg aria-hidden="true" focusable="false" height="9" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"></path></svg>        </span>        <span class="'+t.prefix+'-review-customer-location">{{ review.customer_location }}</span>    </div>    {% endif %}</div>'},_=function(){return'{% if review.integration_icon %}<span class="'+t.prefix+'-review-customer-source" title="This review was originally posted on {{ review.integration_name }}.">  <img class="review-source-image" src="{{ review.integration_icon }}" alt="{{ review.integration_name }} icon"></span>{% elsif review.verified %}<span class="'+t.prefix+'-review-customer-verification" data-fera-verified="{{ review.verified }}"></span>{% endif %}'},w=function(){return'{%- if options.ratings_enabled -%}<div class="'+t.prefix+'-review-rating" itemprop="reviewRating" itemscope itemtype="https://schema.org/Rating">    <div class="fera-stars '+t.prefix+"-stars "+t.prefix+'-review-stars" data-rating="{{ review.rating }}">        <span class="fera-srOnly" itemprop="ratingValue">{{ review.rating }}</span>        <div class="fera-stars-rating '+t.prefix+'-stars-rating" style="width: {{ review.rating | divided_by: 0.05 }}%;">\u2605\u2605\u2605\u2605\u2605</div>        <div class="fera-stars-bg '+t.prefix+'-stars-bg"></div>    </div></div>{%- endif -%}'},y=function(){var e='{%- if options.headings_enabled and review.heading -%}<div class="h3 '+t.prefix+'-review-heading" itemprop="name">';return"grid"===t.layoutCode?e+="<span>{{ review.heading }}</span>":e+="{{ review.heading }}",e+="</div>{%- endif -%}"},b=function(){var e="grid"===t.layoutCode?"q":"div";return'{%- if options.bodies_enabled and review.body and review.body != "" -%}<'+e+' class="'+t.prefix+'-review-body" itemprop="description">{{ review.body | newline_to_br }}</'+e+">{%- endif -%}"},C=function(){return e.review&&(e.review.photos||[]).length<1&&(e.review.videos||[]).length<1?"":'{% if options.customer_uploads_enabled %}    <div class="'+t.prefix+'-files">        {% for photo_url in review.photos %}            <img class="'+t.prefix+'-photo fera-imageViewer-viewable" src="{{ photo_url }}" loading="lazy" alt="Review image" itemprop="reviewPhoto" itemscope itemtype="https://schema.org/Photograph" />        {% endfor %}        {% for video_url in review.videos %}           {% if review.is_sample %}               <img class="'+t.prefix+"-videoThumbnail "+t.prefix+'-videoViewer-viewable" src="https://uploads.fera.ai/products/video-placeholder.png" loading="lazy" data-video-url="{{ video_url }}" />           {% else %}               <figure class="'+t.prefix+"-videoThumbnailWrapper "+t.prefix+'-thumbnail">                   <div                       class="'+t.prefix+"-videoThumbnail-clickableArea "+t.prefix+'-videoViewer-viewable"                       data-video-url="{{ video_url }}"                   ></div>                   <video class="'+t.prefix+'-videoThumbnail" src="{{ video_url }}#t=0.001" width="100" height="100" itemprop="reviewVideo" itemscope itemtype="https://schema.org/VideoObject"></video>                   <div class="'+t.prefix+'-videoThumbnail-playButtonWrapper">                       <svg class="'+t.prefix+'-videoThumbnail-playButton" width="17" height="17"                           viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">                           <path                               d="M0 15.223V1.77702C0 0.99739 0.852556 0.517624 1.51898 0.922237L12.5921 7.64521C13.2335 8.03461 13.2335 8.96539 12.5921 9.35479L1.51898 16.0778C0.852556 16.4824 0 16.0026 0 15.223Z"                               fill="black" fill-opacity="0.8"/>                       </svg>                   </div>               </figure>           {% endif %}        {% endfor %}    </div>{%- endif -%}'},S=function(){return'<div class="'+t.prefix+'-review-date">    <meta itemprop="datePublished" content="{{ review.date }}">    <span class="'+t.prefix+'-review-date-val" data-value="{{ review.date }}">{{ review.date }}</span></div>'},x=function(i){var r=t.prefix+"-reply";i&&(r+=" "+t.prefix+"-reply--"+i);var n='<span class="'+t.prefix+'-reply-storeName" data-value="{{ review.store_name }}">{{ review.store_name }}</span>',a=Fera.t("{{ store_name }} replied:");a=!e.store.icon_url&&e.store.logo_url?a.replace(/\s{{\s*store_name\s*}}\s*/,""):a.replace(/{{\s*store_name\s*}}/,n);var o='{% if options.show_replies and review.store_reply %}<div class="'+r+'">    <div class="'+t.prefix+'-reply-heading">        {% if store.icon_url %}            <img class="'+t.prefix+'-reply-storeIcon" src="{{ store.icon_url }}" loading="lazy" alt="{{ store.name }} logo icon"/>        {%- elsif store.logo_url -%}            <img class="'+t.prefix+'-reply-storeLogo" src="{{ store.logo_url }}" loading="lazy" alt="{{ store.name }} logo"/>        {%- endif -%}        <span>'+a+'</span>    </div>    <div class="'+t.prefix+'-reply-body">{{- review.store_reply | newline_to_br -}}</div>    <div class="'+t.prefix+'-reply-date">        <meta itemprop="date" content="{{ review.store_replied_at }}">        <span class="'+t.prefix+'-review-date-val" data-value="{{ review.store_replied_at }}">{{ review.store_replied_at }}</span>    </div></div>{%- endif -%}';return e.review.store_reply&&""===e.review.store_reply.trim()?"":o},F=function(){return 0==e.showProduct?"":'{% if review.review_type == "product" and review.product and review.product.name and review.product.url %}<div class="'+t.prefix+'-review-product">'+Fera.t("Product:")+' {% if review.product.url %}<a href="{{ review.product.url }}" class="'+t.prefix+'-review-product-link">{% endif %}{{ review.product.name }}{% if review.product.url %}</a>{% endif %}</div>{% endif %}'},k=function(){return'<div class="'+t.prefix+'-review" data-link="{{ review.link_url }}" itemprop="review" itemscope itemtype="https://schema.org/Review" data-id="{{ review.id }}">    <div class="'+t.prefix+'-review-customer">'+m()+v()+'    </div>    <div class="'+t.prefix+'-review-content">'+w()+y()+b()+F()+C()+S()+x("wide")+"    </div>"+x("thin")+"</div>"},T=function(){return'<div class="'+t.prefix+'-review for-{{ review.review_type }}" data-link="{{ review.link_url }}" itemprop="review" itemscope itemtype="https://schema.org/Review" data-id="{{ review.id }}">'+g()+'    <div class="'+t.prefix+'-review-content {% if (options.product_images_enabled == false && options.avatar_images_enabled == false) or review.product.url == blank %}review-content-wide{% endif %}">'+S()+w()+y()+b()+F()+C()+'       <div class="'+t.prefix+'-review-customer">'+m()+v()+"       </div>"+x()+"    </div></div>"},$=function(){return"grid"===t.layoutCode?T():k()};n()},Fera.CustomerResources=Fera.CustomerResources||{},Fera.CustomerResources.CustomerReviews=Fera.CustomerResources.CustomerReviews||{},Fera.CustomerResources.CustomerReviews.List=class extends Fera.Components.Base{constructor(e){super(e),this.$=Fera.Util.$(),this.app=e.app,this.prefix=e.prefix,this.layoutCode=e.layoutCode||"list",this.singleProduct=void 0!==e.singleProduct&&e.singleProduct,this.paginationMode=e.paginationMode||"show_more",this.totalCount=e.totalReviewCount||0,this.limit=e.pageSize||5,this.currentPage=1,this.sortBy=e.sortBy||"most_recent",this._processReviewOptions(e.reviewOptions),this.reviews=[],e.template&&(this.prerendered=!0,this.$el=e.template,this._translateShowMore(),this._initialize())}render(){return this.prerendered||(this.$el=this.$(this._tpl()),this._initialize()),this.$el}clear(){this.$reviewContainer.empty(),"show_more"===this.paginationMode&&this.$showMore.hide()}refresh(){this.currentPage=1,this.reviews=[],this.clear(),this.totalCount>0||this.app.opts.designMode||this.app.opts.testMode?(this._showLoading(),this._fetchPage(1)):this.$reviewContainer.append(this.$noReviews)}forceInitialLoad(){this._showLoading(),this._fetchPage(1)}_processReviewOptions(e){this.reviewOptions={},this.reviewOptions.language=e.language||"en",delete e.language,this.reviewOptions.itemProp=void 0===e.itemProp||e.itemProp,delete e.itemProp;var t={avatar_images_enabled:!0,product_images_enabled:!0,customer_uploads_enabled:!0,ratings_enabled:!0,headings_enabled:!0,bodies_enabled:!0,videos_enabled:!0,show_replies:!0};this.reviewOptions.reviewFields=this.$.extend(t,e)}_translateShowMore(){const e=this.$el.find(`.${this.prefix}-footer .${this.prefix}-showMore-btn`),t=e.html(),i=/[sS]how [mM]ore/;if(t&&t.match(i)){const t=e.html().replace(i,Fera.t("Show More"));e.html(t)}}_initialize(){this.$reviewContainer=this.$el.find(`.${this.prefix}-reviews`),this.$showMore=this.$el.find(`.${this.prefix}-showMore`),this.$footer=this.$el.find(`.${this.prefix}-footer`),this.$noReviews=this.$(Fera.Liquid.parse(this._noReviewsTpl()).render()),this.$showMore.hide(),"show_more"===this.paginationMode?this._setupShowMore():this._setupPagination()}_setupShowMore(){this.$showMore.on("click",(e=>{e.preventDefault(),e.stopPropagation(),this._fetchNextPage()}))}_setupPagination(){this.paginationComponent=new Fera.Components.Pagination({prefix:this.prefix,hideIfOnePage:!0,currentPage:this.currentPage,totalCount:this.totalCount,pageSize:this.limit,onClick:e=>this._pageChangeHandler(e)}),this.$footer.append(this.paginationComponent.render())}_fetchNextPage(){this.currentPage++,this._fetchPage(this.currentPage)}_pageChangeHandler(e){this._showLoading(),Fera.Util.isScrolledIntoView(this.$reviewContainer)||Fera.Util.scrollToElement(this.$reviewContainer,{duration:200}),this.currentPage=e,this._fetchPage(e)}_fetchPage(e){var t={page:e,limit:this.limit,sort_by:this.sortBy};this.singleProduct&&(t.product_id=this._opts.productId||this.app.getProductId()),this._opts.typesToShow&&(t.review_type=this._opts.typesToShow),"choose"==this._opts.reviewOptions.review_source&&this._opts.reviewOptions.review_ids&&("string"==typeof this._opts.reviewOptions.review_ids?t.ids=JSON.parse(this._opts.reviewOptions.review_ids):t.ids=this._opts.reviewOptions.review_ids||[],t.ids=t.ids.join(",")),this.app.api.getReviews(t,((e,i)=>{this._hideLoading(),this.totalCount=i,this.totalCount<1?(this.clear(),this.$reviewContainer.append(this.$noReviews)):(this.$noReviews.remove(),"pagination"===this.paginationMode&&this.clear(),this._shouldShowRandomReviews(t.product_id)?this._renderReviews(Fera.Util.shuffleArray(e)):this._renderReviews(e)),this._updateFooter(),this.trigger("listUpdate",this.totalCount)}))}_shouldShowRandomReviews(e){const t=this._opts.reviewOptions.when_no_reviews;return("show_from_related"==t||"show_related"==t)&&!e}_renderReviews(e){for(var t=new Fera.ImageViewer,i=new Fera.VideoViewer,r=0;r<e.length;r++){var n=new Fera.CustomerResources.ProductReview({review:e[r],verifier:this.app.verifier,language:this.reviewOptions.language,options:this.reviewOptions.reviewFields,itemProp:this.reviewOptions.itemProp,layoutCode:this.layoutCode,imageViewer:t,videoViewer:i,showProduct:this._opts.showProducts,prefix:this.prefix,store:this.app.storeSettings});this.reviews.push(n),"store"==e[r].review_type&&(this._hasStoreReviews=!0),"product"==e[r].review_type&&(this._hasProductReviews=!0),this.$reviewContainer.append(n.render())}this.$reviewContainer.toggleClass("hasProductReviews",!!this._hasProductReviews),this.$reviewContainer.toggleClass("hasStoreReviews",!!this._hasStoreReviews),this.$reviewContainer.toggleClass("avatars--visible",!!this.reviewOptions.reviewFields.avatar_images_enabled),this.$reviewContainer.toggleClass("avatars--hidden",!this.reviewOptions.reviewFields.avatar_images_enabled)}_updateFooter(){"pagination"===this.paginationMode?this.paginationComponent.update({currentPage:this.currentPage,totalCount:this.totalCount,pageSize:this.limit}):this.totalCount>this.reviews.length?this.$showMore.show():this.$showMore.hide()}_showLoading(){this.$reviewContainer.toggleClass("loading",!0),this.currentlyLoading=!0}_hideLoading(){this.currentlyLoading&&(this.$reviewContainer.toggleClass("loading",!1),this.currentlyLoading=!1)}_noReviewsTpl(){return`<div class="${this.prefix}-noReviewsText">{{ "No reviews for this product yet." | t }}</div>`}_showMoreTpl(){return`<div class="${this.prefix}-showMore">\n            <a href="#" class="btn btn-secondary btn--secondary ${this.prefix}-showMore-btn">${Fera.t("Show More")}<span class="${this.prefix}-showMore-count"></span></a>\n        </div>`}_tpl(){return`<div class="${this.prefix}-${"grid"===this.layoutCode?"Grid":"List"}">\n            <div class="${this.prefix}-body">\n                <div class="${this.prefix}-reviews"></div>\n            </div>\n            <div class="${this.prefix}-footer">\n                ${this._showMoreTpl()}\n           </div>\n        </div>`}},Fera.Conditions_Comparison=class{constructor(e,t,i){this.stateValue=e,this.ruleValue=t,this.operator=i}isTrue(){return this[this.operator]()}equal(){return this.stateValue==this.ruleValue}not_equal(){return!this.equal()}equal_i(){return this.equal()}not_equal_i(){return!this.equal_i()}contains(){return this.stateValue==this.ruleValue}not_contains(){return!this.contains()}less(){return this.stateValue<this.ruleValue}less_or_equal(){return this.stateValue<=this.ruleValue}greater(){return this.stateValue>this.ruleValue}greater_or_equal(){return this.stateValue>=this.ruleValue}between(){return this.greater()||this.less()}not_between(){return!this.between()}},Fera.Conditions_Comparison_String=class extends Fera.Conditions_Comparison{constructor(e,t,i){super(String(e).trim(),String(t).trim(),i)}equal(){return this.stateValue==this.ruleValue}equal_i(){return this.stateValue.toLowerCase()==this.ruleValue.toLowerCase()}contains(){return-1!==this.stateValue.toLowerCase().indexOf(this.ruleValue.toLowerCase())}less(){return parseFloat(this.stateValue)<parseFloat(this.ruleValue)}less_or_equal(){return parseFloat(this.stateValue)<=parseFloat(this.ruleValue)}greater(){return parseFloat(this.stateValue)>parseFloat(this.ruleValue)}greater_or_equal(){return parseFloat(this.stateValue)>=parseFloat(this.ruleValue)}between(){return-1!==this.ruleValue.indexOf(this.stateValue)}},Fera.Conditions_Comparison_Array=class extends Fera.Conditions_Comparison{constructor(e,t,i){super(e,t,i),"string"!=typeof this.stateValue&&(this.stateValue=String(this.stateValue).split(",")),this.stateValue=this.stateValue.sort()}equal(){let e=this.ruleValue;return"object"!=typeof this.ruleValue&&(e=String(this.ruleValue).split(",")),this.stateValue.join(",")==e.sort().join(",")}contains(){return-1!==this.stateValue.indexOf(this.ruleValue)}less(){return this.stateValue.length<this.ruleValue}less_or_equal(){return this.stateValue.length<=this.ruleValue}greater(){return this.stateValue.length>this.ruleValue}greater_or_equal(){return this.stateValue.length>=this.ruleValue}between(){return this.ruleValue.every((e=>-1!==this.stateValue.indexOf(e)))}},Fera.Conditions_Comparison_Param=class extends Fera.Conditions_Comparison_String{constructor(e,t,i){super(e,t.value,i)}},Fera.Conditions_Rule=class{constructor(e,t={}){this._opts=t,this.rule=e,this.atomic=!0,this.comparisonClass=this._determineComparisonClass()}isTrue(e){const t=e.fetchValue(this.rule.field,this.rule.value);if(null==t)return!1;return new this.comparisonClass(t,this.rule.value,this.rule.operator).isTrue()}debug(e){const t=e.fetchValue(this.rule.field,this.rule.value);return`(${this.rule.field}: ${JSON.stringify(t)} ${this.rule.operator} ${JSON.stringify(this.rule.value)})`}_determineComparisonClass(){switch(this.rule.type){case"string":return this.rule.field.match(/_param$/)&&"object"==typeof this.rule.value?Fera.Conditions_Comparison_Param:Fera.Conditions_Comparison_String;case"array":return Fera.Conditions_Comparison_Array}return Fera.Conditions_Comparison}},Fera.Conditions_Group=class{constructor(e,t={}){this._opts=t,this.conditions=e,this.rules=this.conditions.rules.map((e=>e.condition?new this.constructor(e):new Fera.Conditions_Rule(e))),this.separator=this.conditions.condition}isTrue(e){return!this.rules||this.rules.length<1||("AND"==this.separator?this.rules.every((t=>t.isTrue(e))):this.rules.some((t=>t.isTrue(e))))}debug(e){return this.rules.map((t=>t.atomic?`${t.debug(e)}=${t.isTrue(e)}`:`(${t.debug(e)})=${t.isTrue(e)}`)).join(` ${this.separator} `)}},Fera.Conditions_State=class{constructor(e,t={}){this._opts=t,this.data=e,this.data.product=this.data.product||{},this.data.cart=this.data.cart||{}}fetchValue(e,t){const i=this.data.current_page.url.toLowerCase();switch(e){case"shopper_country_code":return this.data.location.country_code;case"shopper_country_name":return this.data.location.country_name;case"shopper_city":return this.data.location.city;case"shopper_region_code":return this.data.location.region_code;case"shopper_region_name":return this.data.location.region_name;case"shopper_time_zone":return this.data.location.time_zone;case"shopper_continent":return this.data.location.continent;case"shopper_from_gdpr":return-1!==this.constructor.GDPR_COUNTRY_CODES.indexOf(this.data.location.country_code);case"shopper_not_from_gdpr":return-1===this.constructor.GDPR_COUNTRY_CODES.indexOf(this.data.location.country_code);case"cart_total":return this.data.cart.total;case"cart_item_count":return this.data.cart.item_count;case"cart_total_weight":return this.data.cart.total_weight;case"cart_item_product_ids":return this.data.cart.items.map((e=>e.product_id));case"cart_item_names":return this.data.cart.items.map((e=>e.name));case"cart_item_variant_ids":return this.data.cart.items.map((e=>e.variant_id));case"request_url":return i;case"request_title":return this.data.current_page.title.toLowerCase();case"request_referrer":return this.data.current_page.referrer.toLowerCase();case"request_url_param":return this._getUrlParamValue(i,t);case"shopper_total_interaction_time":return this.data.interaction_time;case"shopper_time_since_first_seen":return this.data.time_since_first_seen;case"shopper_session_time":
return this.data.session_time;case"shopper_time_on_current_page":return this.data.time_on_current_page;case"shopper_inactive_time_on_current_page":return this.data.inactive_time_on_current_page;case"is_mobile":case"is_not_mobile":return this.constructor.isUserAgentMobile()?1:0;case"product_id":return this.data.product_id;case"product_exists":return!!this.data.product_id;case"product_tags":return this.data.product.tags;case"product_name":return this.data.product.name}return null}_getUrlParamValue(e,t){const i=e.split("?")[1]||"";if(void 0===t.value)return i;{const e=i.split("&").find((e=>e.split("=")[0]==t.param));return e?e.split("=")[1]:""}}static isUserAgentMobile(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(navigator.userAgent.substr(0,4))}static get GDPR_COUNTRY_CODES(){return["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","GB"]}},Fera.Conditions_Evaluator=class{constructor(e,t,i={}){this._opts=i,this.group=new Fera.Conditions_Group(e,this._opts),this.state=new Fera.Conditions_State(t,this._opts)}isTrue(){return this.group.isTrue(this.state)}debug(){return this.group.debug(this.state)}},Fera.AbTests=Fera.AbTests||{},Fera.AbTests.Manager=class{constructor(e){this._opts=e,this._storage=new Fera.LocalStorageJar("Fera.AbTests"),this._changed=!1,this._loadBuckets()}updateBuckets(e){if(e)return Object.keys(e).forEach((t=>{if(void 0!==this.buckets[t])return;let i;i=!!this._opts.app.opts.isAdminMode()||("boolean"==typeof e[t].on?e[t].on:e[t].next_bucket_on),this.updateBucket(t,i)})),this._expireBuckets(),this.save()}reset(){this.buckets={},this._changed=!0,this.save()}updateBucket(e,t){this.buckets[e]={on:t,expires:(new Date).getTime()+9e5},this._changed=!0}onFor(e){return this._expireBuckets(),void 0===this.buckets[e]||this.buckets[e].on}present(){return this._expireBuckets(),Object.keys(this.buckets).length>0}getBuckets(){if(!this.buckets||this.buckets=={}||"object"!=typeof this.buckets)return{};const e={};return Object.keys(this.buckets).forEach((t=>{var i=this.buckets[t];e[t]="boolean"==typeof i?i:i.on})),e}save(){return!!this._changed&&(this._storage.setObject("buckets",this.buckets),this._changed=!1,!0)}_expireBuckets(e=!0){return Object.keys(this.buckets).forEach((e=>{this.buckets[e].expires<(new Date).getTime()&&(delete this.buckets[e],this._changed=!0)})),e&&this._changed&&this.save(),this}_loadBuckets(){if(this._storage.localStorageEnabled)return this.buckets=this._storage.getObject("buckets",{}),Object.keys(this.buckets).forEach((e=>{if("object"!=typeof this.buckets[e]){const t=this.buckets[e];this.updateBucket(e,t)}})),this._changed&&this.save(),this.buckets}},Fera.Preview_Api=class extends Fera.Api{checkConfig(){return!0}waitForApiConfig(e){return e(!0)}validConfig(){return!0}checkIn(e,t={}){return t.callback&&t.callback()}mergeShoppers(e,t){return!0}pushEvent(e,t={}){const i=t.callback||t.then||(()=>{});return this._opts.testMode&&this._opts.logger.warn("[TEST MODE] Not pushing event to the api because test mode is enabled, but the rest of the JS will think we did.",e),i(!1)}getContent(e,t,i){this._app.previewer.getContent((i=>{let r=JSON.parse(e.content_requests_json).find((e=>"global_bottom"===e.container_type));if(r)this._globalBottomContainer=this._$.extend({},r);else{if(!this._globalBottomContainer)return t({});r=this._$.extend({},this._globalBottomContainer)}if(!i)return Fera.logger.warn("Fera preview API hit getContent callback without displayerResponse. There may be a problem."),t({});i.isPreview=!0,r.abstract_blocks=[i];const n={compiled_css:i.css,content_responses:[r],store:i.store};t(n)}))}},Fera.Preview_State=class extends Fera.State{getData(e){if(this._app.previewer)this._app.previewer.getState(e);else{const t=setInterval((()=>{this._app.previewer&&(clearInterval(t),this.getData(e))}),100)}}},Fera.ShopifyAdapter=function(e){var t=this,i=Fera.Util.$();e=e||{};var r=[];this.cartAdapter=new Fera.ShopifyCartAdapter(e);var n=function(){e.logger.log("Shopify adapter initialized."),v(),u(),g(),a(),t.variantLoader=new Fera.VariantLoader(e),s()?c():(l(),setInterval((function(){l()}),250)),o()},a=function(){"undefined"!=typeof __st&&__st.cid&&(e.logger.log(`Set currently logged in customer as ${__st.cid}`),e.app.setCustomerId(__st.cid))},o=function(){"undefined"!=typeof Shopify&&Shopify.designMode&&(e.app.setDesignMode(!0),e.app.setAdminMode(!0))};this.formatCurrency=function(e){if("undefined"==typeof Shopify||!Shopify||!Shopify.currency||!Shopify.currency.rate||"undefined"==typeof theme||!theme.moneyFormat&&!theme.strings.moneyFormat)return null;var t=parseFloat(Shopify.currency.rate)*e,i=theme.moneyFormat;theme.moneyFormat||(i=theme.strings.moneyFormat);var r=i.replace(/{{[ ]?amount[ ]?}}/,t.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","));return r=(r=r.replace(/{{[ ]?amount_no_decimals[ ]?}}/,Math.round(t).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",").replace(/^(.+)\.00$/,"$1"))).replace(/{{[ ]?amount_with_comma_separator[ ]?}}/,t.toFixed(2).toString().replace(".",","))};var s=function(){if(-1!==window.location.toString().indexOf("/password"))return!0;var e=i('link[rel="canonical"]').attr("href");return!(!e||-1===e.indexOf("/password"))},c=function(){if(e.app.opts.sandboxMode)return i('a[href="/admin"]').on("click",(function(e){e.preventDefault(),alert("Please enter your storefront password instead. You can find it at YOUR_STORE_URL/admin/online_store/preferences.")})),setTimeout((function(){var e=i('a[href="#LoginModal"],.password__open-modal');e.length<=0||Fera.Util.scrollToElement(e,{callback:function(){}})}),1e3),!0},u=function(){-1!==window.location.toString().indexOf("/checkouts/")&&i('<div class="banana-container banana-cart-container banana-order-top-container fera-order-top-container" data-container_type="cart"></div>').insertAfter(".breadcrumb")},l=function(){d(),p()},d=function(){i('form[action~="/cart/add"] button[type=submit],form[action~="/cart/add"] input[type=submit],.product-form__cart-submit,.add-to-cart, .addToCart, .add_to_cart, #addToCart, #add-to-cart, #add_to_cart, .add-to-cart input.button,.btn-addtocart').each((function(){var t=i(this);if(t.data("Fera.listenersBound"))return!0;if(t.length<=0)e.logger.warn("Fera did not find the add to cart button so it will not be enabled for add to cart events.");else{var r=f(t.parents("form"));t.on("click touch",(function(){m(r)})),t.data("Fera.listenersBound",!0)}}))},p=function(){i('form[action~="/cart/add"]').each((function(){var t=i(this);if(t.data("Fera.listenersBound"))return!0;if(t.length<=0)e.logger.warn("Fera did not find the add to cart form.");else{var r=f(t);t.on("submit",(function(){m(r)})),t.data("Fera.listenersBound",!0)}}))},h=function(e){return e&&e.length>0&&!e.match(/\D/)?e:null},f=function(e){var t=h(e.data("productid"))||h(e.data("product-id"))||h(e.find("[data-productid]").data("productid"))||h(e.find("[data-product-id]").data("product-id"));if(!t){var i=e.attr("id");i&&(i=i.split("_").pop()),t=h(i)}var r=h(e.find('[name="id"]').val()),n={};return r&&(n.variant_id=r),t&&(n.product_id=t),n!={}&&Fera.logger.log("Located product/variant event data for click: ",n),n},m=function(t){for(var i=0;i<r.length;i++)if(r[i].variant_id===t.variant_id&&r[i].product_id===t.product_id)return;r.push(t),e.app.pushAddToCartEvent(t),setTimeout((function(){for(var e=0;e<r.length;e++)if(r[e].variant_id===t.variant_id&&r[e].product_id===t.product_id){r.splice(e,1);break}}),1e3)},g=function(){if("undefined"!=typeof Shopify&&Shopify.theme&&Shopify.theme.name){var e=Shopify.theme.name.toLowerCase();-1===e.indexOf("boundless")&&-1===e.indexOf("narrative")||Fera.Util.isHome()&&(i("body").addClass("fera-themeWithFixedHeader fera-themeWithFixedHeader--adjust"),-1!==e.indexOf("narrative")&&i(".site-header--homepage").addClass("fera-themeWithFixedHeader--adjust"))}},v=function(){if("undefined"!=typeof Shopify&&Shopify.locale)e.app.setLocale(Shopify.locale);else{var t=document.getElementById("shopify-features");if(!t)return;(t=JSON.parse(t.innerHTML)).locale&&e.app.setLocale(t.locale)}};n()},Fera.ShopifyAdapter.generateProductDataAttribute=function(e){try{var t={id:e.id,name:e.title,variants:[]};"string"==typeof e.images?t.thumbnail_url=e.images:void 0!==e.image&&("string"==typeof e.image?t.thumbnail_url=e.image:"object"==typeof e.image&&"string"==typeof e.image.src&&(t.thumbnail_url=e.image.src));for(var i=0;i<e.variants.length;i++){var r=e.variants[i],n={name:r.title,stock:r.inventory_quantity,inventory_policy:r.inventory_policy,manages_stock:r.inventory_management&&""!==r.inventory_management};r.image&&r.image.src&&(n.thumbnail_url=r.image.src),t.variants.push(n)}return encodeURI("0617-"+Fera.Util.encode(JSON.stringify(t)))}catch(e){return console.error(e.message,e),null}},Fera.ShopifyCartAdapter=function(e){var t=this,i=Fera.Util.$(),r=function(){n(),e.app.on("cart.ready",(function(){a()}))},n=function(){i(document).on("ajaxComplete",(function(t,i,r){if(!(i.status>=300)&&e.app.cart)if(r&&-1!==r.url.indexOf("/cart.js"))e.app.cart.loadCartData(JSON.parse(i.responseText));else if(r&&/\/cart\/(add|update|clear|change)/.test(r.url)){var n=JSON.parse(i.responseText);-1===r.url.indexOf("/cart/add")||n.items?e.app.cart.loadCartData(n):e.app.cart.loadItemData(n),e.app.updateAllContainers()}}))},a=function(){-1!==window.location.toString().indexOf("/thank_you")&&e.app.cart&&e.app.cart.reset()};t.startCheckout=function(){var e=Fera.Util.updateURLParameter(window.location.toString(),"ensure_loaded_cart","0");e=Fera.Util.updateURLParameter(e,"go_to_checkout","0"),window.location=e.replace("/cart","/checkout")},t.downloadData=function(e){i.getJSON("/cart.js",(function(t){"function"==typeof e&&e(t)}))},t.clear=function(e){i.ajax({method:"GET",type:"GET",data:{},dataType:"json",url:"/cart/clear",complete:function(){"function"==typeof e&&e()}})},t.parseCartData=function(e){var t={},i=null;if(!e)return null;i=o(),t.item_count=e.item_count,"string"==typeof e.currency&&(t.currency=e.currency),t.total=e.total_price/i/100,t.total_weight=e.total_weight,t.total_discount=e.total_discount/i/100,t.items=[];for(var r=0;r<e.items.length;r++){var n=e.items[r];t.items.push({price:n.price/i/100,total:n.line_price/i/100,product_id:n.product_id,name:n.product_title,variant_id:n.variant_id,quantity:n.quantity})}return t},t.parseItemData=function(e){var t={},i=null;return e?(i=o(),t.price=e.price/i/100,t.total=e.line_price/i/100,t.product_id=e.product_id||e.id,t.name=e.product_title,t.variant_id=e.variant_id,t.quantity=e.quantity,t.weight=e.grams,t.total_discount=e.total_discount/i,t):null};var o=function(){return Shopify&&Shopify.currency&&Shopify.currency.rate?parseFloat(Shopify.currency.rate):parseFloat("1.0")};t.removeProduct=function(t,r,n){var a={},o=(e.app.cart.getData()||{}).items;if(!o)return!1;var s=0;r&&(s=r.quantity||0);for(var c=0;c<o.length;c++){var u=o[c];if(u.product_id==t){if(r){if(r.variant_id&&u.variant_id!=r.variant_id)continue;if(r.quantity){if(!(s>0))continue;if((s-=u.quantity)<0){a[u.variant_id]=0-s;break}}}a[u.variant_id]=0}}return 0!==Object.keys(a).length&&(i.ajax({method:"POST",type:"POST",data:{updates:a},dataType:"json",url:"/cart/update.js",complete:n.afterAdd||n.then||function(){}}),!0)},t.addProduct=function(e,t,r){var n={id:t.variant_id||t.variant||t.variantId,quantity:t.quantity||1};i.ajax({method:"POST",type:"POST",data:n,dataType:"json",url:"/cart/add.js",complete:function(){var t=arguments;s(e,(function(){(r.afterAdd||r.then||function(){}).apply(this,t)}))}})};var s=function(t,i){if(e.app.cart.getProductQuantity(t)>=1)return i();setTimeout((function(){e.app.cart.update((function(){s(t,i)}),!1)}),500)};r()},Fera.BigcommerceAdapter=function(e){var t=this,i=Fera.Util.$();e=e||{};var r,n=null,a=function(){t.cartAdapter=new Fera.BigcommerceCartAdapter(e),w(),y(),c(),b(),d(),o()},o=function(){if(s())return!0;var t=window.location.toString();if(i("#checkout-app").length>0)return e.app.setSection("checkout"),!0;Fera.Util.isHome()?e.app.setSection("home"):-1!==t.indexOf("cart.php")?e.app.setSection("cart"):-1!==t.indexOf("finishorder")?e.app.setSection("order_complete"):i(".banana-view-container").length>0?e.app.setSection("product_view"):i(".banana-list-container").length>0?e.app.setSection("product_list"):-1!==t.indexOf("checkout")&&e.app.setSection("checkout")},s=function(){var t=i("script").toArray().find((function(e){return e.innerHTML&&-1!==e.innerHTML.indexOf('window.stencilBootstrap("')}));if(t){let i=t.innerHTML.match(/window\.stencilBootstrap\("([a-zA-Z_-]+)"/);if(i){let t={default:"home",cart:"cart",product:"product_view",category:"product_list"}[i[1]];if(t)return e.app.setSection(t),!0}}return!1},c=function(){e.params&&e.params.dynamically_integrate&&(-1!==e.params.dynamically_integrate.indexOf("product_view")&&f(),-1!==e.params.dynamically_integrate.indexOf("product_list")&&l(),-1!==e.params.dynamically_integrate.indexOf("cart_top")&&u())},u=function(){var e='<!-- BEGIN Fera.ai Shopping Cart Top Container --> <div class="banana-container banana-cart-container" data-container_type="cart" ></div> <!-- END -->';if(!(i(".banana-cart-container").length>0))if(-1!==window.location.toString().indexOf("/cart.php")){var t=i(".cart-container");t.length>0?t.each((function(){i(e).prependTo(i(this))})):i(e).insertAfter(i("h1,.page-title,.page-heading").first())}else-1===window.location.toString().indexOf("checkout")&&i(e).prependTo(i(".optimizedCheckout-contentPrimary"))},l=function(){var e='<!-- BEGIN Fera.ai Product List Bottom Container --> <div class="banana-container banana-list-container" data-product_id="#{product_id_code}" data-container_type="list"></div> <!-- END -->';if(h(e))return!0;i(".productGrid article, .product-grid-container article").each((function(){var t=i(this),r=t.find("[data-product-id]").first().data("product-id");if(r&&""!==r||t.find("a").each((function(){var e=i(this).attr("href");e&&-1!==e.indexOf("product_id=")&&(e.match(/.+(product_id|product-id|productId)=(.+).*/i)&&(r=e.match(/.+(product_id|product-id|productId)=(.+).*/i)[2]))})),r&&""!==r){var n=e;n=n.replace("#{product_id_code}",r),i(n).appendTo(t)}}))},d=function(){i(document).on("ajaxComplete",(function(e,t){try{if(!t)return;var i=JSON.parse(t.responseText);t&&i&&i.productListing&&l()}catch(e){}}))},p=function(){return i(".product-grid *").contents().filter((function(){return 8===this.nodeType&&-1!==this.nodeValue.indexOf("snippet location product_rating")}))},h=function(e){var t=p();if(t.length<1)return!1;var r=!1;return t.each((function(){var t=i(this),n=t.parents(".product-item").find("[data-product-id]").data("productId");if(n&&""!==n){var a=e.replace("#{product_id_code}",n);t.after(a),i(a).appendTo(t),r=!0}})),r},f=function(){var e='<!-- BEGIN Fera.ai Product View Container --> <div class="banana-container banana-view-container" data-product_id="#{product_id_code}" data-container_type="view"></div> <!-- END -->';if(g(e))return!0;r.length>0?_(e):v(e)},m=function(){return i(Fera.Util.ie()?"body":"*").contents().filter((function(){return 8===this.nodeType&&-1!==this.nodeValue.indexOf("snippet location product_addtocart")}))},g=function(e){var t=m();if(t.length<1)return!1;var r=!1;return t.each((function(){var t=i(this),n=t.parents("form").find("[data-product-id]").val();if(n&&""!==n){var a=e.replace("#{product_id_code}",n);t.after(a),i(a).appendTo(t),r=!0}})),r},v=function(t){for(var r=0;r<n.length;r++){var a=n[r],o=a.find("input[name=product_id]").val();"product_view"!=e.app.getSection()||e.app.getProductId()||e.app.setProductId(o);var s=t;s=s.replace("#{product_id_code}",o),i(s).appendTo(a)}},_=function(t){for(var n=0;n<r.length;n++){var a=r[n],o=a.attr("action").match(/.*product_id=([0-9]+).*/)[1],s=t;"product_view"!=e.app.getSection()||e.app.getProductId()||e.app.setProductId(o),s=s.replace("#{product_id_code}",o),i(s).insertAfter(a)}},w=function(){return null!=n||(n=[],i("form[action]").each((function(){var e=i(this);-1!==e.attr("action").indexOf("cart.php")&&n.push(e)}))),n},y=function(){return null!=r||(r=[],i("form[action]").each((function(){var e=i(this);-1!==e.attr("action").indexOf("wishlist.php?action=add")&&null!==e.attr("action").match(/.*product_id=([0-9]+).*/)&&r.push(e)}))),r},b=function(){for(var t=0;t<n.length;t++){var i=n[0].find('#form-action-addToCart, input[type="submit"]');if(i.length<=0)return void e.logger.warn("Fera did not find the add to cart button so it will not be enabled for add to cart events.");i.on("click touch",(function(){e.app.pushAddToCartEvent()}))}};a()},Fera.BigcommerceCartAdapter=function(e){var t=this,i=Fera.Util.$(),r=function(){n(),e.app.on("cart.ready",(function(){o(),a()}))},n=function(){i(document).on("ajaxComplete",(function(t,i,r){i.status>=300||r&&-1!==r.url.indexOf("/cart.php")||r&&-1!==r.url.indexOf("/remote/v1/cart/")&&setTimeout((function(){e.app.cart.update()}),500)}))},a=function(){i(window).on("load",(function(){var t=document.querySelector("[data-cart-content]");if(t&&"undefined"!=typeof MutationObserver){var i={attributes:!0,childList:!0,characterData:!0};new MutationObserver((function(){e.app.cart.update(!0)})).observe(t,i)}}))},o=function(){-1!==window.location.toString().indexOf("/order-confirmation")&&e.app.cart.reset()};t.startCheckout=function(){var e=Fera.Util.updateURLParameter(window.location.toString(),"ensure_loaded_cart","0");e=Fera.Util.updateURLParameter(e,"go_to_checkout","0"),window.location=e.replace("/cart","/checkout")},t.removeProduct=function(e,r,n){return i.ajax({method:"GET",type:"GET",data:{},dataType:"json",url:"/api/storefront/cart",beforeSend:function(e){e.setRequestHeader("x-xsrf-token",l())},complete:function(i){Fera.logger.log("Removing product...",i);var a=JSON.parse(i.responseText)[0];if(a){var o=[],c="",u=0;r&&(u=r.quantity||0);for(var l=0;l<a.lineItems.physicalItems.length;l++){var d=a.lineItems.physicalItems[l];if(d.productId==e)if(r&&r.quantity){if((u-=d.quantity)<=0){u<0&&(c=d.productId),o.push(d.id);break}}else o.push(d.id)}s(a.id,o,c?function(){r.quantity=0-u,t.addProduct(c,r,n)}:n.then)}else"function"==typeof n.then&&n.then()}}),!0},t.clear=function(e){i.ajax({method:"GET",type:"GET",data:{},dataType:"json",url:"/api/storefront/cart",beforeSend:function(e){e.setRequestHeader("x-xsrf-token",l())},complete:function(t){Fera.logger.log("Clearing cart...",t);var i=JSON.parse(t.responseText)[0];if(i){for(var r=[],n=0;n<i.lineItems.physicalItems.length;n++){var a=i.lineItems.physicalItems[n];r.push(a.id)}s(i.id,r,e)}else"function"==typeof e&&e()}})};var s=function(e,t,i){if(t.length<1)"function"==typeof i&&i();else{var r=t.shift();c(e,r,(function(){setTimeout((function(){return s(e,t,i)}),100)}))}},c=function(e,t,r){i.ajax({method:"DELETE",type:"DELETE",data:{},dataType:"json",url:"/api/storefront/carts/"+e+"/items/"+t,beforeSend:function(e){e.setRequestHeader("x-xsrf-token",l())},complete:r})};t.downloadData=function(e){i.getJSON("/api/storefront/carts",(function(t){t&&t[0]?e(t[0]):e(null)}))},t.parseCartData=function(e){var i={};if(!e)return null;if(e.items)return u(e);!e.lineItems&&e[0]&&e[0].lineItems&&(e=e[0]),i.item_count=e.lineItems.physicalItems.length,i.currency=e.currency.code,i.total=e.cartAmount,i.total_discount=e.discountAmount,i.items=[];for(var r=0;r<e.lineItems.physicalItems.length;r++){var n=e.lineItems.physicalItems[r];i.items.push(t.parseItemData(n))}return i};var u=function(e){var t={};if(!e)return null;t.item_count=e.quantity,t.currency=e.currency,t.total=e.total?e.total.value:0,t.grand_total=e.grand_total?e.grand_total.value:0,t.total_discount=e.discount,t.items=[];for(var i=0;i<e.items.length;i++){for(var r=e.items[i],n=[],a=0;a<r.options.length;a++)n.push(r.options[a].id);t.items.push({price:r.price.value,total:r.total.value,product_id:r.product_id,name:r.name,variant_id:n,quantity:r.quantity})}return t};t.parseItemData=function(e){return e?{price:e.salePrice,total:e.salePrice*e.quantity,product_id:e.productId,name:e.name,variant_id:e.variantId,quantity:e.quantity}:null};var l=function(){var e=("; "+document.cookie).split("; XSRF-TOKEN=").pop().split(";")[0],t="";return BCData&&BCData.csrf_token&&(t=BCData.csrf_token),e||t};t.addProduct=function(e,t,i){var r={action:"add",product_id:e,qty:[1]};if(t){if(t.variant_id&&-1!==t.variant_id.indexOf("=")){r.attribute={};for(var n=t.variant_id.split("&"),a=0;a<n.length;a++){var o=n[a].split("=");r.attribute[o[0]]=o[1]}}r.qty=[t.quantity||1]}d(r,i)};var d=function(e,t){e.attribute?p(e,t):i.ajax({method:"GET",type:"GET",url:"/products.php?productId="+e.product_id,error:function(){p(e,t)},success:function(r){var n=!1;i(r).find('form[action*="cart.php"]').each((function(){var r={};if(i(this).serializeArray().forEach((function(e){"qty[]"!==e.name&&(r[e.name]=e.value)})),n=r.product_id==e.product_id)return p(i.extend(r,e),t),!1})),n||p(e,t)}})},p=function(e,t){t=t||{},i.ajax({method:"POST",type:"POST",data:e,dataType:"json",url:"/remote/v1/cart/add",beforeSend:function(e){e.setRequestHeader("x-xsrf-token",l())},complete:t.afterAdd||t.then||function(){}})};r()},Fera.MagentoAdapter=function(e){var t,i,r=Fera.Util.$();e=e||{};var n=function(){e.debugMode&&console.log("Magento adapter initialized."),t=r('form[action*="cart/add"]'),s(),o(),a()},a=function(){var t=r("html").attr("lang");t&&e.app.setLocale(t)},o=function(){var e='<!-- BEGIN Fera.ai Shopping Cart Top Container --> <div class="banana-container banana-cart-container" data-container_type="cart" ></div> <!-- END -->';if(!(r(".banana-cart-container").length>0)&&-1!==window.location.toString().indexOf("/checkout")){var t=r(".cart-container");t.length>0?t.each((function(){r(e).prependTo(r(this))})):r(e).insertAfter(r("h1,.page-title,.page-heading").first())}},s=function(){(i=t.find('input[type="submit"],.addToCart,.btn-addToCart,.addToCartBtn,.btn-cart,.btn-add,.addToCart-btn,.add-btn,button[class*="add"],a[onclick="productAddToCartForm.submit(this)"],a[onclick="productAddToCartForm.submit(this)"],#product-addtocart-button,button[title*="Add"]')).length<1?e.logger.logWarning("Fera did not find the add to cart button so it will not be enabled for add to cart events."):i.on("click touch",(function(){e.app.pushAddToCartEvent()}))};n()},Fera.CustomAdapter=function(e){Fera.Util.$();e=e||{},e.debugMode&&console.log("Custom adapter initialized.")},Fera.WixAdapter=function(e){var t=this,i=Fera.Util.$();e=e||{};var r=window.location.href,n=0,a=function(){e.logger.log("Wix adapter initialized."),t._allProducts=[],l(),d(),C(),S(),p(),m(),setTimeout((()=>g()),1e3),s(),o(),t.isReady=n<1},o=function(){e.app.on("widget.create:after",(function(t){if("custom_block"===t.type&&"home"==e.app.getSection()){var r=t.$el.siblings();r.length<1||"1 / 1 / 1 / 1"==r.css("grid-area")&&"stretch"==r.css("justify-self")&&r.height()==r.parent().height()&&i(window).width()<550&&r.css("height","auto")}}))},s=function(){e.app.opts.sandboxMode&&i("body").append("<style> ._2UgQw { display: none !important; } </style>")},c=function(){C(),d(),"product_view"!=e.app.getSection()&&e.app.setProductId(null),m(),_()},u=Fera.Util.debounce((()=>{c()}),1e3),l=function(){try{var i,r=document.getElementById("wix-viewer-model").textContent,n=JSON.parse(r);(i=n&&n.siteFeaturesConfigs&&n.siteFeaturesConfigs.multilingual?n.siteFeaturesConfigs.multilingual.currentLanguage.languageCode:n.language.siteLanguage)?e.app.setLocale(i):Fera.logger.log("[Wix] Failed to determine site language",t)}catch(e){Fera.logger.log("[Wix] Failed to determine site language",t,e)}},d=function(){var t=window.location.href;Fera.Util.isHome()?e.app.setSection("home"):-1!==t.indexOf("/cart-page")?e.app.setSection("cart"):-1!==t.indexOf("/product-page/")||i("[data-hook=product-page]").length>0?e.app.setSection("product_view"):-1!==t.indexOf("/shop")||i("[data-hook=product-list]").length>0?e.app.setSection("product_list"):-1!==t.indexOf("/checkout")?e.app.setSection("checkout"):e.app.setSection("other")},p=function(e){-1===window.location.href.indexOf("/product-page/")&&0===i("[data-hook=product-page]").length||h(e)||f(e)},h=function(t){var i,r,n=document.getElementById("wix-warmup-data");if(!n)return!1;try{if(i=JSON.parse(n.textContent).appsWarmupData,Object.keys(i).length<1)return!1}catch(e){return!1}for(var a=0;a<2;a++)i=i[Object.keys(i)[0]];try{r=i.catalog.product.id}catch(e){return!1}return!!r&&(e.app.setProductId(r),t&&t(),!0)},f=function(i){var r={product_handle:w(window.location.href)};n++,e.app.api.getProducts(r,(function(r){var a=r[0];a&&a.platform_product_id&&(t._allProducts.push(a),e.app.setProductId(a.platform_product_id),_()),n--,t.isReady=n<1,i&&i()}),(function(e,i,r){Fera.logger.error("[Wix] Failed to determine Product ID: ",i,r),n--,t.isReady=n<1}))},m=function(){i('button[data-hook="add-to-cart"]').each((function(){var t=i(this);if(t.data("Fera.listenersBound"))return!0;if(t.length<=0)Fera.logger.warn("[Wix] Fera did not find the add to cart button so it will not be enabled for add to cart events.");else{var r={product_id:e.app.getProductId()};t.on("click touch",(function(){e.app.pushAddToCartEvent(r)})),t.data("Fera.listenersBound",!0)}}))},g=function(){window.wixDevelopersAnalytics;var e=function(){window.wixDevelopersAnalytics||(r=window.location.href,c())};t._legacyPageChangeListener=setInterval((function(){r!==window.location.href&&e(),window.wixDevelopersAnalytics&&(clearInterval(t._legacyPageChangeListener),v())}),100),window.addEventListener("wixDevelopersAnalyticsReady",(()=>{t._legacyPageChangeListener&&clearInterval(t._legacyPageChangeListener),v()})),window.addEventListener("popstate",e),window.addEventListener("hashchange",e)},v=function(){window.wixDevelopersAnalytics.register("c9064755-5cc8-4faf-a5a6-41a0150a6640",((i,r)=>{if(Fera.logger.log("[Wix] Got event",i,r),"productPageLoaded"==i)t._previousProductId=e.app.getProductId(),e.app.setProductId(r.productId),Fera.logger.log("[Wix] Set product to",r.productId),u();else if("AddProductImpression"==i);else{if("PageView"!=i)return;Fera.logger.log("[Wix] Page changed"),u()}}))},_=Fera.Util.debounce((()=>{e.app.forceRefreshContent()}),1e3),w=function(e){var t=e.trim().toLowerCase().split("/").pop();return t.indexOf("?")>-1&&(t=t.split("?")[0]),t},y=function(){var e=[];return i('a[data-hook="product-item-container"],a[data-hook="product-widget-layout"]').each((function(){var t=i(this).attr("href");if(t){var r=w(t);r&&e.push(r)}})),e},b=function(){let e={updated:0,no_product:0,existing:0,total:0};return i('[data-hook="product-item-root"],[data-hook="product-widget"]').each((function(){var r=i(this);if(r.data("fera-context"))return e.existing++;var n=r.find('a[data-hook="product-item-container"],a[data-hook="product-widget-layout"]').attr("href");if(n){e.total++;var a=w(n),o=t._allProducts.find((function(e){return w(e.url)==a}));o?(e.updated++,Fera.logger.info("compare products from server:",a,w(o.url)),r.attr("data-product-id",o.platform_product_id).attr("data-fera-context",!0)):e.no_product++}})),e},C=(Fera.Util.debounce((()=>b()),1e3),function(i){var r=y();if(r.length<1)return!1;var a={product_handles:r.join(",")};return n++,e.app.api.getProducts(a,(function(e){t._allProducts=t._allProducts.concat(e);let r=b();n--,t.isReady=n<1,i&&i(r)}),(function(){Fera.logger.error("[Wix] Failed to fetch Product IDs"),n--,t.isReady=n<1})),!0}),S=function(){if(t._productListCheckFunction)return;let i=Fera.Util.debounce((()=>{let t=b();t.no_product>0&&C((i=>{t.no_product!=i.no_product&&e.app.refreshContent()}))}),100);t._productListCheckFunction=e=>{e.some((e=>Array.from(e.addedNodes).some((e=>F$(e).find('[data-hook="product-item-root"],[data-hook="product-widget"]').length>0))))&&i()};new MutationObserver(t._productListCheckFunction).observe(document,{subtree:!0,childList:!0,attributes:!1})};a()},Fera.WixCartAdapter=function(){Fera.Util.$();(function(){})()};try{var loadFera=function(){window.fera&&window.fera.version||(window.fera=window.fera||[],window.__bsio&&(window.fera=window.fera.concat(window.__bsio)),window.fera=window.__bsio=new Fera.App({pushBuffer:window.fera,debugMode:window.feraDebugMode||window.__bsioDebugMode||!1,showErrors:window.feraShowErrors,supportedPlatforms:["shopify","bigcommerce","magento","custom","wix"],parentWindow:window.opener?window.opener:window.parent&&window.parent.length>0&&window!==window.top?window.parent:null}))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",loadFera):loadFera()}catch(e){if(window.feraDebugMode||window.__bsioDebugMode||window.feraShowErrors)throw e;window.console&&window.console.error(e)}